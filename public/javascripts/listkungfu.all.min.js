var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};jQuery.expr[":"].Contains=function(h,b,u){return jQuery(h).text().toLowerCase().indexOf(u[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(h,b,u){return jQuery.trim(jQuery(h).text().toLowerCase())===u[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:92,minSize:92},south:{minSize:40},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(h,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(h,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(h,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(h,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)},AfterColorChanged:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},
TagSelected:function(h,b){ListKungFu.LayoutWest.ListView("FilterByTags",b)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(h){var b={},u=function(j){var l=$(j).length>0?{}:false;$(j).each(function(f,m){var p=$(m).attr("model"),r=$(m).attr("field"),n=$(m).text();l[p]=l[p]||{};l[p][r]=l[p][r]||[];l[p][r].push(n)});return l};b.ClearFlash=function(){b.flash={notice:"",error:"",warning:"",message:""}};b.ClearFlash();b.SetFlash=function(j){b.flash.notice=j.getResponseHeader("X-Flash-Notice")||"";b.flash.error=j.getResponseHeader("X-Flash-Error")||"";b.flash.warning=j.getResponseHeader("X-Flash-Warning")||
"";b.flash.message=j.getResponseHeader("X-Flash-Message")||"";if(typeof h.onFlashUpdate==="function")if(b.flash.notice!==""||b.flash.error!==""||b.flash.warning!==""||b.flash.message!=="")h.onFlashUpdate(b.flash.notice,b.flash.error,b.flash.warning,b.flash.message)};b.baseURL=h.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";b.route=h.route;b.DefaultCallback=function(j,l,f,m){b.SetFlash(m);var p=$.parseJSON($(l).find("JSON").text()),
r=$(l).find("Template").text();l=u($(l).find("Error"));typeof j==="function"&&j(r,p,f,m,l);b.ClearFlash()};b.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};b.ConstructRoute=function(j){for(var l=
"",f="",m=0;m<b.route.length;m++){l+=b.route[m];f=j[b.route[m]]||"";if(f!=="")l+="/"+f;if(m!==b.route.length-1)l+="/"}return l};b.Index=function(j){var l=j.successCallback||null,f=b.ConstructRoute(j);$.ajax({url:b.baseURL+f,dataType:"xml",type:"GET",processData:true,contentType:"application/json",data:j.send,success:function(m,p,r){b.DefaultCallback(l,m,p,r)},error:function(m,p,r){b.DefaultErrorCallback(m,p,r)}})};b.Show=function(j){var l=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+
j,dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(f,m,p){b.DefaultCallback(l,f,m,p)},error:function(f,m,p){b.DefaultErrorCallback(f,m,p)}})};b.New=function(j){var l=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j+"/new",dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(f,m,p){b.DefaultCallback(l,f,m,p)},error:function(f,m,p){b.DefaultErrorCallback(f,m,p)}})};b.Create=function(j){var l=j.successCallback||
null,f=b.ConstructRoute(j);j=JSON.stringify(j.send);$.ajax({url:b.baseURL+f,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:j,success:function(m,p,r){b.DefaultCallback(l,m,p,r)},error:function(m,p,r){b.DefaultErrorCallback(m,p,r)}})};b.Edit=function(j){var l=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j+"/edit",dataType:"xml",type:"GET",parseData:false,contentType:"application/json",success:function(f,m,p){b.DefaultCallback(l,f,m,p)},error:function(f,
m,p){b.DefaultErrorCallback(f,m,p)}})};b.Update=function(j){var l=j.successCallback||null,f=b.ConstructRoute(j);j=JSON.stringify(j.send);j=j.replace(/\\u000a/g,"\\n");$.ajax({url:b.baseURL+f,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:j,beforeSend:function(m){m.setRequestHeader("X-Http-Method-Override","PUT")},success:function(m,p,r){b.DefaultCallback(l,m,p,r)},error:function(m,p,r){b.DefaultErrorCallback(m,p,r)}})};b.Destroy=function(j){var l=j.successCallback||
null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j,dataType:"xml",type:"POST",processData:false,contentType:"application/json",beforeSend:function(f){f.setRequestHeader("X-Http-Method-Override","DELETE")},success:function(f,m,p){b.DefaultCallback(l,f,m,p)},error:function(f,m,p){b.DefaultErrorCallback(f,m,p)}})};return b},List=Controller({route:["lists"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),ListListItem=Controller({route:["lists",
"list_items"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}});
jQuery(function(h){var b=h("meta[name=csrf-token]").attr("content"),u=h("meta[name=csrf-param]").attr("content");h.fn.extend({triggerAndReturn:function(l,f){var m=new h.Event(l);this.trigger(m,f);return m.result!==false},callRemote:function(){var l=this,f=l.attr("method")||l.attr("data-method")||"GET",m=l.attr("action")||l.attr("href"),p=l.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(l.triggerAndReturn("ajax:before")){var r=
l.is("form")?l.serializeArray():[];h.ajax({url:m,data:r,dataType:p,type:f.toUpperCase(),beforeSend:function(n){l.trigger("ajax:loading",n)},success:function(n,I,B){l.trigger("ajax:success",[n,I,B])},complete:function(n){l.trigger("ajax:complete",n)},error:function(n,I,B){l.trigger("ajax:failure",[n,I,B])}})}l.trigger("ajax:after")}}});h("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var l=h(this);if(l.triggerAndReturn("confirm"))if(!confirm(l.attr("data-confirm")))return false});
h("form[data-remote]").live("submit.rails",function(l){h(this).callRemote();l.preventDefault()});h("a[data-remote],input[data-remote]").live("click.rails",function(l){h(this).callRemote();l.preventDefault()});h("a[data-method]:not([data-remote])").live("click.rails",function(l){var f=h(this),m=f.attr("href");f=f.attr("data-method");m=h('<form method="post" action="'+m+'"></form>');f='<input name="_method" value="'+f+'" type="hidden" />';if(u!==undefined&&b!==undefined)f+='<input name="'+u+'" value="'+
b+'" type="hidden" />';m.hide().append(f).appendTo("body");l.preventDefault();m.submit()});var j=function(){h(this).find("input[data-disable-with]").each(function(){var l=h(this);l.data("enable-with",l.val()).attr("value",l.attr("data-disable-with")).attr("disabled","disabled")})};h("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",j);h("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",j);h("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){h(this).find("input[data-disable-with]").each(function(){var l=h(this);l.removeAttr("disabled").val(l.data("enable-with"))})});j=h().jquery;if(j==="1.4"||j==="1.4.1"||j==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(h){h.confirmationDialog=function(b,u,j,l){dialog=h('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+l+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});l={};l[b]=function(){h(dialog).dialog("close");u()};l[j]=function(){h(dialog).dialog("close")};dialog.dialog("option","buttons",l);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown",
"right",function(f){f=h(f.target);if(f.next("button").length>0){f.blur();f.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(f){f=h(f.target);if(f.prev("button").length>0){f.blur();f.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){var h=function(){var b=null,u=function(f){var m=$(this),p=f.find(".dashboard-list-item-deadline-hidden"),r=f.data("data"),n=r.list_item.deadline_date.split("-"),I=n[0],B=n[1],L=n[2];p.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",beforeShow:function(N,t){t.input.datepicker("setDate",I+","+B+","+L)},onSelect:function(N){r.list_item.deadlineType="customdeadline";r.list_item.customDeadlineValue=N;r.list_item.template="dashboard";ListListItem.Update({successCallback:function(t,z){var E=
f.parent();f.hide("slow",function(){f.remove();E.find(".dashboard-item").length===0&&E.append('<p class="nothing-todo">no items scheduled</p>')});l(z,t,{highlightCategory:true,addType:"prepend"})},lists:r.list_item.list_id,list_items:r.list_item.id,send:r});m.datepicker("hide")}})},j=function(f,m,p){p=p||{};f.find(".nothing-todo").remove();p.addType==="prepend"?f.find("div[data-type=scheduleColumn]").first().prepend(m):f.find("div[data-type=scheduleColumn]").first().append(m);p.highlightCategory===
true&&m.effect("highlight",{},2E3)},l=function(f,m,p){var r=$($.mustache(m,f.list_item));switch(f.list_item.deadline_category){case "today":j(b.today,r,p);break;case "tomorrow":j(b.tomorrow,r,p);break;case "this week":j(b.thisweek,r,p);break;case "next week":j(b.nextweek,r,p);break;default:j(b.later,r,p)}r.data("data",f);r.find(".dashboard-list-item-title").bind("click",function(){b._trigger("OpenList",0,{selectedList:f.list_item})});r.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",
0,{selectedList:f.list_item})});r.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var n=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');$that.append(n);$that.animate({width:"100%",paddingLeft:"14px"},200);n.find(".yes").bind("click",function(){f.list_item.completed=true;ListListItem.Update({successCallback:function(){r.stop(true,true).hide("slow",function(){r.remove()})},
lists:f.list_item.list_id,list_items:f.list_item.id,send:f});n.find(".no").trigger("click");return false});n.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){n.remove()});return false})});r.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",0,{selectedList:f.list_item})});u(r);r.find(".dashboard-list-item-deadline").bind("click",function(){r.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});
return r};return{options:{},Show:function(){b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.toolbar=$('<div id="dashboard-toolbar"><input type="text" id="dashboard-search" value=""/></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn"></div></div>');b.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn"></div></div>');
b.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn"></div></div>');b.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn"></div></div>');b.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn"></div></div>');b.element.append(b.header);b.header.append(b.toolbar);b.element.append(b.wrapper);b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);
b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');b.toolbar.append('<div id="dashboard-search-cancel">&nbsp;</div><div style="clear:both;">&nbsp;</div>');ListItem.Index({successCallback:function(f,m){$.each(m,function(p,r){l(r,f)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append('<p class="nothing-todo">no items scheduled</p>')});b._trigger("ReinitPanes",0,{});b._trigger("ContentDimensionsChanged",
0,{})},send:{show:"dashboard"}});b.toolbar.find("#dashboard-search").bind("keyup",function(){var f=$(this).val();if(f==="")b.wrapper.find(".dashboard-item").show();else{b.wrapper.find(".dashboard-item:not(:Contains('"+f+"'))").hide();b.wrapper.find(".dashboard-item:Contains('"+f+"')").show()}});b.toolbar.find("#dashboard-search-cancel").bind("click",function(){b.toolbar.find("#dashboard-search").val("").trigger("keyup")})},Hide:function(){b.element.children().remove()},_create:function(){b=this},
destroy:function(){}}}();$.widget("ui.Dashboard",h)})();
(function(h){function b(u){if(typeof u.data==="string"){var j=u.handler,l=u.data.toLowerCase().split(" ");u.handler=function(f){if(!(this!==f.target&&(/textarea|select/i.test(f.target.nodeName)||f.target.type==="text"))){var m=f.type!=="keypress"&&h.hotkeys.specialKeys[f.which],p=String.fromCharCode(f.which).toLowerCase(),r="",n={};if(f.altKey&&m!=="alt")r+="alt+";if(f.ctrlKey&&m!=="ctrl")r+="ctrl+";if(f.metaKey&&!f.ctrlKey&&m!=="meta")r+="meta+";if(f.shiftKey&&m!=="shift")r+="shift+";if(m)n[r+m]=
true;else{n[r+p]=true;n[r+h.hotkeys.shiftNums[p]]=true;if(r==="shift+")n[h.hotkeys.shiftNums[p]]=true}m=0;for(p=l.length;m<p;m++)if(n[l[m]])return j.apply(this,arguments)}}}}h.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};h.each(["keydown","keyup","keypress"],function(){h.event.special[this]={add:b}})})(jQuery);
(function(){var h=function(){var b=null,u=function(){b._trigger("ContentDimensionsChanged",0,{})},j=function(t){var z=t.find("#deadline-settings-wrapper"),E=t.find("#save-deadline");E.bind("click keydown","return",function(){E.data("settings-visible")?z.hide("fast",function(){z.find(".deadline-button").first();E.data("settings-visible",false)}):z.show("fast",function(){z.find(".deadline-button").first().focus();E.data("settings-visible",true)});return false})},l=function(){$("#custom-deadline-display").datepicker({minDate:new Date,
altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",new Date))},f=function(t,z,E){var k=$($.mustache(z,t.list_item));k.data("data",t);k.data("isFullsize",false);E?b.listItemList.prepend(k):b.listItemList.append(k);k.find(".handle").height(k.height());k.bind("keydown","space",function(){b.toolbar.find("#list-item-completed").effect("puff",
{},300,function(){$(this).show();k.find(".undo").length===0?b.toolbar.find("#list-item-completed").trigger("click"):k.find(".undo").trigger("click")})});k.bind("keydown","del",function(){b.toolbar.find("#list-item-delete").effect("puff",{},300,function(){$(this).show();b.toolbar.find("#list-item-delete").trigger("click")})});k.bind("focus",function(w){if($(w.target).hasClass("row")){b.listItemList.find(".row").removeClass("selected-row");$(w.target).addClass("selected-row");$(w.target).data("data");
if(b.toolbar)$(w.target).data("isFullsize")===true?b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"}):b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"});var v=$(w.target);w=$(w.target).data("data");b.selectedListItem={element:v,data:w}}});k.bind("keydown","down",function(w){w.preventDefault();$(w.target).nextAll("div:visible").first().focus();return false});k.bind("keydown","up",function(w){w.preventDefault();$(w.target).prevAll("div:visible").first().focus();
return false});k.bind("keydown dblclick","return",function(){if(k.find("form").length>0)return false;b.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});b.listItemList.find(".row").find("form").hide("slow",function(){$(this).remove()});ListListItem.Edit({successCallback:function(w){var v=$(w),F=k.data("isFullsize");b.listItemList.find(".row").hide();b.selectedListItem.element.show();v.hide();b.selectedListItem.element.prepend(v);v.find("textarea").markItUp(mySettings);
j(v);l();F===false&&m(k);b.selectedListItem.element.find(".handle").hide();v.show("slow",function(){v.find("textarea").focus()});v.find("textarea").bind("keydown","esc",function(){v.find("#cancel-edit").trigger("click")});v.find(".deadline-button").bind("keydown click","return",function(G){G.preventDefault();var M=k.find("form").serializeForm();M.list_item.deadlineType=$(G.target).attr("data-deadline");M.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Update({send:M,successCallback:function(O,
P){v.hide("slow",function(){$(this).remove();b.selectedListItem.element.find(".handle").show();k.find(".list-item-content").html(P.list_item.body_rendered);k.find(".list-item-deadline").html(P.list_item.deadline_in_words);k.find(".handle").height(k.find(".list-item-content").height());F===false&&m(k);b.selectedListItem={element:k,data:P};k.data("data",P);b.listItemList.find(".row").show();k.focus()})},lists:b.selectedListItem.data.list_item.list_id,list_items:b.selectedListItem.data.list_item.id});
return false});v.find("#cancel-edit").bind("keydown click","return",function(G){G.preventDefault();b.selectedListItem.element.find(".handle").show();v.hide("slow",function(){$(this).remove();F===false&&m(k);b.listItemList.find(".row").show();k.focus()});return false});return false},lists:b.selectedListItem.data.list_item.list_id,list_items:b.selectedListItem.data.list_item.id})});k.bind("keydown","left",function(){b._trigger("SelectLastList",0,{})});k.bind("keydown","shift+return",function(){b.toolbar.find("#list-item-new").effect("puff",
{},300,function(){$(this).show();N()})});k.bind("keydown","l",function(){b.toolbar.find("#list-item-fullsize").effect("puff",{},300,function(){b.toolbar.find("#list-item-fullsize").trigger("click");$(this).show()});return false});ListKungFu&&ListKungFu.LayoutCenter&&k.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+k.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,
left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingListItem",0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});p(k)},m=function(t){if(t.data("isFullsize")===true){p(t,false);t.data("isFullsize",false);b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"})}else{p(t,true);t.data("isFullsize",true);b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"})}},
p=function(t,z){t.height()>150&&!z?t.height(150):t.height("auto");u()},r=function(t,z){ListListItem.Destroy({successCallback:function(){t.hide("slow",function(){var E=t.next(".row");E.length>0||(E=t.prev(".row"));E.focus();t.remove();b.toolbar.find("#list-item-search").trigger("ClearValue")})},lists:z.list_item.list_id,list_items:z.list_item.id})},n=function(t,z){z.list_item.completed=true;ListListItem.Update({successCallback:function(){var E="list-item-undo-"+z.list_item.id;t.find(".list-item-wrapper").hide("slow",
function(){var k=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');k.bind("click",function(){I(t,z,E)});t.append(k);p(t);k.delay(5E3,E).queue(E,function(){t.hide("slow",function(){t.remove()})}).dequeue(E);b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&B(true);t.focus()})},lists:z.list_item.list_id,list_items:z.list_item.id,send:z})},I=function(t,z,E){E!==""&&t.clearQueue(E);z.list_item.completed=false;ListListItem.Update({successCallback:function(){t.find(".undo").hide("slow",
function(){$(this).remove()});t.find(".list-item-wrapper").show("slow",function(){p(t)});b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&B(true)},lists:z.list_item.list_id,list_items:z.list_item.id,send:z})},B=function(t){if(t===true){if(b.completedList){b.completedList.remove();b.completedList=null}b.completedList=$('<div id="completedList"></div>');t=b.element.data("data-list");ListListItem.Index({successCallback:function(z,E){$.each(E,function(k,w){b.completedList.append("<div>"+
w.list_item.body_rendered+"</div>")});E.length===0&&b.completedList.append("<div>No completed items</div>");b.wrapper.prepend(b.completedList)},send:{show:"completed"},lists:t.list.id})}else{b.completedList.remove();b.completedList=null}},L=function(){b.header.html("");b.toolbar=$('<div id="list-item-toolbar"> \t\t\t\t<div id="list-name"></div><div id="list-item-toolbar-buttons"> \t\t\t\t<button id="list-item-completed">Completed [space]</button> \t\t\t\t<button id="list-item-new">Create [shift+return]</button> \t\t\t\t<button id="list-item-delete">Delete [del]</button> \t\t\t\t<button id="list-item-edit">Edit [return]</button> \t\t\t\t<button id="list-item-fullsize">Fullsize [l]</button> \t\t\t\t<input type="input" id="list-item-search"/> \t\t\t\t<input type="checkbox" id="showCompleted"/> \t\t\t\t<label for="showCompleted">Show Completed Items</label> \t\t\t\t<div id="list-item-search-cancel">&nbsp;</div> \t\t\t\t</div></div>');
b.listName=b.toolbar.find("#list-name");b.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});b.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.toolbar.find("#list-item-fullsize").button({text:false,icons:{primary:"ui-icon-zoomin"}});b.toolbar.find("#list-item-new").bind("click",
function(){N()});b.toolbar.find("#showCompleted").bind("change",function(t){B(t.target.checked);b.selectedListItem.element.focus()});b.toolbar.find("#list-item-completed").bind("click",function(){n(b.selectedListItem.element,b.selectedListItem.data)});b.toolbar.find("#list-item-delete").bind("click",function(){var t=function(){r(b.selectedListItem.element,b.selectedListItem.data)};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List Item",t,"Cancel","Do you really want to delete?");
b.deleteDialog.dialog("open")});b.toolbar.find("#list-item-edit").bind("click",function(){b.selectedListItem.element.trigger("dblclick")});b.toolbar.find("#list-item-fullsize").bind("click",function(){m(b.selectedListItem.element)});b.toolbar.find("#list-item-search").bind("keyup",function(){var t=$(this).val();if(t==="")b.listItemList.find(".row").show();else{b.listItemList.find(".row:not(:Contains('"+t+"'))").hide();b.listItemList.find(".row:Contains('"+t+"')").show()}});b.toolbar.find("#list-item-search-cancel").bind("click",
function(){b.toolbar.find("#list-item-search").val("").trigger("keyup")});b.toolbar.find("#list-item-search").bind("ClearValue",function(t){$(t.target).val("");b.listItemList.find(".row").show()});b.header.append(b.toolbar)},N=function(){var t=b.element.data("data-list");ListListItem.New({successCallback:function(z){var E=$(z);b.listItemList.prepend(E);j(E);l();E.find("textarea").markItUp(mySettings);E.find("textarea").focus();b.listItemList.find(".row").hide();E.find("#cancel-edit").bind("click",
function(k){k.preventDefault();E.hide("slow",function(){$(this).remove();b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus()})});E.find(".deadline-button").bind("click",function(k){k.preventDefault();var w=E.serializeForm();w.list_item.body=w.list_item.body.replace(/\n/g,"\n\n");w.list_item.deadlineType=$(k.target).attr("data-deadline");w.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:w,successCallback:function(v,F){E.hide("slow",
function(){f(F,v,true);$(this).remove();b.toolbar.find("#list-item-search").trigger("ClearValue");b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();b.listItemList.find(".row").first().find(".handle").height(b.listItemList.find(".row").first().find(".list-item-content").height())})},lists:t.list.id});return false});E.find("textarea").bind("keydown","esc",function(){E.find("#cancel-edit").trigger("click")})},lists:t.list.id})};return{options:{},_create:function(){b=this;
b.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');b.listItemList=$('<div id="list-item-list"></div>');b.header=$('<div class="header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.listItemList);u();$(document).bind("keydown","c",function(){var t=b.toolbar.find("#showCompleted");if(t.length>0){if(t.get(0).checked===true)t.get(0).checked=false;else t.get(0).checked=true;t.trigger("change")}});$(document).bind("keyup","f",function(){b.toolbar.find("#list-item-search").focus()})},
destroy:function(){b.children().remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},RemoveList:function(){b.wrapper.remove();b.header.remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},OpenList:function(t){b.RemoveList();b._create();b.element.data("data-list",t);ListListItem.Index({successCallback:function(z,E){L();$.each(E,function(k,w){f(w,z)});t.id?b.listItemList.find(".row").each(function(){var k=$(this);if(k.data("data").list_item.id===t.id){k.focus();
return false}}):b.listItemList.find(".row").first().focus();b.listItemList.find(".row").length===0&&N();b.listName.text(t.list.title)},lists:t.list.id});b._trigger("ReinitPanes",0,{})},SelectListItem:function(){b.selectedListItem?b.selectedListItem.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):b.listItemList.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})}}}();$.widget("ui.ListItemView",h)})();
(function(){var h=function(){var b=null,u={activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(k,w){if($(this).position().top<b.wrapper.height()){var v=$(this),F=w.draggable.data("data"),G=v.data("data");G.list.tag_id=F.tag.id;List.Update({send:G,successCallback:function(M,O){var P=r(O,M);v.replaceWith(P);I();n();P.focus()},lists:G.list.id})}}},j=function(k){return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(w,v){if($(this).position().top<
b.wrapper.height()){var F=v.draggable.data("data"),G=$(this).data("data");F={list_item:{body:F.list_item.body.replace(/\n/g,"\n\n")}};ListListItem.Create({send:F,successCallback:function(){$(w.target).find(".fake-drop").remove();k.effect("highlight",{},3E3)},lists:G.list.id})}},over:function(w,v){var F=$('<div class="fake-drop"></div>');F.html("<p>"+v.helper.text()+"</p>");$(w.target).append(F)},out:function(w){$(w.target).find(".fake-drop").remove()}}},l=function(k,w){for(var v in w){var F=w[v],
G;for(G in F){for(var M=F[G],O=$('<div class="error_explanation"><ul></ul></div>'),P=O.find("ul"),V=k.find("*[name="+(v+"["+G+"]")+"]"),W=0;W<M.length;W++){V.parent(".field").addClass("field_with_errors");P.append("<li>"+M[W]+"</li>")}V.parent(".field").append(O)}}},f=function(k){k.find(".field").removeClass("field_with_errors");k.find(".error_explanation").remove()},m=function(k){var w=b.selectedList.element.next(),v=b.selectedList.element.prev();k=k||0;List.Destroy({successCallback:function(){b.selectedList.element.delay(k).fadeOut(function(){$(this).remove();
w.length>0?w.focus():v.focus()});b._trigger("CloseList",0,{})},lists:b.selectedList.data.list.id})},p=function(){var k=$('<div id="list-toolbar"> \t\t\t\t<button id="list-new">Create [shift+return]</button> \t\t\t\t<button id="list-delete">Delete [del]</button> \t\t\t\t<button id="list-edit">Edit [space]</button> \t\t\t\t<input type="text" id="search-list" /> \t\t\t\t<div id="list-search-cancel">&nbsp;</div> \t\t\t\t</div>');b.element.find("div.header").append(k);k.find("#list-new").button({text:false,
icons:{primary:"ui-icon-plusthick"}});k.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});k.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});k.find("#list-delete").bind("click",function(w){if(b.selectedList!==null){if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List",function(){if(b.listForm!==null){b.listForm.bind("FormHidden",function(){m(1E3)});z()}else m()},"Cancel","Do you really want to delete?");b.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();
$(w.target).blur();return false});k.find("#list-new").bind("click",function(w){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.New({successCallback:function(v,F){b.listForm.append(v);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b._trigger("CloseList",0,{});b.listForm.find("#list-back-button").bind("click",
function(){z()});b.listForm.find("#list_title").bind("keydown","esc",function(){z()});b.listForm.bind("submit",function(G){G.preventDefault();G=$(this).find("form").serializeForm();F.list=G.list;List.Create({send:F,successCallback:function(M,O,P,V,W){f(b.listForm);if(W===false){z(O,M);b.toolbar.find("#search-list").trigger("ClearValue")}else l(b.listForm,W)}})});b.selectedList=null}})});$(w.target).blur();return false});k.find("#search-list").bind("keyup",function(){var w=$(this).val();if(w==="")b.listlist.find(".row").show();
else{b.listlist.find(".row:not(:Contains('"+w+"'))").hide();b.listlist.find(".row:Contains('"+w+"')").show()}I();n()});k.find("#list-search-cancel").bind("click",function(){k.find("#search-list").val("").trigger("keyup")});k.find("#search-list").bind("ClearValue",function(w){$(w.target).val("");b.listlist.find(".row").show()});k.find("#list-edit").bind("click",function(){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=
$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.Edit({successCallback:function(w){b.listForm.append(w);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b.listForm.find("#list-back-button").bind("click",function(){z()});b.listForm.find("#list_title").bind("keydown","esc",function(){z()});b.listForm.bind("submit",function(v){v.preventDefault();v=$(this).find("form").serializeForm();List.Update({send:v,
successCallback:function(F,G,M,O,P){f(b.listForm);P===false?z(G,F):l(b.listForm,P)},lists:b.selectedList.data.list.id});return false})},lists:b.selectedList.data.list.id})})});return k},r=function(k,w){var v=$($.mustache(w,k.list));v.attr("tabindex",0);v.data("data",k);v.addClass("row");v.bind("keydown","down",function(F){F.preventDefault();$(F.target).nextAll("div:visible").first().focus();return false});v.bind("keydown","up",function(F){F.preventDefault();$(F.target).prevAll("div:visible").first().focus();
return false});v.bind("focus",function(F){var G=$(F.target);b.listlist.find(".row").removeClass("selected-row");G.addClass("selected-row");b.listlist.find(".assigned-tags").hide();G.find(".assigned-tags").show();I();b.selectedList={element:$(F.target),data:$(F.target).data("data")}});v.bind("keydown dblclick","return",function(F){b._trigger("OpenList",0,{selectedList:$(F.target).parent().andSelf().filter(".row").data("data")})});v.bind("keydown","right",function(){b._trigger("SelectListItem",0,{})});
v.bind("keydown","shift+return",function(){b.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});v.bind("keydown","del",function(){b.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});v.bind("keydown","space",function(){b.toolbar.find("#list-edit").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});v.droppable(j(v));v.find(".assigned-tag-delete").bind("click",
function(F){var G=$(F.target).parent(".assigned-tag");F=G.attr("data-id");var M=v.data("data");M.list.tag_id=F;M.list.tag_action="remove";List.Update({send:M,successCallback:function(O,P){G.hide("slow",function(){G.remove();var V=r(P,O);v.replaceWith(V);I();n();V.focus();E()})},lists:M.list.id})});v.find(".assigned-tags").hide();return v},n=function(){b._trigger("ContentDimensionsChanged",0,{})},I=function(){b.listlist.find(".row").each(function(){var k=$(this),w=k.find(".list-tag");k=k.find(".list-name");
w.height(k.height()+10+"px")})},B=function(k,w){b.listlist=$('<div id="list-list"></div>');b.wrapper.append(b.listlist);for(var v=0;v<k.length;v++)b.listlist.append(r(k[v],w));I();n()},L=function(){b.selectedList?b.selectedList.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):b.listlist.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})},N=function(){$(document).bind("keydown","ctrl+l",function(){L()});$(document).bind("keydown",
"ctrl+f",function(){b.toolbar.find("#search-list").focus()});$(document).bind("keydown","shift+f",function(){b.toolbar.find("#search-list").focus();return false})},t=function(k,w){b.listlist.show("slide",{direction:"left"},"slow",function(){if(k){var v=r(k,w);b.selectedList===null||b.selectedList.data.list.id!==k.list.id?b.listlist.prepend(v):b.selectedList.element.replaceWith(v);I();b.selectedList={data:k,element:v}}b.selectedList&&b.selectedList.element.focus()})},z=function(k,w){b.listForm.hide("slide",
{direction:"left"},"slow",function(){t(k,w);b.listForm.trigger("FormHidden");b.selectedList?b.selectedList.element.focus():b.listlist.find(".row").first().focus();b.listForm.remove();b.listForm=null})},E=function(){b.toolbar.find("#search-list").trigger("keyup");b.listlist.find(".row:visible").each(function(){var k=$(this),w=k.data("data"),v=0;if(b.selectedTags.length>0){for(var F=0;F<w.list.tags.length;F++)for(var G=0;G<b.selectedTags.length;G++)b.selectedTags[G]===w.list.tags[F].id&&v++;v===b.selectedTags.length?
k.show():k.hide()}})};return{options:{},selectedList:null,_create:function(){b=this;b.wrapper=b.element.find("div#list-wrapper");b.toolbar=p(b);b.listForm=null;List.Index({successCallback:function(k,w){b.wrapper.find(".row").remove();B(w,k);b.listlist.find(".row").first().focus()}});N()},SetupDroppable:function(k){b.listlist.find(".row").each(function(){var w=$(this);w.droppable("destroy");switch(k){case "listitem":w.droppable(j(w));break;case "tag":w.droppable(u)}})},ReloadLists:function(){List.Index({successCallback:function(k,
w){b.wrapper.find(".row").remove();B(w,k);b.toolbar.find("#search-list").trigger("keyup");E()}})},SelectList:function(){L()},FilterByTags:function(k){b.selectedTags=k;E()},destroy:function(){b.toolbar.remove();b.listForm.remove();b.wrapper.find(".row").remove()}}}();$.widget("ui.ListView",h)})();
(function(h){h.fn.serializeForm=function(){var b=h(this).find('*[name*="]"]'),u={};h.each(b,function(j,l){var f=h(l),m=f.get(0).name.split("[")[0],p=f.get(0).name.split("[")[1];p=p.replace("]","");f=f.val();u[m]=u[m]||{};u[m][p]=f});return u}})(jQuery);
(function(){var h=function(){return{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b);this.notice.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}}}();$.widget("ui.StatusBar",h)})();if(!this.JSON)this.JSON={};
(function(){function h(n){return n<10?"0"+n:n}function b(n){l.lastIndex=0;return l.test(n)?'"'+n.replace(l,function(I){var B=p[I];return typeof B==="string"?B:"\\u"+("0000"+I.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(n,I){var B,L,N,t,z=f,E,k=I[n];if(k&&typeof k==="object"&&typeof k.toJSON==="function")k=k.toJSON(n);if(typeof r==="function")k=r.call(I,n,k);switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);
case "object":if(!k)return"null";f+=m;E=[];if(Object.prototype.toString.apply(k)==="[object Array]"){t=k.length;for(B=0;B<t;B+=1)E[B]=u(B,k)||"null";N=E.length===0?"[]":f?"[\n"+f+E.join(",\n"+f)+"\n"+z+"]":"["+E.join(",")+"]";f=z;return N}if(r&&typeof r==="object"){t=r.length;for(B=0;B<t;B+=1){L=r[B];if(typeof L==="string")if(N=u(L,k))E.push(b(L)+(f?": ":":")+N)}}else for(L in k)if(Object.hasOwnProperty.call(k,L))if(N=u(L,k))E.push(b(L)+(f?": ":":")+N);N=E.length===0?"{}":f?"{\n"+f+E.join(",\n"+f)+
"\n"+z+"}":"{"+E.join(",")+"}";f=z;return N}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
l=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,m,p={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},r;if(typeof JSON.stringify!=="function")JSON.stringify=function(n,I,B){var L;m=f="";if(typeof B==="number")for(L=0;L<B;L+=1)m+=" ";else if(typeof B==="string")m=B;if((r=I)&&typeof I!=="function"&&(typeof I!=="object"||typeof I.length!=="number"))throw Error("JSON.stringify");return u("",
{"":n})};if(typeof JSON.parse!=="function")JSON.parse=function(n,I){function B(N,t){var z,E,k=N[t];if(k&&typeof k==="object")for(z in k)if(Object.hasOwnProperty.call(k,z)){E=B(k,z);if(E!==undefined)k[z]=E;else delete k[z]}return I.call(N,t,k)}var L;n=String(n);j.lastIndex=0;if(j.test(n))n=n.replace(j,function(N){return"\\u"+("0000"+N.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){L=eval("("+n+")");return typeof I==="function"?B({"":L},""):L}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var h=function(){};h.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(b,u,j,l){if(!l){this.context=u;this.buffer=[]}if(!this.includes("",b))if(l)return b;else{this.send(b);return}b=this.render_pragmas(b);b=this.render_section(b,u,j);if(l)return this.render_tags(b,u,j,l);this.render_tags(b,u,j,l)},send:function(b){b!=""&&this.buffer.push(b)},render_pragmas:function(b){if(!this.includes("%",b))return b;
var u=this;return b.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(j,l,f){if(!u.pragmas_implemented[l])throw{message:"This implementation of mustache doesn't understand the '"+l+"' pragma"};u.pragmas[l]={};if(f){j=f.split("=");u.pragmas[l][j[0]]=j[1]}return""})},render_partial:function(b,u,j){b=this.trim(b);if(!j||j[b]===undefined)throw{message:"unknown_partial '"+b+"'"};if(typeof u[b]!="object")return this.render(j[b],u,j,true);return this.render(j[b],u[b],j,true)},render_section:function(b,
u,j){if(!this.includes("#",b)&&!this.includes("^",b))return b;var l=this;return b.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(f,m,p,r){f=l.find(p,u);if(m=="^")return!f||l.is_array(f)&&f.length===0?l.render(r,u,j,true):"";else if(m=="#")return l.is_array(f)?l.map(f,function(n){return l.render(r,l.create_context(n),j,true)}).join(""):l.is_object(f)?l.render(r,l.create_context(f),j,true):typeof f==="function"?
f.call(u,r,function(n){return l.render(n,u,j,true)}):f?l.render(r,u,j,true):""})},render_tags:function(b,u,j,l){var f=this,m=function(){return RegExp(f.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+f.ctag+"+","g")},p=m(),r=function(I,B,L){switch(B){case "!":return"";case "=":f.set_delimiters(L);p=m();return"";case ">":return f.render_partial(L,u,j);case "{":return f.find(L,u);default:return f.escape(f.find(L,u))}};b=b.split("\n");for(var n=0;n<b.length;n++){b[n]=b[n].replace(p,r,this);l||this.send(b[n])}if(l)return b.join("\n")},
set_delimiters:function(b){b=b.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(b){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return b.replace(arguments.callee.sRE,"\\$1")},find:function(b,u){b=this.trim(b);var j;if(u[b]===false||u[b]===0||u[b])j=u[b];else if(this.context[b]===false||this.context[b]===0||this.context[b])j=this.context[b];if(typeof j==="function")return j.apply(u);
if(j!==undefined)return j;return""},includes:function(b,u){return u.indexOf(this.otag+b)!=-1},escape:function(b){return String(b===null?"":b).replace(/&(?!\w+;)|["<>\\]/g,function(u){switch(u){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return u}})},create_context:function(b){if(this.is_object(b))return b;else{var u=".";if(this.pragmas["IMPLICIT-ITERATOR"])u=this.pragmas["IMPLICIT-ITERATOR"].iterator;var j={};j[u]=b;return j}},
is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(b,u){if(typeof b.map=="function")return b.map(u);else{for(var j=[],l=b.length,f=0;f<l;f++)j.push(u(b[f]));return j}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(b,u,j,l){var f=new h;if(l)f.send=l;f.render(b,u,j);if(!l)return f.buffer.join("\n")}}}();
(function(h){h.mustache=function(b,u,j){return Mustache.to_html(b,u,j)}})(jQuery);
(function(h){h.fn.layout=function(b){function u(c){if(!c)return true;var d=c.keyCode;if(d<33)return true;var e={38:"north",40:"south",37:"west",39:"east"},g=d>=37&&d<=40,i=c.shiftKey,q=c.ctrlKey,y=false,s,C,x;if(!q&&!i)return true;else if(g&&n[e[d]].enableCursorHotkey)y=e[d];else h.each(A.borderPanes.split(","),function(D,J){s=n[J];C=s.customHotkey;x=s.customHotkeyModifier;if(i&&x=="SHIFT"||q&&x=="CTRL"||q&&i)if(C&&d==(isNaN(C)||C<=9?C.toUpperCase().charCodeAt(0):C)){y=J;return false}});if(!y)return true;
s=n[y];e=B[y];if(!s.enableCursorHotkey||e.isHidden||!K[y])return true;if((e=c.target||c.srcElement)&&i&&g&&(e.tagName=="TEXTAREA"||e.tagName=="INPUT"&&(d==37||d==39)))return true;fa(y);c.stopPropagation();return c.returnValue=false}function j(c){if(this&&this.tagName)c=this;c=typeof c=="string"?K[c]:h(c).attr("pane")?h(c):h(c).parents("div[pane]:first");if(c.length){var d=c.attr("pane"),e=B[d];e.cssSaved&&l(d);if(e.isSliding||e.isResizing||e.isClosed)e.cssSaved=false;else{var g={zIndex:A.zIndex.pane_normal+
1},i={},q=c.css("overflow"),y=c.css("overflowX"),s=c.css("overflowY");if(q!="visible"){i.overflow=q;g.overflow="visible"}if(y&&y!="visible"&&y!="auto"){i.overflowX=y;g.overflowX="visible"}if(s&&s!="visible"&&s!="auto"){i.overflowY=y;g.overflowY="visible"}e.cssSaved=i;c.css(g);h.each(A.allPanes.split(","),function(C,x){x!=d&&l(x)})}}}function l(c){if(this&&this.tagName)c=this;c=typeof c=="string"?K[c]:h(c).hasClass("ui-layout-pane")?h(c):h(c).parents("div[pane]:first");if(c.length){var d=c.attr("pane");
d=B[d];var e=d.cssSaved||{};!d.isSliding&&!d.isResizing&&c.css("zIndex",A.zIndex.pane_normal);c.css(e);d.cssSaved=false}}function f(c,d,e){var g=h(c);if(g.length)if(A.borderPanes.indexOf(d)==-1)alert("Error Adding Button \n\nInvalid pane: "+d);else{c=n[d].buttonClass+"-"+e;g.addClass(c+" "+c+"-"+d);return g}else alert("Error Adding Button \n\nInvalid selector: "+c);return false}function m(c,d){h.each(A[c].pins,function(e,g){p(h(g),c,d)})}function p(c,d,e){var g=c.attr("pin");if(!(g&&e==(g=="down"))){var i=
n[d].buttonClass+"-pin",q=i+"-"+d;d=i+"-up";g=q+"-up";i+="-down";q+="-down";c.attr("pin",e?"down":"up").attr("title",e?"Un-Pin":"Pin").removeClass(e?d:i).removeClass(e?g:q).addClass(e?i:d).addClass(e?q:g)}}var r={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},n={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:r.contentSelector,contentIgnoreSelector:r.contentIgnoreSelector,paneClass:r.paneClass,resizerClass:r.resizerClass,togglerClass:r.togglerClass,buttonClass:r.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},I={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},B={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},L={north:"south",south:"north",east:"west",west:"east"},N=function(c){if(typeof c=="string")return true;else if(typeof c=="object")try{return c.constructor.toString().match(/string/i)!==null}catch(d){}return false},t=function(c){return typeof c=="string"||N(c)?h.trim(c):c},z=function(c,d){return Math.max(c,d)},E=function(c){var d={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};c=c||{};if(c.effects||
c.defaults||c.north||c.south||c.west||c.east||c.center)d=h.extend(d,c);else h.each(c,function(e,g){a=e.split("__");d[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=g});return d},k=function(c,d,e){function g(y){q=A[y];if(q.doCallback){cpPane=q.callback.split(",")[1];cpPane!=y&&cpPane!=d&&g(cpPane,true)}else{q.doCallback=true;q.callback=i}}var i=c+","+d+","+(e?1:0),q;h.each(A.borderPanes.split(","),function(y,s){if(A[s].isMoving){g(s);return false}})},w=function(c){c=A[c];A.isLayoutBusy=false;delete c.isMoving;
if(c.doCallback&&c.callback){c.doCallback=false;var d=c.callback.split(","),e=d[2]>0?true:false;if(d[0]=="open")Z(d[1],e);else d[0]=="close"&&X(d[1],e);if(!c.doCallback)c.callback=null}},v=function(c,d){if(d){var e;try{if(typeof d=="function")e=d;else if(typeof d!="string")return;else if(d.indexOf(",")>0){var g=d.split(",");e=eval(g[0]);if(typeof e=="function"&&g.length>1)return e(g[1])}else e=eval(d);if(typeof e=="function")return e(c,K[c],h.extend({},B[c]),h.extend({},n[c]),n.name)}catch(i){}}},
F=function(c,d){var e=0,g=false,i="";if(!h.browser.msie)if(h.curCSS(c[0],"display",true)=="none"){g=true;i=h.curCSS(c[0],"visibility",true);c.css({display:"block",visibility:"hidden"})}e=parseInt(h.curCSS(c[0],d,true),10)||0;if(g){c.css({display:"none"});i&&i!="hidden"&&c.css({visibility:i})}return e},G=function(c,d){var e;if(N(c)){c=t(c);e=K[c]}else e=h(c);if(d<=0)return 0;else d>0||(d=N(c)?O(c):e.outerWidth());return h.boxModel?d-F(e,"paddingLeft")-F(e,"paddingRight")-(h.curCSS(e[0],"borderLeftStyle",
true)=="none"?0:F(e,"borderLeftWidth"))-(h.curCSS(e[0],"borderRightStyle",true)=="none"?0:F(e,"borderRightWidth")):d},M=function(c,d){var e;if(N(c)){c=t(c);e=K[c]}else e=h(c);if(d<=0)return 0;else d>0||(d=N(c)?O(c):e.outerHeight());return h.boxModel?d-F(e,"paddingTop")-F(e,"paddingBottom")-(h.curCSS(e[0],"borderTopStyle",true)=="none"?0:F(e,"borderTopWidth"))-(h.curCSS(e[0],"borderBottomStyle",true)=="none"?0:F(e,"borderBottomWidth")):d},O=function(c,d){var e=K[c],g=n[c],i=B[c],q=d?g.spacing_open:
0;g=d?g.spacing_closed:0;return!e||i.isHidden?0:i.isClosed||i.isSliding&&d?g:A[c].dir=="horz"?e.outerHeight()+q:e.outerWidth()+q},P=function(c){var d=H,e=A[c].dir,g=B[c],i=K[L[c]],q=n[c].spacing_open,y=n[L[c]].spacing_open,s=!i?0:e=="horz"?i.outerHeight():i.outerWidth();i=g.minSize||0;e=Math.min(g.maxSize||9999,(e=="horz"?d.innerHeight:d.innerWidth)-q-s-y);var C,x;switch(c){case "north":C=d.offsetTop+i;x=d.offsetTop+e;break;case "west":C=d.offsetLeft+i;x=d.offsetLeft+e;break;case "south":C=d.offsetTop+
d.innerHeight-e;x=d.offsetTop+d.innerHeight-i;break;case "east":C=d.offsetLeft+d.innerWidth-e;x=d.offsetLeft+d.innerWidth-i}h.extend(g,{minSize:i,maxSize:e,minPosition:C,maxPosition:x})},V=function(){var c={top:O("north",true),bottom:O("south",true),left:O("west",true),right:O("east",true),width:0,height:0};with(c){width=H.innerWidth-left-right;height=H.innerHeight-bottom-top;top+=H.top;bottom+=H.bottom;left+=H.left;right+=H.right}return c},W=function(c){var d={},e,g,i;h.each("Left,Right,Top,Bottom".split(","),
function(){e=t(this);g=d["border"+e]=F(c,"border"+e+"Width");i=d["padding"+e]=F(c,"padding"+e);d["offset"+e]=g+i;if(c==S)d[e.toLowerCase()]=h.boxModel?i:0});d.innerWidth=d.outerWidth=c.outerWidth();d.innerHeight=d.outerHeight=c.outerHeight();if(h.boxModel){d.innerWidth-=d.offsetLeft+d.offsetRight;d.innerHeight-=d.offsetTop+d.offsetBottom}return d},ra=function(c,d,e,g){var i=window.layout=window.layout||{};i=i.timers=i.timers||{};c="layout_"+B.id+"_"+c+"_"+d;i[c]||(i[c]=setTimeout(e,g))},ga=function(c,
d){var e=window.layout=window.layout||{};e=e.timers=e.timers||{};var g="layout_"+B.id+"_"+c+"_"+d;if(e[g]){clearTimeout(e[g]);delete e[g];return true}else return false},sa=function(){try{if(S[0].tagName=="BODY"){h("html").css({height:"100%",overflow:"hidden"});h("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var c={overflow:"hidden"},d=S.css("position"),e=S.css("height");if(!S.hasClass("ui-layout-pane")){if(!d||"fixed,absolute,relative".indexOf(d)<
0)c.position="relative";if(!e||e=="auto")c.height="100%"}S.css(c)}}catch(g){}H=B.container=W(S)},ta=function(){h.each(A.borderPanes.split(","),function(c,d){var e=n[d];if(e.enableCursorHotkey||e.customHotkey){h(document).keydown(u);return false}})},ua=function(){b=E(b);if(b.effects){h.extend(I,b.effects);delete b.effects}h.each("name,scrollToBookmarkOnLoad".split(","),function(e,g){if(b[g]!==undefined)n[g]=b[g];else if(b.defaults[g]!==undefined){n[g]=b.defaults[g];delete b.defaults[g]}});h.each("paneSelector,resizerCursor,customHotkey".split(","),
function(e,g){delete b.defaults[g]});h.extend(n.defaults,b.defaults);A.center=h.extend(true,{},A.defaults,A.center);h.extend(n.center,b.center);var c=h.extend(true,{},n.defaults,b.defaults,n.center);h.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(e,g){n.center[g]=c[g]});var d=n.defaults;h.each(A.borderPanes.split(","),function(e,g){A[g]=h.extend(true,{},A.defaults,A[g]);o=n[g]=h.extend(true,{},n.defaults,n[g],b.defaults,b[g]);if(!o.paneClass)o.paneClass=
r.paneClass;if(!o.resizerClass)o.resizerClass=r.resizerClass;if(!o.togglerClass)o.togglerClass=r.togglerClass;h.each(["_open","_close",""],function(i,q){var y="fxName"+q,s="fxSpeed"+q,C="fxSettings"+q;o[y]=b[g][y]||b[g].fxName||b.defaults[y]||b.defaults.fxName||o[y]||o.fxName||d[y]||d.fxName||"none";var x=o[y];if(x=="none"||!h.effects||!h.effects[x]||!I[x]&&!o[C]&&!o.fxSettings)x=o[y]="none";x=I[x]||{};y=x.all||{};x=x[g]||{};o[C]=h.extend({},y,x,d.fxSettings||{},d[C]||{},o.fxSettings,o[C],b.defaults.fxSettings,
b.defaults[C]||{},b[g].fxSettings,b[g][C]||{});o[s]=b[g][s]||b[g].fxSpeed||b.defaults[s]||b.defaults.fxSpeed||o[s]||o[C].duration||o.fxSpeed||o.fxSettings.duration||d.fxSpeed||d.fxSettings.duration||x.duration||y.duration||"normal"})})},oa=function(){h.each(A.allPanes.split(","),function(){var c=t(this),d=n[c],e=B[c],g=A[c].dir,i=d.size=="auto"||isNaN(d.size)?0:d.size,q=d.minSize||1,y=d.maxSize||9999,s=d.spacing_open||0,C=d.paneSelector,x={},D;ba[c]=false;if(C.substr(0,1)==="#")D=K[c]=S.find(C+":first");
else{D=K[c]=S.children(C+":first");D.length||(D=K[c]=S.children("form:first").children(C+":first"))}if(!D.length){K[c]=false;return true}D.attr("pane",c).addClass(d.paneClass+" "+d.paneClass+"-"+c);if(c!="center"){e.isClosed=false;e.isSliding=false;e.isResizing=false;e.isHidden=false;e.noRoom=false;A[c].pins=[]}x=h.extend({visibility:"visible",display:"block"},A.defaults.cssReq,A[c].cssReq);d.applyDefaultStyles&&h.extend(x,A.defaults.cssDef,A[c].cssDef);D.css(x);x={};switch(c){case "north":x.top=
H.top;x.left=H.left;x.right=H.right;break;case "south":x.bottom=H.bottom;x.left=H.left;x.right=H.right;break;case "west":x.left=H.left;break;case "east":x.right=H.right}if(g=="horz"){if(i===0||i=="auto"){D.css({height:"auto"});i=D.outerHeight()}i=z(i,q);i=Math.min(i,y);i=Math.min(i,H.innerHeight-s);x.height=z(1,M(c,i));e.size=i;e.maxSize=y;e.minSize=z(q,i-x.height+1);D.css(x)}else if(g=="vert"){if(i===0||i=="auto"){D.css({width:"auto","float":"left"});i=D.outerWidth();D.css({"float":"none"})}i=z(i,
q);i=Math.min(i,y);i=Math.min(i,H.innerWidth-s);x.width=z(1,G(c,i));e.size=i;e.maxSize=y;e.minSize=z(q,i-x.width+1);D.css(x);aa(c,null,true)}else if(c=="center"){D.css(x);aa("center",null,true)}if(d.initClosed&&d.closable){D.hide().addClass("closed");e.isClosed=true}else if(d.initHidden||d.initClosed){ja(c,true);e.isHidden=true}else D.addClass("open");d.showOverflowOnHover&&D.hover(j,l);if(d.contentSelector){e=ba[c]=D.children(d.contentSelector+":first");if(!e.length){ba[c]=false;return true}e.css(A.content.cssReq);
d.applyDefaultStyles&&e.css(A.content.cssDef);D.css({overflow:"hidden"})}})},va=function(){h.each(A.borderPanes.split(","),function(){var c=t(this),d=n[c],e=B[c],g=d.resizerClass,i=d.togglerClass,q=K[c];T[c]=false;ca[c]=false;if(!(!q||!d.closable&&!d.resizable)){var y=A[c].edge;q=q.is(":visible");var s="-"+c,C=q?"-open":"-closed",x;x=T[c]=h("<span></span>");q&&d.resizable||!q&&d.slidable&&x.attr("title",d.sliderTip).css("cursor",d.sliderCursor);x.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+
"-resizer":"").attr("resizer",c).css(A.resizers.cssReq).css(y,H[y]+O(c)).addClass(g+" "+g+s+" "+g+C+" "+g+s+C).appendTo(S);d.applyDefaultStyles&&x.css(A.resizers.cssDef);if(d.closable){g=ca[c]=h("<div></div>");g.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-toggler":"").css(A.togglers.cssReq).attr("title",q?d.togglerTip_open:d.togglerTip_closed).click(function(D){fa(c);D.stopPropagation()}).mouseover(function(D){D.stopPropagation()}).addClass(i+" "+i+s+" "+i+C+" "+i+s+C).appendTo(x);
if(d.togglerContent_open)h("<span>"+d.togglerContent_open+"</span>").addClass("content content-open").css("display",e.isClosed?"none":"block").appendTo(g);if(d.togglerContent_closed)h("<span>"+d.togglerContent_closed+"</span>").addClass("content content-closed").css("display",e.isClosed?"block":"none").appendTo(g);d.applyDefaultStyles&&g.css(A.togglers.cssDef);q||ka(c,true)}}});da("all",true)},wa=function(){var c=typeof h.fn.draggable=="function",d;h.each(A.borderPanes.split(","),function(){var e=
t(this),g=n[e],i=B[e];if(!c||!K[e]||!g.resizable){g.resizable=false;return true}var q=g.resizerClass,y=q+"-drag",s=q+"-"+e+"-drag",C=q+"-dragging",x=q+"-"+e+"-dragging",D=false,J=T[e];i.isClosed||J.attr("title",g.resizerTip).css("cursor",g.resizerCursor);J.draggable({containment:S[0],axis:A[e].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:g.resizerDragOpacity,zIndex:A.zIndex.resizing,start:function(){if(false===v(e,g.onresize_start))return false;i.isResizing=true;ga(e,"closeSlider");
J.addClass(y+" "+s);D=false;var Q=e=="east"||e=="south"?g.spacing_open:0;P(e);i.minPosition-=Q;i.maxPosition-=Q;d=A[e].dir=="horz"?"top":"left";h(g.maskIframesOnResize===true?"iframe":g.maskIframesOnResize).each(function(){h('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(h(this).offset()).appendTo(this.parentNode)})},drag:function(Q,R){if(!D){h(".ui-draggable-dragging").addClass(C+
" "+x).children().css("visibility","hidden");D=true;i.isSliding&&K[e].css("zIndex",A.zIndex.sliding)}if(R.position[d]<i.minPosition)R.position[d]=i.minPosition;else if(R.position[d]>i.maxPosition)R.position[d]=i.maxPosition},stop:function(Q,R){var U=R.position,Y;J.removeClass(y+" "+s);switch(e){case "north":Y=U.top;break;case "west":Y=U.left;break;case "south":Y=H.outerHeight-U.top-J.outerHeight();break;case "east":Y=H.outerWidth-U.left-J.outerWidth()}la(e,Y-H[A[e].edge]);h("div.ui-layout-mask").remove();
i.isResizing=false}})})},ja=function(c,d){var e=n[c],g=B[c],i=K[c],q=T[c];if(!(!i||g.isHidden))if(false!==v(c,e.onhide_start)){g.isSliding=false;q&&q.hide();if(d||g.isClosed){g.isClosed=true;g.isHidden=true;i.hide();aa(A[c].dir=="horz"?"all":"center");v(c,e.onhide_end||e.onhide)}else{g.isHiding=true;X(c,false)}}},ha=function(c,d){var e=n[c],g=B[c],i=T[c];if(K[c]&&g.isHidden)if(false!==v(c,e.onshow_start)){g.isSliding=false;g.isShowing=true;i&&e.spacing_open>0&&i.show();d===false?X(c,true):Z(c)}},
fa=function(c){var d=B[c];if(d.isHidden)ha(c);else d.isClosed?Z(c):X(c)},X=function(c,d,e){function g(){ka(c,true);R||v(c,s.onclose_end||s.onclose);if(R)v(c,s.onshow_end||s.onshow);if(U)v(c,s.onhide_end||s.onhide);w(c)}var i=K[c],q=T[c],y=ca[c],s=n[c],C=B[c];e=!e&&!C.isClosed&&s.fxName_close!="none";var x=A[c].edge,D=s.resizerClass,J=s.togglerClass,Q="-"+c,R=C.isShowing,U=C.isHiding;delete C.isShowing;delete C.isHiding;if(!(!i||!s.resizable&&!s.closable))if(!(!d&&C.isClosed&&!R))if(A.isLayoutBusy)k("close",
c,d);else if(!(!R&&false===v(c,s.onclose_start))){A[c].isMoving=true;A.isLayoutBusy=true;C.isClosed=true;if(U)C.isHidden=true;else if(R)C.isHidden=false;m(c,false);C.isSliding||aa(A[c].dir=="horz"?"all":"center");if(q){q.css(x,H[x]).removeClass(D+"-open "+D+Q+"-open").removeClass(D+"-sliding "+D+Q+"-sliding").addClass(D+"-closed "+D+Q+"-closed");s.resizable&&q.draggable("disable").css("cursor","default").attr("title","");y&&y.removeClass(J+"-open "+J+Q+"-open").addClass(J+"-closed "+J+Q+"-closed").attr("title",
s.togglerTip_closed);da()}if(e){ia(c,true);i.hide(s.fxName_close,s.fxSettings_close,s.fxSpeed_close,function(){ia(c,false);C.isClosed&&g()})}else{i.hide();g()}}},Z=function(c,d,e){function g(){C.isSliding||aa(A[c].dir=="vert"?"center":"all");if(q){q.css(x,H[x]+O(c)).removeClass(D+U+" "+D+Q+U).addClass(D+R+" "+D+Q+R).addClass(!C.isSliding?"":D+Y+" "+D+Q+Y);s.resizable?q.draggable("enable").css("cursor",s.resizerCursor).attr("title",s.resizerTip):q.css("cursor","default");y&&y.removeClass(J+U+" "+J+
Q+U).addClass(J+R+" "+J+Q+R).attr("title",s.togglerTip_open);da("all")}ea(c);m(c,!C.isSliding);v(c,s.onopen_end||s.onopen);if(ma)v(c,s.onshow_end||s.onshow);w(c)}var i=K[c],q=T[c],y=ca[c],s=n[c],C=B[c];e=!e&&C.isClosed&&s.fxName_open!="none";var x=A[c].edge,D=s.resizerClass,J=s.togglerClass,Q="-"+c,R="-open",U="-closed",Y="-sliding",ma=C.isShowing;delete C.isShowing;if(!(!i||!s.resizable&&!s.closable))if(C.isClosed||C.isSliding)if(C.isHidden&&!ma)ha(c,true);else if(A.isLayoutBusy)k("open",c,d);else if(false!==
v(c,s.onopen_start)){A[c].isMoving=true;A.isLayoutBusy=true;C.isSliding&&!d&&na(c,false);C.isClosed=false;if(ma)C.isHidden=false;P(c);C.size>C.maxSize&&i.css(A[c].sizeType,z(1,A[c].dir=="horz"?M(c,C.maxSize):G(c,C.maxSize)));ka(c,false);if(e){ia(c,true);i.show(s.fxName_open,s.fxSettings_open,s.fxSpeed_open,function(){ia(c,false);C.isClosed||g()})}else{i.show();g()}}},ia=function(c,d){var e=K[c];if(d){e.css({zIndex:A.zIndex.animation});if(c=="south")e.css({top:H.top+H.innerHeight-e.outerHeight()});
else c=="east"&&e.css({left:H.left+H.innerWidth-e.outerWidth()})}else{B[c].isSliding||e.css({zIndex:A.zIndex.pane_normal});if(c=="south")e.css({top:"auto"});else c=="east"&&e.css({left:"auto"})}},ka=function(c,d){var e=n[c],g=T[c],i=e.slideTrigger_open;if(g&&e.slidable){if(i!="click"&&i!="dblclick"&&i!="mouseover")i="click";g[d?"bind":"unbind"](i,xa).css("cursor",d?e.sliderCursor:"default").attr("title",d?e.sliderTip:"")}},na=function(c,d){function e(y){ga(c,"closeSlider");y.stopPropagation()}var g=
n[c].slideTrigger_close,i=K[c],q=T[c];B[c].isSliding=d;ga(c,"closeSlider");i.css({zIndex:d?A.zIndex.sliding:A.zIndex.pane_normal});q.css({zIndex:d?A.zIndex.sliding:A.zIndex.resizer_normal});if(g!="click"&&g!="mouseout")g="mouseout";if(d){i.bind(g,pa);q.bind(g,pa);g="mouseout";i.bind("mouseover",e);q.bind("mouseover",e)}else{i.unbind(g);q.unbind(g);g="mouseout";i.unbind("mouseover");q.unbind("mouseover");ga(c,"closeSlider")}},xa=function(){var c=h(this).attr("resizer");if(B[c].isClosed){na(c,true);
Z(c,true)}},pa=function(){function c(){na(e,false);g.isClosed||X(e)}var d=h(this),e=d.attr("pane")||d.attr("resizer");d=n[e];var g=B[e];g.isClosed||g.isResizing||(d.slideTrigger_close=="click"?c():ra(e,"closeSlider",c,300))},la=function(c,d){var e=A[c].edge,g=A[c].dir,i=n[c],q=B[c],y=K[c],s=T[c];P(c);q.minSize=z(q.minSize,i.minSize);if(i.maxSize>0)q.maxSize=Math.min(q.maxSize,i.maxSize);d=z(d,q.minSize);d=Math.min(d,q.maxSize);q.size=d;s.css(e,d+H[e]);y.css(A[c].sizeType,z(1,A[c].dir=="horz"?M(c,
d):G(c,d)));q.isSliding||aa(g=="horz"?"all":"center");da();ea(c);v(c,i.onresize_end||i.onresize)},aa=function(c,d,e){if(!c||c=="all")c="east,west,center";var g=V();d&&h.extend(g,d);h.each(c.split(","),function(){if(K[this]){var i=t(this),q=n[i],y=B[i],s=K[i],C=T[i],x=true,D={};if(i=="center"){g=V();D=h.extend({},g);D.width=z(1,G(i,D.width));D.height=z(1,M(i,D.height));x=D.width>1&&D.height>1;if(h.browser.msie&&(!h.boxModel||h.browser.version<7)){K.north&&K.north.css({width:G(K.north,H.innerWidth)});
K.south&&K.south.css({width:G(K.south,H.innerWidth)})}}else{D.top=g.top;D.bottom=g.bottom;D.height=z(1,M(i,g.height));x=D.height>1}if(x){s.css(D);if(y.noRoom){y.noRoom=false;if(y.isHidden)return;else ha(i,!y.isClosed)}if(!e){ea(i);v(i,q.onresize_end||q.onresize)}}else if(!y.noRoom){y.noRoom=true;if(!y.isHidden)if(e){s.hide();C&&C.hide()}else ja(i)}}})},ea=function(c){if(!c||c=="all")c=A.allPanes;h.each(c.split(","),function(){if(ba[this]){var d=t(this),e=n[d].contentIgnoreSelector,g=K[d];d=ba[d];
var i=d[0],q=M(g);g.children().each(function(){if(this!=i){var y=h(this);if(!e||!y.is(e))q-=y.outerHeight()}});if(q>0)q=M(d,q);q<1?d.hide():d.css({height:q}).show()}})},da=function(c,d){if(!c||c=="all")c=A.borderPanes;h.each(c.split(","),function(){var e=t(this),g=n[e],i=B[e],q=K[e],y=T[e],s=ca[e];if(!(!q||!y||!g.resizable&&!g.closable)){var C=A[e].dir,x=i.isClosed?"_closed":"_open";e=g["spacing"+x];var D=g["togglerAlign"+x];x=g["togglerLength"+x];var J;if(e==0)y.hide();else{!i.noRoom&&!i.isHidden&&
y.show();if(C=="horz"){J=q.outerWidth();y.css({width:z(1,G(y,J)),height:z(1,M(y,e)),left:F(q,"left")})}else{J=q.outerHeight();y.css({height:z(1,M(y,J)),width:z(1,G(y,e)),top:H.top+O("north",true)})}if(s){if(x==0||i.isSliding&&g.hideTogglerOnSlide){s.hide();return}else s.show();if(!(x>0)||x=="100%"||x>J){x=J;q=0}else if(typeof D=="string")switch(D){case "top":case "left":q=0;break;case "bottom":case "right":q=J-x;break;default:q=Math.floor((J-x)/2)}else{q=parseInt(D);q=D>=0?q:J-x+q}J=g.togglerContent_open?
s.children(".content-open"):false;var Q=g.togglerContent_closed?s.children(".content-closed"):false;D=i.isClosed?Q:J;if(J)J.css("display",i.isClosed?"none":"block");if(Q)Q.css("display",i.isClosed?"block":"none");if(C=="horz"){i=G(s,x);s.css({width:z(0,i),height:z(1,M(s,e)),left:q});D&&D.css("marginLeft",Math.floor((i-D.outerWidth())/2))}else{i=M(s,x);s.css({height:z(0,i),width:z(1,G(s,e)),top:q});D&&D.css("marginTop",Math.floor((i-D.outerHeight())/2))}}if(d&&g.initHidden){y.hide();s&&s.hide()}}}})},
qa=function(){var c=H.innerWidth,d=H.innerHeight;H=B.container=W(S);var e=H.innerHeight<d,g=H.innerWidth<c,i,q;if(e||g)h.each(["south","north","east","west"],function(y,s){i=B[s];q=A[s].dir;if(!i.isClosed&&(e&&q=="horz"||g&&q=="vert")){P(s);i.size>i.maxSize&&la(s,i.maxSize)}});aa("all");da("all")},S=h(this).css({overflow:"hidden"}),K={},ba={},T={},ca={},A={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},H=B.container;(function(){ua();sa();oa();va();wa();ea("all");if(n.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();h(window).resize(function(){var c="timerLayout_"+B.id;window[c]&&clearTimeout(window[c]);window[c]=null;window[c]=setTimeout(qa,100)})})();return{options:n,state:B,panes:K,toggle:fa,open:Z,close:X,hide:ja,show:ha,resizeContent:ea,sizePane:la,reinitPane:oa,resizeAll:qa,addToggleBtn:function(c,d){var e=
f(c,d,"toggle");if(e)e.attr("title",B[d].isClosed?"Open":"Close").click(function(g){fa(d);g.stopPropagation()})},addOpenBtn:function(c,d){var e=f(c,d,"open");e&&e.attr("title","Open").click(function(g){Z(d);g.stopPropagation()})},addCloseBtn:function(c,d){var e=f(c,d,"close");e&&e.attr("title","Close").click(function(g){X(d);g.stopPropagation()})},addPinBtn:function(c,d){var e=f(c,d,"pin");if(e){var g=B[d];e.click(function(i){p(h(this),d,g.isSliding||g.isClosed);g.isSliding||g.isClosed?Z(d):X(d);
i.stopPropagation()});p(e,d,!g.isClosed&&!g.isSliding);A[d].pins.push(c)}},allowOverflow:j,resetOverflow:l,cssWidth:G,cssHeight:M}}})(jQuery);
(function(){var h=function(){var b=null,u=function(j,l){var f=$($.mustache(l,j.tag));f.data("data",j);if(!b.tagMenu){b.tagMenu=f.find(".tag-menu");b.tagMenu.hide()}f.find(".tag-menu").remove();f.find(".color-selector").bind("click",function(m){var p=b.tagMenu;m=$(m.target);if(p.data("visible")===true&&p.data("tagId")===j.tag.id){p.hide("fast");p.data("visible",false);p.data("tagId",null);p.data("tag",null);p.data("target",null)}else{p.show("fast");p.css({left:f.position().left,top:f.position().top-
100});p.data("visible",true);p.data("tagId",j.tag.id);p.data("tag",j);p.data("target",m)}return false});ListKungFu&&ListKungFu.LayoutWest&&f.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});f.bind("click",function(){var m=f.data("data");if(f.data("selected")){m=m.tag.id;for(var p=
[],r=0;r<b.selectedTags.length;r++)b.selectedTags[r]!==m&&p.push(b.selectedTags[r]);b.selectedTags=p;f.removeClass("tag-selected");f.data("selected",false)}else{b.selectedTags.push(m.tag.id);b.selectedTags=jQuery.unique(b.selectedTags);f.addClass("tag-selected");f.data("selected",true)}b._trigger("TagSelected",0,b.selectedTags);return false});return f};return{options:{},_create:function(){b=this;b.toolbar=$('<div id="tag-toolbar"></div>');b.addTagInput=$('<input type="text" value="" id="add-tag"/>');
b.addTagButton=$('<button id="tag-new">Create Tag</button>');b.tagList=$('<div class="tags"></div>');b.element.append(b.toolbar);b.toolbar.append(b.addTagInput);b.toolbar.append(b.addTagButton);b.element.append(b.tagList);b.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});b.selectedTags=[];Tag.Index({successCallback:function(j,l){for(var f=0;f<l.length;f++)b.tagList.append(u(l[f],j));b.tagList.append(b.tagMenu);b.tagMenu.find(".color").bind("click",function(m){var p=$(m.target).attr("data-colorclass");
m=b.tagMenu.data("tag");var r=m.tag.color_class,n=b.tagMenu.data("target");m.tag.color_class=p;Tag.Update({send:m,successCallback:function(I,B){b._trigger("AfterColorChanged",0,{});n.parent(".tag").removeClass(r);n.parent(".tag").addClass(p);n.removeClass(r);n.addClass(p);b.tagMenu.hide("fast");b.tagMenu.data("visible",false);b.tagMenu.data("tagId",null);b.tagMenu.data("tag",null);b.tagMenu.data("target",null);n.data("data",B)},tags:m.tag.id})});b.tagMenu.find(".delete-label").bind("click",function(){var m=
b.tagMenu.data("tag"),p=b.tagMenu.data("target");b.tagMenu.hide();var r=function(){Tag.Destroy({successCallback:function(){p.hide("fast",function(){p.parent(".tag").remove()})},tags:m.tag.id})};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete Tag",r,"Cancel","Delete Tag and remove it from all lists?");b.deleteDialog.dialog("open");return false})}});b.addTagButton.bind("click",function(){if($.trim(b.addTagInput.val())!==""&&b.tagList.find(".tag-name:HasExactValue('"+
$.trim(b.addTagInput.val())+"')").length===0){var j={};j.tag={name:b.addTagInput.val(),color_class:"c1"};Tag.Create({send:j,successCallback:function(l,f){var m=u(f,l);b.tagList.prepend(m);b.addTagInput.val("");b.addTagInput.trigger("keyup")}});return false}});b.addTagInput.bind("keyup","return",function(){b.addTagButton.trigger("click")});b.addTagInput.bind("keyup",function(){var j=$(this).val();if(j==="")b.tagList.find(".tag").show();else{b.tagList.find(".tag:not(:Contains('"+j+"'))").hide();b.tagList.find(".tag:Contains('"+
j+"')").show()}b.tagList.find(".tag-name:HasExactValue('"+$.trim(j)+"')").length>0?b.addTagButton.button("option","disabled",true):b.addTagButton.button("option","disabled",false)})},destroy:function(){b.element.children().remove()}}}();$.widget("ui.TagView",h)})();
