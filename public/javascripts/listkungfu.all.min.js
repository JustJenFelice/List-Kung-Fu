var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};jQuery.expr[":"].Contains=function(d,b,l){return jQuery(d).text().toLowerCase().indexOf(l[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(d,b,l){return jQuery.trim(jQuery(d).text().toLowerCase())===l[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:92,minSize:92},south:{minSize:40},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(d,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(d,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(d,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(d,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)},AfterColorChanged:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},
TagSelected:function(d,b){ListKungFu.LayoutWest.ListView("FilterByTags",b)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(d){var b={},l=function(h){var j=$(h).length>0?{}:false;$(h).each(function(g,m){var n=$(m).attr("model"),q=$(m).attr("field"),p=$(m).text();j[n]=j[n]||{};j[n][q]=j[n][q]||[];j[n][q].push(p)});return j};b.ClearFlash=function(){b.flash={notice:"",error:"",warning:"",message:""}};b.ClearFlash();b.SetFlash=function(h){b.flash.notice=h.getResponseHeader("X-Flash-Notice")||"";b.flash.error=h.getResponseHeader("X-Flash-Error")||"";b.flash.warning=h.getResponseHeader("X-Flash-Warning")||
"";b.flash.message=h.getResponseHeader("X-Flash-Message")||"";if(typeof d.onFlashUpdate==="function")if(b.flash.notice!==""||b.flash.error!==""||b.flash.warning!==""||b.flash.message!=="")d.onFlashUpdate(b.flash.notice,b.flash.error,b.flash.warning,b.flash.message)};b.baseURL=d.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";b.route=d.route;b.DefaultCallback=function(h,j,g,m){b.SetFlash(m);var n=$.parseJSON($(j).find("JSON").text()),
q=$(j).find("Template").text();j=l($(j).find("Error"));typeof h==="function"&&h(q,n,g,m,j);b.ClearFlash()};b.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};b.ConstructRoute=function(h){for(var j=
"",g="",m=0;m<b.route.length;m++){j+=b.route[m];g=h[b.route[m]]||"";if(g!=="")j+="/"+g;if(m!==b.route.length-1)j+="/"}return j};b.Index=function(h){var j=h.successCallback||null,g=b.ConstructRoute(h);$.ajax({url:b.baseURL+g,dataType:"xml",type:"GET",processData:true,contentType:"application/json",data:h.send,success:function(m,n,q){b.DefaultCallback(j,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Show=function(h){var j=h.successCallback||null;h=b.ConstructRoute(h);$.ajax({url:b.baseURL+
h,dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(g,m,n){b.DefaultCallback(j,g,m,n)},error:function(g,m,n){b.DefaultErrorCallback(g,m,n)}})};b.New=function(h){var j=h.successCallback||null;h=b.ConstructRoute(h);$.ajax({url:b.baseURL+h+"/new",dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(g,m,n){b.DefaultCallback(j,g,m,n)},error:function(g,m,n){b.DefaultErrorCallback(g,m,n)}})};b.Create=function(h){var j=h.successCallback||
null,g=b.ConstructRoute(h);h=JSON.stringify(h.send);$.ajax({url:b.baseURL+g,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:h,success:function(m,n,q){b.DefaultCallback(j,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Edit=function(h){var j=h.successCallback||null;h=b.ConstructRoute(h);$.ajax({url:b.baseURL+h+"/edit",dataType:"xml",type:"GET",parseData:false,contentType:"application/json",success:function(g,m,n){b.DefaultCallback(j,g,m,n)},error:function(g,
m,n){b.DefaultErrorCallback(g,m,n)}})};b.Update=function(h){var j=h.successCallback||null,g=b.ConstructRoute(h);h=JSON.stringify(h.send);h=h.replace(/\\u000a/g,"\\n");$.ajax({url:b.baseURL+g,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:h,beforeSend:function(m){m.setRequestHeader("X-Http-Method-Override","PUT")},success:function(m,n,q){b.DefaultCallback(j,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Destroy=function(h){var j=h.successCallback||
null;h=b.ConstructRoute(h);$.ajax({url:b.baseURL+h,dataType:"xml",type:"POST",processData:false,contentType:"application/json",beforeSend:function(g){g.setRequestHeader("X-Http-Method-Override","DELETE")},success:function(g,m,n){b.DefaultCallback(j,g,m,n)},error:function(g,m,n){b.DefaultErrorCallback(g,m,n)}})};return b},List=Controller({route:["lists"],onFlashUpdate:function(d,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",d)}}),ListListItem=Controller({route:["lists",
"list_items"],onFlashUpdate:function(d,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",d)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(d,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",d)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(d,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",d)}});
jQuery(function(d){var b=d("meta[name=csrf-token]").attr("content"),l=d("meta[name=csrf-param]").attr("content");d.fn.extend({triggerAndReturn:function(j,g){var m=new d.Event(j);this.trigger(m,g);return m.result!==false},callRemote:function(){var j=this,g=j.attr("method")||j.attr("data-method")||"GET",m=j.attr("action")||j.attr("href"),n=j.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(j.triggerAndReturn("ajax:before")){var q=
j.is("form")?j.serializeArray():[];d.ajax({url:m,data:q,dataType:n,type:g.toUpperCase(),beforeSend:function(p){j.trigger("ajax:loading",p)},success:function(p,G,A){j.trigger("ajax:success",[p,G,A])},complete:function(p){j.trigger("ajax:complete",p)},error:function(p,G,A){j.trigger("ajax:failure",[p,G,A])}})}j.trigger("ajax:after")}}});d("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var j=d(this);if(j.triggerAndReturn("confirm"))if(!confirm(j.attr("data-confirm")))return false});
d("form[data-remote]").live("submit.rails",function(j){d(this).callRemote();j.preventDefault()});d("a[data-remote],input[data-remote]").live("click.rails",function(j){d(this).callRemote();j.preventDefault()});d("a[data-method]:not([data-remote])").live("click.rails",function(j){var g=d(this),m=g.attr("href");g=g.attr("data-method");m=d('<form method="post" action="'+m+'"></form>');g='<input name="_method" value="'+g+'" type="hidden" />';if(l!==undefined&&b!==undefined)g+='<input name="'+l+'" value="'+
b+'" type="hidden" />';m.hide().append(g).appendTo("body");j.preventDefault();m.submit()});var h=function(){d(this).find("input[data-disable-with]").each(function(){var j=d(this);j.data("enable-with",j.val()).attr("value",j.attr("data-disable-with")).attr("disabled","disabled")})};d("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",h);d("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",h);d("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){d(this).find("input[data-disable-with]").each(function(){var j=d(this);j.removeAttr("disabled").val(j.data("enable-with"))})});h=d().jquery;if(h==="1.4"||h==="1.4.1"||h==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(d){d.confirmationDialog=function(b,l,h,j){dialog=d('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+j+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});j={};j[b]=function(){d(dialog).dialog("close");l()};j[h]=function(){d(dialog).dialog("close")};dialog.dialog("option","buttons",j);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown",
"right",function(g){g=d(g.target);if(g.next("button").length>0){g.blur();g.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(g){g=d(g.target);if(g.prev("button").length>0){g.blur();g.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){var d=function(){var b=null,l=function(g){var m=$(this),n=g.find(".dashboard-list-item-deadline-hidden"),q=g.data("data"),p=q.list_item.deadline_date.split("-"),G=p[0],A=p[1],J=p[2];n.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",beforeShow:function(K,t){t.input.datepicker("setDate",G+","+A+","+J)},onSelect:function(K){q.list_item.deadlineType="customdeadline";q.list_item.customDeadlineValue=K;q.list_item.template="dashboard";ListListItem.Update({successCallback:function(t,B){var C=
g.parent();g.hide("slow",function(){g.remove();C.find(".dashboard-item").length===0&&C.append('<p class="nothing-todo">no items scheduled</p>')});j(B,t,{highlightCategory:true,addType:"prepend"})},lists:q.list_item.list_id,list_items:q.list_item.id,send:q});m.datepicker("hide")}})},h=function(g,m,n){n=n||{};g.find(".nothing-todo").remove();n.addType==="prepend"?g.find("div[data-type=scheduleColumn]").first().prepend(m):g.find("div[data-type=scheduleColumn]").first().append(m);n.highlightCategory===
true&&m.effect("highlight",{},2E3)},j=function(g,m,n){var q=$($.mustache(m,g.list_item));switch(g.list_item.deadline_category){case "today":h(b.today,q,n);break;case "tomorrow":h(b.tomorrow,q,n);break;case "this week":h(b.thisweek,q,n);break;case "next week":h(b.nextweek,q,n);break;default:h(b.later,q,n)}q.data("data",g);q.find(".dashboard-list-item-title").bind("click",function(){b._trigger("OpenList",0,{selectedList:g.list_item})});q.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",
0,{selectedList:g.list_item})});q.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var p=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');$that.append(p);$that.animate({width:"100%",paddingLeft:"14px"},200);p.find(".yes").bind("click",function(){g.list_item.completed=true;ListListItem.Update({successCallback:function(){q.stop(true,true).hide("slow",function(){q.remove()})},
lists:g.list_item.list_id,list_items:g.list_item.id,send:g});p.find(".no").trigger("click");return false});p.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){p.remove()});return false})});q.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",0,{selectedList:g.list_item})});l(q);q.find(".dashboard-list-item-deadline").bind("click",function(){q.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});
return q};return{options:{},Show:function(){b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.toolbar=$('<div id="dashboard-toolbar"><input type="text" id="dashboard-search" value=""/></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn"></div></div>');b.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn"></div></div>');
b.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn"></div></div>');b.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn"></div></div>');b.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn"></div></div>');b.element.append(b.header);b.header.append(b.toolbar);b.element.append(b.wrapper);b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);
b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');b.toolbar.append('<div id="dashboard-search-cancel">&nbsp;</div><div style="clear:both;">&nbsp;</div>');ListItem.Index({successCallback:function(g,m){$.each(m,function(n,q){j(q,g)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append('<p class="nothing-todo">no items scheduled</p>')});b._trigger("ReinitPanes",0,{});b._trigger("ContentDimensionsChanged",
0,{})},send:{show:"dashboard"}});b.toolbar.find("#dashboard-search").bind("keyup",function(){var g=$(this).val();if(g==="")b.wrapper.find(".dashboard-item").show();else{b.wrapper.find(".dashboard-item:not(:Contains('"+g+"'))").hide();b.wrapper.find(".dashboard-item:Contains('"+g+"')").show()}});b.toolbar.find("#dashboard-search-cancel").bind("click",function(){b.toolbar.find("#dashboard-search").val("").trigger("keyup")})},Hide:function(){b.element.children().remove()},_create:function(){b=this},
destroy:function(){}}}();$.widget("ui.Dashboard",d)})();
(function(d){function b(l){if(typeof l.data==="string"){var h=l.handler,j=l.data.toLowerCase().split(" ");l.handler=function(g){if(!(this!==g.target&&(/textarea|select/i.test(g.target.nodeName)||g.target.type==="text"))){var m=g.type!=="keypress"&&d.hotkeys.specialKeys[g.which],n=String.fromCharCode(g.which).toLowerCase(),q="",p={};if(g.altKey&&m!=="alt")q+="alt+";if(g.ctrlKey&&m!=="ctrl")q+="ctrl+";if(g.metaKey&&!g.ctrlKey&&m!=="meta")q+="meta+";if(g.shiftKey&&m!=="shift")q+="shift+";if(m)p[q+m]=
true;else{p[q+n]=true;p[q+d.hotkeys.shiftNums[n]]=true;if(q==="shift+")p[d.hotkeys.shiftNums[n]]=true}m=0;for(n=j.length;m<n;m++)if(p[j[m]])return h.apply(this,arguments)}}}}d.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};d.each(["keydown","keyup","keypress"],function(){d.event.special[this]={add:b}})})(jQuery);
(function(){var d=function(){var b=null,l=function(){b._trigger("ContentDimensionsChanged",0,{})},h=function(t){var B=t.find("#deadline-settings-wrapper"),C=t.find("#save-deadline");C.bind("click keydown","return",function(){C.data("settings-visible")?B.hide("fast",function(){B.find(".deadline-button").first();C.data("settings-visible",false)}):B.show("fast",function(){B.find(".deadline-button").first().focus();C.data("settings-visible",true)});return false})},j=function(){$("#custom-deadline-display").datepicker({minDate:new Date,
altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",new Date))},g=function(t,B,C){var u=$($.mustache(B,t.list_item));u.data("data",t);u.data("isFullsize",false);C?b.listItemList.prepend(u):b.listItemList.append(u);u.find(".handle").height(u.height());u.bind("keydown","space",function(){b.toolbar.find("#list-item-completed").effect("puff",
{},300,function(){$(this).show();u.find(".undo").length===0?b.toolbar.find("#list-item-completed").trigger("click"):u.find(".undo").trigger("click")})});u.bind("keydown","del",function(){b.toolbar.find("#list-item-delete").effect("puff",{},300,function(){$(this).show();b.toolbar.find("#list-item-delete").trigger("click")})});u.bind("focus",function(I){if($(I.target).hasClass("row")){b.listItemList.find(".row").removeClass("selected-row");$(I.target).addClass("selected-row");$(I.target).data("data");
if(b.toolbar)$(I.target).data("isFullsize")===true?b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"}):b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"});var H=$(I.target);I=$(I.target).data("data");b.selectedListItem={element:H,data:I}}});$.browser.msie&&u.bind("click ",function(){u.focus();return false});u.bind("keydown","down",function(I){I.preventDefault();$(I.target).nextAll("div:visible").first().focus();return false});
u.bind("keydown","up",function(I){I.preventDefault();$(I.target).prevAll("div:visible").first().focus();return false});u.bind("keydown dblclick","return",function(){if(u.find("form").length>0)return false;b.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});b.listItemList.find(".row").find("form").hide("slow",function(){$(this).remove()});ListListItem.Edit({successCallback:function(I){var H=$(I),M=u.data("isFullsize");b.listItemList.find(".row").hide();b.selectedListItem.element.show();
H.hide();b.selectedListItem.element.prepend(H);H.find("textarea").markItUp(mySettings);h(H);j();M===false&&m(u);b.selectedListItem.element.find(".handle").hide();H.show("slow",function(){H.find("textarea").focus()});H.find("textarea").bind("keydown","esc",function(){H.find("#cancel-edit").trigger("click")});H.find(".deadline-button").bind("keydown click","return",function(O){O.preventDefault();var P=u.find("form").serializeForm();P.list_item.deadlineType=$(O.target).attr("data-deadline");P.list_item.customDeadlineValue=
$("#custom-deadline-value").val();ListListItem.Update({send:P,successCallback:function(T,U){H.hide("slow",function(){$(this).remove();b.selectedListItem.element.find(".handle").show();u.find(".list-item-content").html(U.list_item.body_rendered);u.find(".list-item-deadline").html(U.list_item.deadline_in_words);u.find(".handle").height(u.find(".list-item-content").height());M===false&&m(u);b.selectedListItem={element:u,data:U};u.data("data",U);b.listItemList.find(".row").show();u.focus()})},lists:b.selectedListItem.data.list_item.list_id,
list_items:b.selectedListItem.data.list_item.id});return false});H.find("#cancel-edit").bind("keydown click","return",function(O){O.preventDefault();b.selectedListItem.element.find(".handle").show();H.hide("slow",function(){$(this).remove();M===false&&m(u);b.listItemList.find(".row").show();u.focus()});return false});return false},lists:b.selectedListItem.data.list_item.list_id,list_items:b.selectedListItem.data.list_item.id})});u.bind("keydown","left",function(){b._trigger("SelectLastList",0,{})});
u.bind("keydown","shift+return",function(){b.toolbar.find("#list-item-new").effect("puff",{},300,function(){$(this).show();K()})});u.bind("keydown","l",function(){b.toolbar.find("#list-item-fullsize").effect("puff",{},300,function(){b.toolbar.find("#list-item-fullsize").trigger("click");$(this).show()});return false});ListKungFu&&ListKungFu.LayoutCenter&&u.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+u.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},
appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingListItem",0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});n(u)},m=function(t){if(t.data("isFullsize")===true){n(t,false);t.data("isFullsize",false);b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"})}else{n(t,true);t.data("isFullsize",true);
b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"})}},n=function(t,B){t.height()>150&&!B?t.height(150):t.height("auto");l()},q=function(t,B){ListListItem.Destroy({successCallback:function(){t.hide("slow",function(){var C=t.next(".row");C.length>0||(C=t.prev(".row"));C.focus();t.remove();b.toolbar.find("#list-item-search").trigger("ClearValue")})},lists:B.list_item.list_id,list_items:B.list_item.id})},p=function(t,B){B.list_item.completed=true;ListListItem.Update({successCallback:function(){var C=
"list-item-undo-"+B.list_item.id;t.find(".list-item-wrapper").hide("slow",function(){var u=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');u.bind("click",function(){G(t,B,C)});t.append(u);n(t);u.delay(5E3,C).queue(C,function(){t.hide("slow",function(){t.remove()})}).dequeue(C);b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&A(true);t.focus()})},lists:B.list_item.list_id,list_items:B.list_item.id,send:B})},G=function(t,B,C){C!==""&&t.clearQueue(C);B.list_item.completed=
false;ListListItem.Update({successCallback:function(){t.find(".undo").hide("slow",function(){$(this).remove()});t.find(".list-item-wrapper").show("slow",function(){n(t)});b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&A(true)},lists:B.list_item.list_id,list_items:B.list_item.id,send:B})},A=function(t){if(t===true){if(b.completedList){b.completedList.remove();b.completedList=null}b.completedList=$('<div id="completedList"></div>');t=b.element.data("data-list");ListListItem.Index({successCallback:function(B,
C){$.each(C,function(u,I){b.completedList.append("<div>"+I.list_item.body_rendered+"</div>")});C.length===0&&b.completedList.append("<div>No completed items</div>");b.wrapper.prepend(b.completedList)},send:{show:"completed"},lists:t.list.id})}else{b.completedList.remove();b.completedList=null}},J=function(){b.header.html("");b.toolbar=$('<div id="list-item-toolbar"> \t\t\t\t<div id="list-name"></div><div id="list-item-toolbar-buttons"> \t\t\t\t<button id="list-item-completed">Completed [space]</button> \t\t\t\t<button id="list-item-new">Create [shift+return]</button> \t\t\t\t<button id="list-item-delete">Delete [del]</button> \t\t\t\t<button id="list-item-edit">Edit [return]</button> \t\t\t\t<button id="list-item-fullsize">Fullsize [l]</button> \t\t\t\t<input type="input" id="list-item-search"/> \t\t\t\t<input type="checkbox" id="showCompleted"/> \t\t\t\t<label for="showCompleted">Show Completed Items</label> \t\t\t\t<div id="list-item-search-cancel">&nbsp;</div> \t\t\t\t</div></div>');
b.listName=b.toolbar.find("#list-name");b.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});b.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.toolbar.find("#list-item-fullsize").button({text:false,icons:{primary:"ui-icon-zoomin"}});b.toolbar.find("#list-item-new").bind("click",
function(){K()});b.toolbar.find("#showCompleted").bind("change",function(t){A(t.target.checked);b.selectedListItem.element.focus()});b.toolbar.find("#list-item-completed").bind("click",function(){p(b.selectedListItem.element,b.selectedListItem.data)});b.toolbar.find("#list-item-delete").bind("click",function(){var t=function(){q(b.selectedListItem.element,b.selectedListItem.data)};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List Item",t,"Cancel","Do you really want to delete?");
b.deleteDialog.dialog("open")});b.toolbar.find("#list-item-edit").bind("click",function(){b.selectedListItem.element.trigger("dblclick")});b.toolbar.find("#list-item-fullsize").bind("click",function(){m(b.selectedListItem.element)});b.toolbar.find("#list-item-search").bind("keyup",function(){var t=$(this).val();if(t==="")b.listItemList.find(".row").show();else{b.listItemList.find(".row:not(:Contains('"+t+"'))").hide();b.listItemList.find(".row:Contains('"+t+"')").show()}});b.toolbar.find("#list-item-search-cancel").bind("click",
function(){b.toolbar.find("#list-item-search").val("").trigger("keyup")});b.toolbar.find("#list-item-search").bind("ClearValue",function(t){$(t.target).val("");b.listItemList.find(".row").show()});b.header.append(b.toolbar)},K=function(){var t=b.element.data("data-list");ListListItem.New({successCallback:function(B){var C=$(B);b.listItemList.prepend(C);h(C);j();C.find("textarea").markItUp(mySettings);C.find("textarea").focus();b.listItemList.find(".row").hide();C.find("#cancel-edit").bind("click",
function(u){u.preventDefault();C.hide("slow",function(){$(this).remove();b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus()})});C.find(".deadline-button").bind("click",function(u){u.preventDefault();var I=C.serializeForm();I.list_item.body=I.list_item.body.replace(/\n/g,"\n\n");I.list_item.deadlineType=$(u.target).attr("data-deadline");I.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:I,successCallback:function(H,M){C.hide("slow",
function(){g(M,H,true);$(this).remove();b.toolbar.find("#list-item-search").trigger("ClearValue");b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();b.listItemList.find(".row").first().find(".handle").height(b.listItemList.find(".row").first().find(".list-item-content").height())})},lists:t.list.id});return false});C.find("textarea").bind("keydown","esc",function(){C.find("#cancel-edit").trigger("click")})},lists:t.list.id})};return{options:{},_create:function(){b=this;
b.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');b.listItemList=$('<div id="list-item-list"></div>');b.header=$('<div class="header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.listItemList);l();$(document).bind("keydown","c",function(){var t=b.toolbar.find("#showCompleted");if(t.length>0){if(t.get(0).checked===true)t.get(0).checked=false;else t.get(0).checked=true;t.trigger("change")}});$(document).bind("keyup","f",function(){b.toolbar.find("#list-item-search").focus()})},
destroy:function(){b.children().remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},RemoveList:function(){b.wrapper.remove();b.header.remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},OpenList:function(t){b.RemoveList();b._create();b.element.data("data-list",t);ListListItem.Index({successCallback:function(B,C){J();$.each(C,function(u,I){g(I,B)});t.id?b.listItemList.find(".row").each(function(){var u=$(this);if(u.data("data").list_item.id===t.id){u.focus();
return false}}):b.listItemList.find(".row").first().focus();b.listItemList.find(".row").length===0&&K();b.listName.text(t.list.title)},lists:t.list.id});b._trigger("ReinitPanes",0,{})},SelectListItem:function(){b.selectedListItem?b.selectedListItem.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):b.listItemList.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})}}}();$.widget("ui.ListItemView",d)})();
(function(){$.widget("ui.ListView",{_ReplaceList:function(d,b,l){b=this._GetListElement(b,l);d.replaceWith(b);this._AdjustHeight();this._triggerResize();b.focus()},_DroppableConfigTags:function(){var d=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(b,l){var h=$(this);if(h.position().top<d.wrapper.height()){var j=l.draggable.data("data"),g=h.data("data");g.list.tag_id=j.tag.id;List.Update({send:g,successCallback:function(m,n){d._ReplaceList(h,n,m)},
lists:g.list.id})}}}},_DroppableConfigListItems:function(d){var b=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(l,h){if($(this).position().top<b.wrapper.height()){var j=h.draggable.data("data"),g=$(this).data("data");j={list_item:{body:j.list_item.body.replace(/\n/g,"\n\n")}};ListListItem.Create({send:j,successCallback:function(){$(l.target).find(".fake-drop").remove();d.effect("highlight",{},3E3)},lists:g.list.id})}},over:function(l,h){var j=
$('<div class="fake-drop"></div>');j.html("<p>"+h.helper.text()+"</p>");$(l.target).append(j)},out:function(l){$(l.target).find(".fake-drop").remove()}}},_IsNewList:function(d){return this.selectedList===null||this.selectedList.data.list.id!==d.list.id?true:false},_HighlightFormErrors:function(d,b){for(var l in b){var h=b[l],j;for(j in h){for(var g=h[j],m=$('<div class="error_explanation"><ul></ul></div>'),n=m.find("ul"),q=d.find("*[name="+(l+"["+j+"]")+"]"),p=0;p<g.length;p++){q.parent(".field").addClass("field_with_errors");
n.append("<li>"+g[p]+"</li>")}q.parent(".field").append(m)}}},_ClearFormErrors:function(d){d.find(".field").removeClass("field_with_errors");d.find(".error_explanation").remove()},_DeleteList:function(d){var b=this,l=b.selectedList.element.next(),h=b.selectedList.element.prev();d=d||0;List.Destroy({successCallback:function(){b.selectedList.element.delay(d).fadeOut(function(){$(this).remove();l.length>0?l.focus():h.focus()});b._trigger("CloseList",0,{})},lists:b.selectedList.data.list.id})},_CreateToolbar:function(){var d=
this,b=$('<div id="list-toolbar"> \t\t\t\t<button id="list-new">Create [shift+return]</button> \t\t\t\t<button id="list-delete">Delete [del]</button> \t\t\t\t<button id="list-edit">Edit [space]</button> \t\t\t\t<input type="text" id="search-list" /> \t\t\t\t<div id="list-search-cancel">&nbsp;</div> \t\t\t\t</div>');d.element.find("div.header").append(b);b.find("#list-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});
b.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.find("#list-delete").bind("click",function(l){if(d.selectedList!==null){if(typeof d.deleteDialog==="undefined")d.deleteDialog=$.confirmationDialog("Delete List",function(){if(d.listForm!==null){d.listForm.bind("FormHidden",function(){d._DeleteList(1E3)});d._HideForm()}else d._DeleteList()},"Cancel","Do you really want to delete?");d.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();
$(l.target).blur();return false});b.find("#list-new").bind("click",function(l){d.listlist.hide("slide",{direction:"left"},"slow",function(){if(d.listForm!=null){d.listForm.remove();d.listForm=null}d.listForm=$('<div class="ui-layout-content" id="list-form"></div>');d.wrapper.append(d.listForm);List.New({successCallback:function(h,j){d.listForm.append(h);d.listForm.show("slide",{direction:"left"},"slow",function(){d.listForm.find("#list_title").first().focus()});d._trigger("CloseList",0,{});d.listForm.find("#list-back-button").bind("click",
function(){d._HideForm()});d.listForm.find("#list_title").bind("keydown","esc",function(){d._HideForm()});d.listForm.bind("submit",function(g){g.preventDefault();g=$(this).find("form").serializeForm();j.list=g.list;List.Create({send:j,successCallback:function(m,n,q,p,G){d._ClearFormErrors(d.listForm);if(G===false){d._HideForm(n,m);d.toolbar.find("#search-list").trigger("ClearValue")}else d._HighlightFormErrors(d.listForm,G)}});return false});d.selectedList=null}})});$(l.target).blur();return false});
b.find("#search-list").bind("keyup",function(){var l=$(this).val();if(l==="")d.listlist.find(".row").show();else{d.listlist.find(".row:not(:Contains('"+l+"'))").hide();d.listlist.find(".row:Contains('"+l+"')").show()}d._AdjustHeight();d._triggerResize()});b.find("#list-search-cancel").bind("click",function(){b.find("#search-list").val("").trigger("keyup")});b.find("#search-list").bind("ClearValue",function(l){$(l.target).val("");d.listlist.find(".row").show()});b.find("#list-edit").bind("click",function(){d.listlist.hide("slide",
{direction:"left"},"slow",function(){if(d.listForm!=null){d.listForm.remove();d.listForm=null}d.listForm=$('<div class="ui-layout-content" id="list-form"></div>');d.wrapper.append(d.listForm);List.Edit({successCallback:function(l){d.listForm.append(l);d.listForm.show("slide",{direction:"left"},"slow",function(){d.listForm.find("#list_title").first().focus()});d.listForm.find("#list-back-button").bind("click",function(){d._HideForm()});d.listForm.find("#list_title").bind("keydown","esc",function(){d._HideForm()});
d.listForm.bind("submit",function(h){h.preventDefault();h=$(this).find("form").serializeForm();List.Update({send:h,successCallback:function(j,g,m,n,q){d._ClearFormErrors(d.listForm);q===false?d._HideForm(g,j):d._HighlightFormErrors(d.listForm,q)},lists:d.selectedList.data.list.id});return false})},lists:d.selectedList.data.list.id})})});return b},_GetListElement:function(d,b){var l=this,h=$($.mustache(b,d.list));h.attr("tabindex",0);h.data("data",d);h.addClass("row");$.browser.msie&&h.bind("click",
function(){h.focus();return false});h.bind("keydown","down",function(j){j.preventDefault();$(j.target).nextAll("div:visible").first().focus();return false});h.bind("keydown","up",function(j){j.preventDefault();$(j.target).prevAll("div:visible").first().focus();return false});h.bind("focus",function(j){j=$(j.target);l.selectedList={element:j,data:j.data("data")};l.listlist.find(".row").removeClass("selected-row");j.addClass("selected-row");l.listlist.find(".assigned-tags").hide();j.find(".assigned-tags").show();
l._AdjustHeight()});h.bind("keydown dblclick","return",function(){l._trigger("OpenList",0,{selectedList:h.data("data")})});h.bind("keydown","right",function(){l._trigger("SelectListItem",0,{})});h.bind("keydown","shift+return",function(){l.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});h.bind("keydown","del",function(){l.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});h.bind("keydown",
"space",function(){l.toolbar.find("#list-edit").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});h.droppable(l._DroppableConfigListItems(h));h.find(".assigned-tag-delete").bind("click",function(j){var g=$(j.target).parent(".assigned-tag");j=g.attr("data-id");var m=h.data("data");m.list.tag_id=j;m.list.tag_action="remove";List.Update({send:m,successCallback:function(n,q){g.hide("slow",function(){g.remove();l._ReplaceList(h,q,n);l._FilterByTags()})},lists:m.list.id})});
h.find(".assigned-tags").hide();return h},_triggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_AdjustHeight:function(){this.listlist.find(".row").each(function(){var d=$(this),b=d.find(".list-tag");d=d.find(".list-name");b.height(d.height()+10+"px")})},_AddListToDOM:function(d,b){this.listlist=$('<div id="list-list"></div>');this.wrapper.append(this.listlist);for(var l=0;l<d.length;l++)this.listlist.append(this._GetListElement(d[l],b));this._AdjustHeight();this._triggerResize()},
_SelectLastList:function(){this.selectedList?this.selectedList.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):this.listlist.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})},_RegisterGlobalKeyboardShortcuts:function(){var d=this;$(document).bind("keydown","ctrl+l",function(){d._SelectLastList()});$(document).bind("keydown","ctrl+f",function(){d.toolbar.find("#search-list").focus()});$(document).bind("keydown","shift+f",function(){d.toolbar.find("#search-list").focus();
return false})},_ShowListView:function(d,b){var l=this;l.listlist.show("slide",{direction:"left"},"slow",function(){if(d){var h=l._GetListElement(d,b);l._IsNewList(d)?l.listlist.prepend(h):l.selectedList.element.replaceWith(h);l._AdjustHeight();l.selectedList={data:d,element:h}}l.selectedList&&l.selectedList.element.focus()})},_HideForm:function(d,b){var l=this;l.listForm.hide("slide",{direction:"left"},"slow",function(){l._ShowListView(d,b);l.listForm.trigger("FormHidden");l.selectedList?l.selectedList.element.focus():
l.listlist.find(".row").first().focus();l.listForm.remove();l.listForm=null})},_FilterByTags:function(){var d=this;d.toolbar.find("#search-list").trigger("keyup");d.listlist.find(".row:visible").each(function(){var b=$(this),l=b.data("data"),h=0;if(d.selectedTags.length>0){for(var j=0;j<l.list.tags.length;j++)for(var g=0;g<d.selectedTags.length;g++)d.selectedTags[g]===l.list.tags[j].id&&h++;h===d.selectedTags.length?b.show():b.hide()}})},_create:function(){var d=this;d.selectedList=null;d.wrapper=
d.element.find("div#list-wrapper");d.toolbar=d._CreateToolbar();d.listForm=null;d.selectedTags=[];List.Index({successCallback:function(b,l){d.wrapper.find(".row").remove();d._AddListToDOM(l,b);d.listlist.find(".row").first().focus()}});d._RegisterGlobalKeyboardShortcuts()},options:{},SetupDroppable:function(d){var b=this;b.listlist.find(".row").each(function(){var l=$(this);l.droppable("destroy");switch(d){case "listitem":l.droppable(b._DroppableConfigListItems(l));break;case "tag":l.droppable(b._DroppableConfigTags())}})},
ReloadLists:function(){var d=this;List.Index({successCallback:function(b,l){d.wrapper.find(".row").remove();d._AddListToDOM(l,b);d.toolbar.find("#search-list").trigger("keyup");d._FilterByTags()}})},SelectList:function(){widget._SelectLastList()},FilterByTags:function(d){this.selectedTags=d;this._FilterByTags()},destroy:function(){this.toolbar.remove();this.listForm.remove();this.wrapper.find(".row").remove()}})})();
(function(d){d.fn.serializeForm=function(){var b=d(this).find('*[name*="]"]'),l={};d.each(b,function(h,j){var g=d(j),m=g.get(0).name.split("[")[0],n=g.get(0).name.split("[")[1];n=n.replace("]","");g=g.val();l[m]=l[m]||{};l[m][n]=g});return l}})(jQuery);
(function(){var d=function(){return{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b);this.notice.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}}}();$.widget("ui.StatusBar",d)})();if(!this.JSON)this.JSON={};
(function(){function d(p){return p<10?"0"+p:p}function b(p){j.lastIndex=0;return j.test(p)?'"'+p.replace(j,function(G){var A=n[G];return typeof A==="string"?A:"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+p+'"'}function l(p,G){var A,J,K,t,B=g,C,u=G[p];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(p);if(typeof q==="function")u=q.call(G,p,u);switch(typeof u){case "string":return b(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";g+=m;C=[];if(Object.prototype.toString.apply(u)==="[object Array]"){t=u.length;for(A=0;A<t;A+=1)C[A]=l(A,u)||"null";K=C.length===0?"[]":g?"[\n"+g+C.join(",\n"+g)+"\n"+B+"]":"["+C.join(",")+"]";g=B;return K}if(q&&typeof q==="object"){t=q.length;for(A=0;A<t;A+=1){J=q[A];if(typeof J==="string")if(K=l(J,u))C.push(b(J)+(g?": ":":")+K)}}else for(J in u)if(Object.hasOwnProperty.call(u,J))if(K=l(J,u))C.push(b(J)+(g?": ":":")+K);K=C.length===0?"{}":g?"{\n"+g+C.join(",\n"+g)+
"\n"+B+"}":"{"+C.join(",")+"}";g=B;return K}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
j=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,m,n={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;if(typeof JSON.stringify!=="function")JSON.stringify=function(p,G,A){var J;m=g="";if(typeof A==="number")for(J=0;J<A;J+=1)m+=" ";else if(typeof A==="string")m=A;if((q=G)&&typeof G!=="function"&&(typeof G!=="object"||typeof G.length!=="number"))throw Error("JSON.stringify");return l("",
{"":p})};if(typeof JSON.parse!=="function")JSON.parse=function(p,G){function A(K,t){var B,C,u=K[t];if(u&&typeof u==="object")for(B in u)if(Object.hasOwnProperty.call(u,B)){C=A(u,B);if(C!==undefined)u[B]=C;else delete u[B]}return G.call(K,t,u)}var J;p=String(p);h.lastIndex=0;if(h.test(p))p=p.replace(h,function(K){return"\\u"+("0000"+K.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(p.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){J=eval("("+p+")");return typeof G==="function"?A({"":J},""):J}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var d=function(){};d.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(b,l,h,j){if(!j){this.context=l;this.buffer=[]}if(!this.includes("",b))if(j)return b;else{this.send(b);return}b=this.render_pragmas(b);b=this.render_section(b,l,h);if(j)return this.render_tags(b,l,h,j);this.render_tags(b,l,h,j)},send:function(b){b!=""&&this.buffer.push(b)},render_pragmas:function(b){if(!this.includes("%",b))return b;
var l=this;return b.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(h,j,g){if(!l.pragmas_implemented[j])throw{message:"This implementation of mustache doesn't understand the '"+j+"' pragma"};l.pragmas[j]={};if(g){h=g.split("=");l.pragmas[j][h[0]]=h[1]}return""})},render_partial:function(b,l,h){b=this.trim(b);if(!h||h[b]===undefined)throw{message:"unknown_partial '"+b+"'"};if(typeof l[b]!="object")return this.render(h[b],l,h,true);return this.render(h[b],l[b],h,true)},render_section:function(b,
l,h){if(!this.includes("#",b)&&!this.includes("^",b))return b;var j=this;return b.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(g,m,n,q){g=j.find(n,l);if(m=="^")return!g||j.is_array(g)&&g.length===0?j.render(q,l,h,true):"";else if(m=="#")return j.is_array(g)?j.map(g,function(p){return j.render(q,j.create_context(p),h,true)}).join(""):j.is_object(g)?j.render(q,j.create_context(g),h,true):typeof g==="function"?
g.call(l,q,function(p){return j.render(p,l,h,true)}):g?j.render(q,l,h,true):""})},render_tags:function(b,l,h,j){var g=this,m=function(){return RegExp(g.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+g.ctag+"+","g")},n=m(),q=function(G,A,J){switch(A){case "!":return"";case "=":g.set_delimiters(J);n=m();return"";case ">":return g.render_partial(J,l,h);case "{":return g.find(J,l);default:return g.escape(g.find(J,l))}};b=b.split("\n");for(var p=0;p<b.length;p++){b[p]=b[p].replace(n,q,this);j||this.send(b[p])}if(j)return b.join("\n")},
set_delimiters:function(b){b=b.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(b){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return b.replace(arguments.callee.sRE,"\\$1")},find:function(b,l){b=this.trim(b);var h;if(l[b]===false||l[b]===0||l[b])h=l[b];else if(this.context[b]===false||this.context[b]===0||this.context[b])h=this.context[b];if(typeof h==="function")return h.apply(l);
if(h!==undefined)return h;return""},includes:function(b,l){return l.indexOf(this.otag+b)!=-1},escape:function(b){return String(b===null?"":b).replace(/&(?!\w+;)|["<>\\]/g,function(l){switch(l){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return l}})},create_context:function(b){if(this.is_object(b))return b;else{var l=".";if(this.pragmas["IMPLICIT-ITERATOR"])l=this.pragmas["IMPLICIT-ITERATOR"].iterator;var h={};h[l]=b;return h}},
is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(b,l){if(typeof b.map=="function")return b.map(l);else{for(var h=[],j=b.length,g=0;g<j;g++)h.push(l(b[g]));return h}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(b,l,h,j){var g=new d;if(j)g.send=j;g.render(b,l,h);if(!j)return g.buffer.join("\n")}}}();
(function(d){d.mustache=function(b,l,h){return Mustache.to_html(b,l,h)}})(jQuery);
(function(d){d.fn.layout=function(b){function l(c){if(!c)return true;var e=c.keyCode;if(e<33)return true;var f={38:"north",40:"south",37:"west",39:"east"},i=e>=37&&e<=40,k=c.shiftKey,r=c.ctrlKey,w=false,s,y,v;if(!r&&!k)return true;else if(i&&p[f[e]].enableCursorHotkey)w=f[e];else d.each(x.borderPanes.split(","),function(z,E){s=p[E];y=s.customHotkey;v=s.customHotkeyModifier;if(k&&v=="SHIFT"||r&&v=="CTRL"||r&&k)if(y&&e==(isNaN(y)||y<=9?y.toUpperCase().charCodeAt(0):y)){w=E;return false}});if(!w)return true;
s=p[w];f=A[w];if(!s.enableCursorHotkey||f.isHidden||!F[w])return true;if((f=c.target||c.srcElement)&&k&&i&&(f.tagName=="TEXTAREA"||f.tagName=="INPUT"&&(e==37||e==39)))return true;da(w);c.stopPropagation();return c.returnValue=false}function h(c){if(this&&this.tagName)c=this;c=typeof c=="string"?F[c]:d(c).attr("pane")?d(c):d(c).parents("div[pane]:first");if(c.length){var e=c.attr("pane"),f=A[e];f.cssSaved&&j(e);if(f.isSliding||f.isResizing||f.isClosed)f.cssSaved=false;else{var i={zIndex:x.zIndex.pane_normal+
1},k={},r=c.css("overflow"),w=c.css("overflowX"),s=c.css("overflowY");if(r!="visible"){k.overflow=r;i.overflow="visible"}if(w&&w!="visible"&&w!="auto"){k.overflowX=w;i.overflowX="visible"}if(s&&s!="visible"&&s!="auto"){k.overflowY=w;i.overflowY="visible"}f.cssSaved=k;c.css(i);d.each(x.allPanes.split(","),function(y,v){v!=e&&j(v)})}}}function j(c){if(this&&this.tagName)c=this;c=typeof c=="string"?F[c]:d(c).hasClass("ui-layout-pane")?d(c):d(c).parents("div[pane]:first");if(c.length){var e=c.attr("pane");
e=A[e];var f=e.cssSaved||{};!e.isSliding&&!e.isResizing&&c.css("zIndex",x.zIndex.pane_normal);c.css(f);e.cssSaved=false}}function g(c,e,f){var i=d(c);if(i.length)if(x.borderPanes.indexOf(e)==-1)alert("Error Adding Button \n\nInvalid pane: "+e);else{c=p[e].buttonClass+"-"+f;i.addClass(c+" "+c+"-"+e);return i}else alert("Error Adding Button \n\nInvalid selector: "+c);return false}function m(c,e){d.each(x[c].pins,function(f,i){n(d(i),c,e)})}function n(c,e,f){var i=c.attr("pin");if(!(i&&f==(i=="down"))){var k=
p[e].buttonClass+"-pin",r=k+"-"+e;e=k+"-up";i=r+"-up";k+="-down";r+="-down";c.attr("pin",f?"down":"up").attr("title",f?"Un-Pin":"Pin").removeClass(f?e:k).removeClass(f?i:r).addClass(f?k:e).addClass(f?r:i)}}var q={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},p={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:q.contentSelector,contentIgnoreSelector:q.contentIgnoreSelector,paneClass:q.paneClass,resizerClass:q.resizerClass,togglerClass:q.togglerClass,buttonClass:q.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},G={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},A={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},J={north:"south",south:"north",east:"west",west:"east"},K=function(c){if(typeof c=="string")return true;else if(typeof c=="object")try{return c.constructor.toString().match(/string/i)!==null}catch(e){}return false},t=function(c){return typeof c=="string"||K(c)?d.trim(c):c},B=function(c,e){return Math.max(c,e)},C=function(c){var e={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};c=c||{};if(c.effects||
c.defaults||c.north||c.south||c.west||c.east||c.center)e=d.extend(e,c);else d.each(c,function(f,i){a=f.split("__");e[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=i});return e},u=function(c,e,f){function i(w){r=x[w];if(r.doCallback){cpPane=r.callback.split(",")[1];cpPane!=w&&cpPane!=e&&i(cpPane,true)}else{r.doCallback=true;r.callback=k}}var k=c+","+e+","+(f?1:0),r;d.each(x.borderPanes.split(","),function(w,s){if(x[s].isMoving){i(s);return false}})},I=function(c){c=x[c];x.isLayoutBusy=false;delete c.isMoving;
if(c.doCallback&&c.callback){c.doCallback=false;var e=c.callback.split(","),f=e[2]>0?true:false;if(e[0]=="open")X(e[1],f);else e[0]=="close"&&V(e[1],f);if(!c.doCallback)c.callback=null}},H=function(c,e){if(e){var f;try{if(typeof e=="function")f=e;else if(typeof e!="string")return;else if(e.indexOf(",")>0){var i=e.split(",");f=eval(i[0]);if(typeof f=="function"&&i.length>1)return f(i[1])}else f=eval(e);if(typeof f=="function")return f(c,F[c],d.extend({},A[c]),d.extend({},p[c]),p.name)}catch(k){}}},
M=function(c,e){var f=0,i=false,k="";if(!d.browser.msie)if(d.curCSS(c[0],"display",true)=="none"){i=true;k=d.curCSS(c[0],"visibility",true);c.css({display:"block",visibility:"hidden"})}f=parseInt(d.curCSS(c[0],e,true),10)||0;if(i){c.css({display:"none"});k&&k!="hidden"&&c.css({visibility:k})}return f},O=function(c,e){var f;if(K(c)){c=t(c);f=F[c]}else f=d(c);if(e<=0)return 0;else e>0||(e=K(c)?T(c):f.outerWidth());return d.boxModel?e-M(f,"paddingLeft")-M(f,"paddingRight")-(d.curCSS(f[0],"borderLeftStyle",
true)=="none"?0:M(f,"borderLeftWidth"))-(d.curCSS(f[0],"borderRightStyle",true)=="none"?0:M(f,"borderRightWidth")):e},P=function(c,e){var f;if(K(c)){c=t(c);f=F[c]}else f=d(c);if(e<=0)return 0;else e>0||(e=K(c)?T(c):f.outerHeight());return d.boxModel?e-M(f,"paddingTop")-M(f,"paddingBottom")-(d.curCSS(f[0],"borderTopStyle",true)=="none"?0:M(f,"borderTopWidth"))-(d.curCSS(f[0],"borderBottomStyle",true)=="none"?0:M(f,"borderBottomWidth")):e},T=function(c,e){var f=F[c],i=p[c],k=A[c],r=e?i.spacing_open:
0;i=e?i.spacing_closed:0;return!f||k.isHidden?0:k.isClosed||k.isSliding&&e?i:x[c].dir=="horz"?f.outerHeight()+r:f.outerWidth()+r},U=function(c){var e=D,f=x[c].dir,i=A[c],k=F[J[c]],r=p[c].spacing_open,w=p[J[c]].spacing_open,s=!k?0:f=="horz"?k.outerHeight():k.outerWidth();k=i.minSize||0;f=Math.min(i.maxSize||9999,(f=="horz"?e.innerHeight:e.innerWidth)-r-s-w);var y,v;switch(c){case "north":y=e.offsetTop+k;v=e.offsetTop+f;break;case "west":y=e.offsetLeft+k;v=e.offsetLeft+f;break;case "south":y=e.offsetTop+
e.innerHeight-f;v=e.offsetTop+e.innerHeight-k;break;case "east":y=e.offsetLeft+e.innerWidth-f;v=e.offsetLeft+e.innerWidth-k}d.extend(i,{minSize:k,maxSize:f,minPosition:y,maxPosition:v})},ma=function(){var c={top:T("north",true),bottom:T("south",true),left:T("west",true),right:T("east",true),width:0,height:0};with(c){width=D.innerWidth-left-right;height=D.innerHeight-bottom-top;top+=D.top;bottom+=D.bottom;left+=D.left;right+=D.right}return c},na=function(c){var e={},f,i,k;d.each("Left,Right,Top,Bottom".split(","),
function(){f=t(this);i=e["border"+f]=M(c,"border"+f+"Width");k=e["padding"+f]=M(c,"padding"+f);e["offset"+f]=i+k;if(c==Q)e[f.toLowerCase()]=d.boxModel?k:0});e.innerWidth=e.outerWidth=c.outerWidth();e.innerHeight=e.outerHeight=c.outerHeight();if(d.boxModel){e.innerWidth-=e.offsetLeft+e.offsetRight;e.innerHeight-=e.offsetTop+e.offsetBottom}return e},ra=function(c,e,f,i){var k=window.layout=window.layout||{};k=k.timers=k.timers||{};c="layout_"+A.id+"_"+c+"_"+e;k[c]||(k[c]=setTimeout(f,i))},ea=function(c,
e){var f=window.layout=window.layout||{};f=f.timers=f.timers||{};var i="layout_"+A.id+"_"+c+"_"+e;if(f[i]){clearTimeout(f[i]);delete f[i];return true}else return false},sa=function(){try{if(Q[0].tagName=="BODY"){d("html").css({height:"100%",overflow:"hidden"});d("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var c={overflow:"hidden"},e=Q.css("position"),f=Q.css("height");if(!Q.hasClass("ui-layout-pane")){if(!e||"fixed,absolute,relative".indexOf(e)<
0)c.position="relative";if(!f||f=="auto")c.height="100%"}Q.css(c)}}catch(i){}D=A.container=na(Q)},ta=function(){d.each(x.borderPanes.split(","),function(c,e){var f=p[e];if(f.enableCursorHotkey||f.customHotkey){d(document).keydown(l);return false}})},ua=function(){b=C(b);if(b.effects){d.extend(G,b.effects);delete b.effects}d.each("name,scrollToBookmarkOnLoad".split(","),function(f,i){if(b[i]!==undefined)p[i]=b[i];else if(b.defaults[i]!==undefined){p[i]=b.defaults[i];delete b.defaults[i]}});d.each("paneSelector,resizerCursor,customHotkey".split(","),
function(f,i){delete b.defaults[i]});d.extend(p.defaults,b.defaults);x.center=d.extend(true,{},x.defaults,x.center);d.extend(p.center,b.center);var c=d.extend(true,{},p.defaults,b.defaults,p.center);d.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(f,i){p.center[i]=c[i]});var e=p.defaults;d.each(x.borderPanes.split(","),function(f,i){x[i]=d.extend(true,{},x.defaults,x[i]);o=p[i]=d.extend(true,{},p.defaults,p[i],b.defaults,b[i]);if(!o.paneClass)o.paneClass=
q.paneClass;if(!o.resizerClass)o.resizerClass=q.resizerClass;if(!o.togglerClass)o.togglerClass=q.togglerClass;d.each(["_open","_close",""],function(k,r){var w="fxName"+r,s="fxSpeed"+r,y="fxSettings"+r;o[w]=b[i][w]||b[i].fxName||b.defaults[w]||b.defaults.fxName||o[w]||o.fxName||e[w]||e.fxName||"none";var v=o[w];if(v=="none"||!d.effects||!d.effects[v]||!G[v]&&!o[y]&&!o.fxSettings)v=o[w]="none";v=G[v]||{};w=v.all||{};v=v[i]||{};o[y]=d.extend({},w,v,e.fxSettings||{},e[y]||{},o.fxSettings,o[y],b.defaults.fxSettings,
b.defaults[y]||{},b[i].fxSettings,b[i][y]||{});o[s]=b[i][s]||b[i].fxSpeed||b.defaults[s]||b.defaults.fxSpeed||o[s]||o[y].duration||o.fxSpeed||o.fxSettings.duration||e.fxSpeed||e.fxSettings.duration||v.duration||w.duration||"normal"})})},oa=function(){d.each(x.allPanes.split(","),function(){var c=t(this),e=p[c],f=A[c],i=x[c].dir,k=e.size=="auto"||isNaN(e.size)?0:e.size,r=e.minSize||1,w=e.maxSize||9999,s=e.spacing_open||0,y=e.paneSelector,v={},z;Z[c]=false;if(y.substr(0,1)==="#")z=F[c]=Q.find(y+":first");
else{z=F[c]=Q.children(y+":first");z.length||(z=F[c]=Q.children("form:first").children(y+":first"))}if(!z.length){F[c]=false;return true}z.attr("pane",c).addClass(e.paneClass+" "+e.paneClass+"-"+c);if(c!="center"){f.isClosed=false;f.isSliding=false;f.isResizing=false;f.isHidden=false;f.noRoom=false;x[c].pins=[]}v=d.extend({visibility:"visible",display:"block"},x.defaults.cssReq,x[c].cssReq);e.applyDefaultStyles&&d.extend(v,x.defaults.cssDef,x[c].cssDef);z.css(v);v={};switch(c){case "north":v.top=
D.top;v.left=D.left;v.right=D.right;break;case "south":v.bottom=D.bottom;v.left=D.left;v.right=D.right;break;case "west":v.left=D.left;break;case "east":v.right=D.right}if(i=="horz"){if(k===0||k=="auto"){z.css({height:"auto"});k=z.outerHeight()}k=B(k,r);k=Math.min(k,w);k=Math.min(k,D.innerHeight-s);v.height=B(1,P(c,k));f.size=k;f.maxSize=w;f.minSize=B(r,k-v.height+1);z.css(v)}else if(i=="vert"){if(k===0||k=="auto"){z.css({width:"auto","float":"left"});k=z.outerWidth();z.css({"float":"none"})}k=B(k,
r);k=Math.min(k,w);k=Math.min(k,D.innerWidth-s);v.width=B(1,O(c,k));f.size=k;f.maxSize=w;f.minSize=B(r,k-v.width+1);z.css(v);Y(c,null,true)}else if(c=="center"){z.css(v);Y("center",null,true)}if(e.initClosed&&e.closable){z.hide().addClass("closed");f.isClosed=true}else if(e.initHidden||e.initClosed){ha(c,true);f.isHidden=true}else z.addClass("open");e.showOverflowOnHover&&z.hover(h,j);if(e.contentSelector){f=Z[c]=z.children(e.contentSelector+":first");if(!f.length){Z[c]=false;return true}f.css(x.content.cssReq);
e.applyDefaultStyles&&f.css(x.content.cssDef);z.css({overflow:"hidden"})}})},va=function(){d.each(x.borderPanes.split(","),function(){var c=t(this),e=p[c],f=A[c],i=e.resizerClass,k=e.togglerClass,r=F[c];R[c]=false;aa[c]=false;if(!(!r||!e.closable&&!e.resizable)){var w=x[c].edge;r=r.is(":visible");var s="-"+c,y=r?"-open":"-closed",v;v=R[c]=d("<span></span>");r&&e.resizable||!r&&e.slidable&&v.attr("title",e.sliderTip).css("cursor",e.sliderCursor);v.attr("id",e.paneSelector.substr(0,1)=="#"?e.paneSelector.substr(1)+
"-resizer":"").attr("resizer",c).css(x.resizers.cssReq).css(w,D[w]+T(c)).addClass(i+" "+i+s+" "+i+y+" "+i+s+y).appendTo(Q);e.applyDefaultStyles&&v.css(x.resizers.cssDef);if(e.closable){i=aa[c]=d("<div></div>");i.attr("id",e.paneSelector.substr(0,1)=="#"?e.paneSelector.substr(1)+"-toggler":"").css(x.togglers.cssReq).attr("title",r?e.togglerTip_open:e.togglerTip_closed).click(function(z){da(c);z.stopPropagation()}).mouseover(function(z){z.stopPropagation()}).addClass(k+" "+k+s+" "+k+y+" "+k+s+y).appendTo(v);
if(e.togglerContent_open)d("<span>"+e.togglerContent_open+"</span>").addClass("content content-open").css("display",f.isClosed?"none":"block").appendTo(i);if(e.togglerContent_closed)d("<span>"+e.togglerContent_closed+"</span>").addClass("content content-closed").css("display",f.isClosed?"block":"none").appendTo(i);e.applyDefaultStyles&&i.css(x.togglers.cssDef);r||ia(c,true)}}});ba("all",true)},wa=function(){var c=typeof d.fn.draggable=="function",e;d.each(x.borderPanes.split(","),function(){var f=
t(this),i=p[f],k=A[f];if(!c||!F[f]||!i.resizable){i.resizable=false;return true}var r=i.resizerClass,w=r+"-drag",s=r+"-"+f+"-drag",y=r+"-dragging",v=r+"-"+f+"-dragging",z=false,E=R[f];k.isClosed||E.attr("title",i.resizerTip).css("cursor",i.resizerCursor);E.draggable({containment:Q[0],axis:x[f].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:i.resizerDragOpacity,zIndex:x.zIndex.resizing,start:function(){if(false===H(f,i.onresize_start))return false;k.isResizing=true;ea(f,"closeSlider");
E.addClass(w+" "+s);z=false;var L=f=="east"||f=="south"?i.spacing_open:0;U(f);k.minPosition-=L;k.maxPosition-=L;e=x[f].dir=="horz"?"top":"left";d(i.maskIframesOnResize===true?"iframe":i.maskIframesOnResize).each(function(){d('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(d(this).offset()).appendTo(this.parentNode)})},drag:function(L,N){if(!z){d(".ui-draggable-dragging").addClass(y+
" "+v).children().css("visibility","hidden");z=true;k.isSliding&&F[f].css("zIndex",x.zIndex.sliding)}if(N.position[e]<k.minPosition)N.position[e]=k.minPosition;else if(N.position[e]>k.maxPosition)N.position[e]=k.maxPosition},stop:function(L,N){var S=N.position,W;E.removeClass(w+" "+s);switch(f){case "north":W=S.top;break;case "west":W=S.left;break;case "south":W=D.outerHeight-S.top-E.outerHeight();break;case "east":W=D.outerWidth-S.left-E.outerWidth()}ja(f,W-D[x[f].edge]);d("div.ui-layout-mask").remove();
k.isResizing=false}})})},ha=function(c,e){var f=p[c],i=A[c],k=F[c],r=R[c];if(!(!k||i.isHidden))if(false!==H(c,f.onhide_start)){i.isSliding=false;r&&r.hide();if(e||i.isClosed){i.isClosed=true;i.isHidden=true;k.hide();Y(x[c].dir=="horz"?"all":"center");H(c,f.onhide_end||f.onhide)}else{i.isHiding=true;V(c,false)}}},fa=function(c,e){var f=p[c],i=A[c],k=R[c];if(F[c]&&i.isHidden)if(false!==H(c,f.onshow_start)){i.isSliding=false;i.isShowing=true;k&&f.spacing_open>0&&k.show();e===false?V(c,true):X(c)}},da=
function(c){var e=A[c];if(e.isHidden)fa(c);else e.isClosed?X(c):V(c)},V=function(c,e,f){function i(){ia(c,true);N||H(c,s.onclose_end||s.onclose);if(N)H(c,s.onshow_end||s.onshow);if(S)H(c,s.onhide_end||s.onhide);I(c)}var k=F[c],r=R[c],w=aa[c],s=p[c],y=A[c];f=!f&&!y.isClosed&&s.fxName_close!="none";var v=x[c].edge,z=s.resizerClass,E=s.togglerClass,L="-"+c,N=y.isShowing,S=y.isHiding;delete y.isShowing;delete y.isHiding;if(!(!k||!s.resizable&&!s.closable))if(!(!e&&y.isClosed&&!N))if(x.isLayoutBusy)u("close",
c,e);else if(!(!N&&false===H(c,s.onclose_start))){x[c].isMoving=true;x.isLayoutBusy=true;y.isClosed=true;if(S)y.isHidden=true;else if(N)y.isHidden=false;m(c,false);y.isSliding||Y(x[c].dir=="horz"?"all":"center");if(r){r.css(v,D[v]).removeClass(z+"-open "+z+L+"-open").removeClass(z+"-sliding "+z+L+"-sliding").addClass(z+"-closed "+z+L+"-closed");s.resizable&&r.draggable("disable").css("cursor","default").attr("title","");w&&w.removeClass(E+"-open "+E+L+"-open").addClass(E+"-closed "+E+L+"-closed").attr("title",
s.togglerTip_closed);ba()}if(f){ga(c,true);k.hide(s.fxName_close,s.fxSettings_close,s.fxSpeed_close,function(){ga(c,false);y.isClosed&&i()})}else{k.hide();i()}}},X=function(c,e,f){function i(){y.isSliding||Y(x[c].dir=="vert"?"center":"all");if(r){r.css(v,D[v]+T(c)).removeClass(z+S+" "+z+L+S).addClass(z+N+" "+z+L+N).addClass(!y.isSliding?"":z+W+" "+z+L+W);s.resizable?r.draggable("enable").css("cursor",s.resizerCursor).attr("title",s.resizerTip):r.css("cursor","default");w&&w.removeClass(E+S+" "+E+
L+S).addClass(E+N+" "+E+L+N).attr("title",s.togglerTip_open);ba("all")}ca(c);m(c,!y.isSliding);H(c,s.onopen_end||s.onopen);if(ka)H(c,s.onshow_end||s.onshow);I(c)}var k=F[c],r=R[c],w=aa[c],s=p[c],y=A[c];f=!f&&y.isClosed&&s.fxName_open!="none";var v=x[c].edge,z=s.resizerClass,E=s.togglerClass,L="-"+c,N="-open",S="-closed",W="-sliding",ka=y.isShowing;delete y.isShowing;if(!(!k||!s.resizable&&!s.closable))if(y.isClosed||y.isSliding)if(y.isHidden&&!ka)fa(c,true);else if(x.isLayoutBusy)u("open",c,e);else if(false!==
H(c,s.onopen_start)){x[c].isMoving=true;x.isLayoutBusy=true;y.isSliding&&!e&&la(c,false);y.isClosed=false;if(ka)y.isHidden=false;U(c);y.size>y.maxSize&&k.css(x[c].sizeType,B(1,x[c].dir=="horz"?P(c,y.maxSize):O(c,y.maxSize)));ia(c,false);if(f){ga(c,true);k.show(s.fxName_open,s.fxSettings_open,s.fxSpeed_open,function(){ga(c,false);y.isClosed||i()})}else{k.show();i()}}},ga=function(c,e){var f=F[c];if(e){f.css({zIndex:x.zIndex.animation});if(c=="south")f.css({top:D.top+D.innerHeight-f.outerHeight()});
else c=="east"&&f.css({left:D.left+D.innerWidth-f.outerWidth()})}else{A[c].isSliding||f.css({zIndex:x.zIndex.pane_normal});if(c=="south")f.css({top:"auto"});else c=="east"&&f.css({left:"auto"})}},ia=function(c,e){var f=p[c],i=R[c],k=f.slideTrigger_open;if(i&&f.slidable){if(k!="click"&&k!="dblclick"&&k!="mouseover")k="click";i[e?"bind":"unbind"](k,xa).css("cursor",e?f.sliderCursor:"default").attr("title",e?f.sliderTip:"")}},la=function(c,e){function f(w){ea(c,"closeSlider");w.stopPropagation()}var i=
p[c].slideTrigger_close,k=F[c],r=R[c];A[c].isSliding=e;ea(c,"closeSlider");k.css({zIndex:e?x.zIndex.sliding:x.zIndex.pane_normal});r.css({zIndex:e?x.zIndex.sliding:x.zIndex.resizer_normal});if(i!="click"&&i!="mouseout")i="mouseout";if(e){k.bind(i,pa);r.bind(i,pa);i="mouseout";k.bind("mouseover",f);r.bind("mouseover",f)}else{k.unbind(i);r.unbind(i);i="mouseout";k.unbind("mouseover");r.unbind("mouseover");ea(c,"closeSlider")}},xa=function(){var c=d(this).attr("resizer");if(A[c].isClosed){la(c,true);
X(c,true)}},pa=function(){function c(){la(f,false);i.isClosed||V(f)}var e=d(this),f=e.attr("pane")||e.attr("resizer");e=p[f];var i=A[f];i.isClosed||i.isResizing||(e.slideTrigger_close=="click"?c():ra(f,"closeSlider",c,300))},ja=function(c,e){var f=x[c].edge,i=x[c].dir,k=p[c],r=A[c],w=F[c],s=R[c];U(c);r.minSize=B(r.minSize,k.minSize);if(k.maxSize>0)r.maxSize=Math.min(r.maxSize,k.maxSize);e=B(e,r.minSize);e=Math.min(e,r.maxSize);r.size=e;s.css(f,e+D[f]);w.css(x[c].sizeType,B(1,x[c].dir=="horz"?P(c,
e):O(c,e)));r.isSliding||Y(i=="horz"?"all":"center");ba();ca(c);H(c,k.onresize_end||k.onresize)},Y=function(c,e,f){if(!c||c=="all")c="east,west,center";var i=ma();e&&d.extend(i,e);d.each(c.split(","),function(){if(F[this]){var k=t(this),r=p[k],w=A[k],s=F[k],y=R[k],v=true,z={};if(k=="center"){i=ma();z=d.extend({},i);z.width=B(1,O(k,z.width));z.height=B(1,P(k,z.height));v=z.width>1&&z.height>1;if(d.browser.msie&&(!d.boxModel||d.browser.version<7)){F.north&&F.north.css({width:O(F.north,D.innerWidth)});
F.south&&F.south.css({width:O(F.south,D.innerWidth)})}}else{z.top=i.top;z.bottom=i.bottom;z.height=B(1,P(k,i.height));v=z.height>1}if(v){s.css(z);if(w.noRoom){w.noRoom=false;if(w.isHidden)return;else fa(k,!w.isClosed)}if(!f){ca(k);H(k,r.onresize_end||r.onresize)}}else if(!w.noRoom){w.noRoom=true;if(!w.isHidden)if(f){s.hide();y&&y.hide()}else ha(k)}}})},ca=function(c){if(!c||c=="all")c=x.allPanes;d.each(c.split(","),function(){if(Z[this]){var e=t(this),f=p[e].contentIgnoreSelector,i=F[e];e=Z[e];var k=
e[0],r=P(i);i.children().each(function(){if(this!=k){var w=d(this);if(!f||!w.is(f))r-=w.outerHeight()}});if(r>0)r=P(e,r);r<1?e.hide():e.css({height:r}).show()}})},ba=function(c,e){if(!c||c=="all")c=x.borderPanes;d.each(c.split(","),function(){var f=t(this),i=p[f],k=A[f],r=F[f],w=R[f],s=aa[f];if(!(!r||!w||!i.resizable&&!i.closable)){var y=x[f].dir,v=k.isClosed?"_closed":"_open";f=i["spacing"+v];var z=i["togglerAlign"+v];v=i["togglerLength"+v];var E;if(f==0)w.hide();else{!k.noRoom&&!k.isHidden&&w.show();
if(y=="horz"){E=r.outerWidth();w.css({width:B(1,O(w,E)),height:B(1,P(w,f)),left:M(r,"left")})}else{E=r.outerHeight();w.css({height:B(1,P(w,E)),width:B(1,O(w,f)),top:D.top+T("north",true)})}if(s){if(v==0||k.isSliding&&i.hideTogglerOnSlide){s.hide();return}else s.show();if(!(v>0)||v=="100%"||v>E){v=E;r=0}else if(typeof z=="string")switch(z){case "top":case "left":r=0;break;case "bottom":case "right":r=E-v;break;default:r=Math.floor((E-v)/2)}else{r=parseInt(z);r=z>=0?r:E-v+r}E=i.togglerContent_open?
s.children(".content-open"):false;var L=i.togglerContent_closed?s.children(".content-closed"):false;z=k.isClosed?L:E;if(E)E.css("display",k.isClosed?"none":"block");if(L)L.css("display",k.isClosed?"block":"none");if(y=="horz"){k=O(s,v);s.css({width:B(0,k),height:B(1,P(s,f)),left:r});z&&z.css("marginLeft",Math.floor((k-z.outerWidth())/2))}else{k=P(s,v);s.css({height:B(0,k),width:B(1,O(s,f)),top:r});z&&z.css("marginTop",Math.floor((k-z.outerHeight())/2))}}if(e&&i.initHidden){w.hide();s&&s.hide()}}}})},
qa=function(){var c=D.innerWidth,e=D.innerHeight;D=A.container=na(Q);var f=D.innerHeight<e,i=D.innerWidth<c,k,r;if(f||i)d.each(["south","north","east","west"],function(w,s){k=A[s];r=x[s].dir;if(!k.isClosed&&(f&&r=="horz"||i&&r=="vert")){U(s);k.size>k.maxSize&&ja(s,k.maxSize)}});Y("all");ba("all")},Q=d(this).css({overflow:"hidden"}),F={},Z={},R={},aa={},x={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},D=A.container;(function(){ua();sa();oa();va();wa();ca("all");if(p.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();d(window).resize(function(){var c="timerLayout_"+A.id;window[c]&&clearTimeout(window[c]);window[c]=null;window[c]=setTimeout(qa,100)})})();return{options:p,state:A,panes:F,toggle:da,open:X,close:V,hide:ha,show:fa,resizeContent:ca,sizePane:ja,reinitPane:oa,resizeAll:qa,addToggleBtn:function(c,e){var f=
g(c,e,"toggle");if(f)f.attr("title",A[e].isClosed?"Open":"Close").click(function(i){da(e);i.stopPropagation()})},addOpenBtn:function(c,e){var f=g(c,e,"open");f&&f.attr("title","Open").click(function(i){X(e);i.stopPropagation()})},addCloseBtn:function(c,e){var f=g(c,e,"close");f&&f.attr("title","Close").click(function(i){V(e);i.stopPropagation()})},addPinBtn:function(c,e){var f=g(c,e,"pin");if(f){var i=A[e];f.click(function(k){n(d(this),e,i.isSliding||i.isClosed);i.isSliding||i.isClosed?X(e):V(e);
k.stopPropagation()});n(f,e,!i.isClosed&&!i.isSliding);x[e].pins.push(c)}},allowOverflow:h,resetOverflow:j,cssWidth:O,cssHeight:P}}})(jQuery);
(function(){var d=function(){var b=null,l=function(h,j){var g=$($.mustache(j,h.tag));g.data("data",h);if(!b.tagMenu){b.tagMenu=g.find(".tag-menu");b.tagMenu.hide()}g.find(".tag-menu").remove();g.find(".color-selector").bind("click",function(m){var n=b.tagMenu;m=$(m.target);if(n.data("visible")===true&&n.data("tagId")===h.tag.id){n.hide("fast");n.data("visible",false);n.data("tagId",null);n.data("tag",null);n.data("target",null)}else{n.show("fast");n.css({left:g.position().left,top:g.position().top-
100});n.data("visible",true);n.data("tagId",h.tag.id);n.data("tag",h);n.data("target",m)}return false});ListKungFu&&ListKungFu.LayoutWest&&g.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});g.bind("click",function(){var m=g.data("data");if(g.data("selected")){m=m.tag.id;for(var n=
[],q=0;q<b.selectedTags.length;q++)b.selectedTags[q]!==m&&n.push(b.selectedTags[q]);b.selectedTags=n;g.removeClass("tag-selected");g.data("selected",false)}else{b.selectedTags.push(m.tag.id);b.selectedTags=jQuery.unique(b.selectedTags);g.addClass("tag-selected");g.data("selected",true)}b._trigger("TagSelected",0,b.selectedTags);return false});return g};return{options:{},_create:function(){b=this;b.toolbar=$('<div id="tag-toolbar"></div>');b.addTagInput=$('<input type="text" value="" id="add-tag"/>');
b.addTagButton=$('<button id="tag-new">Create Tag</button>');b.tagList=$('<div class="tags"></div>');b.element.append(b.toolbar);b.toolbar.append(b.addTagInput);b.toolbar.append(b.addTagButton);b.element.append(b.tagList);b.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});b.selectedTags=[];Tag.Index({successCallback:function(h,j){for(var g=0;g<j.length;g++)b.tagList.append(l(j[g],h));b.tagList.append(b.tagMenu);b.tagMenu.find(".color").bind("click",function(m){var n=$(m.target).attr("data-colorclass");
m=b.tagMenu.data("tag");var q=m.tag.color_class,p=b.tagMenu.data("target");m.tag.color_class=n;Tag.Update({send:m,successCallback:function(G,A){b._trigger("AfterColorChanged",0,{});p.parent(".tag").removeClass(q);p.parent(".tag").addClass(n);p.removeClass(q);p.addClass(n);b.tagMenu.hide("fast");b.tagMenu.data("visible",false);b.tagMenu.data("tagId",null);b.tagMenu.data("tag",null);b.tagMenu.data("target",null);p.data("data",A)},tags:m.tag.id})});b.tagMenu.find(".delete-label").bind("click",function(){var m=
b.tagMenu.data("tag"),n=b.tagMenu.data("target");b.tagMenu.hide();var q=function(){Tag.Destroy({successCallback:function(){n.hide("fast",function(){n.parent(".tag").remove()})},tags:m.tag.id})};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete Tag",q,"Cancel","Delete Tag and remove it from all lists?");b.deleteDialog.dialog("open");return false})}});b.addTagButton.bind("click",function(){if($.trim(b.addTagInput.val())!==""&&b.tagList.find(".tag-name:HasExactValue('"+
$.trim(b.addTagInput.val())+"')").length===0){var h={};h.tag={name:b.addTagInput.val(),color_class:"c1"};Tag.Create({send:h,successCallback:function(j,g){var m=l(g,j);b.tagList.prepend(m);b.addTagInput.val("");b.addTagInput.trigger("keyup")}});return false}});b.addTagInput.bind("keyup","return",function(){b.addTagButton.trigger("click")});b.addTagInput.bind("keyup",function(){var h=$(this).val();if(h==="")b.tagList.find(".tag").show();else{b.tagList.find(".tag:not(:Contains('"+h+"'))").hide();b.tagList.find(".tag:Contains('"+
h+"')").show()}b.tagList.find(".tag-name:HasExactValue('"+$.trim(h)+"')").length>0?b.addTagButton.button("option","disabled",true):b.addTagButton.button("option","disabled",false)})},destroy:function(){b.element.children().remove()}}}();$.widget("ui.TagView",d)})();
