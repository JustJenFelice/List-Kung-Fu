var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};jQuery.expr[":"].Contains=function(b,c,i){return jQuery(b).text().toLowerCase().indexOf(i[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(b,c,i){return jQuery.trim(jQuery(b).text().toLowerCase())===i[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:92,minSize:92},south:{minSize:40},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(b,c){ListKungFu.LayoutWest.ListView("SetupDroppable",c.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(b,c){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",c.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(b,c){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",c.selectedList)}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(b,c){ListKungFu.LayoutWest.ListView("SetupDroppable",c.dragType)},AfterColorChanged:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},
AfterTagDeleted:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},TagSelected:function(b,c){ListKungFu.LayoutWest.ListView("Filter",c,null)}});ListKungFu.LayoutNorth.find("#ultimate-search-widget").UltimateSearch({OnFilterChanged:function(b,c){var i=c.searchOptions.searchLists,e=c.searchOptions.searchListItems;c.searchOptions.searchDashboard&&ListKungFu.LayoutCenter.Dashboard("Filter",c.searchText);i&&ListKungFu.LayoutWest.ListView("Filter",null,c.searchText);e&&ListKungFu.LayoutCenter.ListItemView("Filter",
c.searchText)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(b){var c={},i=function(e){var f=$(e).length>0?{}:false;$(e).each(function(j,m){var s=$(m).attr("model"),u=$(m).attr("field"),p=$(m).text();f[s]=f[s]||{};f[s][u]=f[s][u]||[];f[s][u].push(p)});return f};c.ClearFlash=function(){c.flash={notice:"",error:"",warning:"",message:""}};c.ClearFlash();c.SetFlash=function(e){c.flash.notice=e.getResponseHeader("X-Flash-Notice")||"";c.flash.error=e.getResponseHeader("X-Flash-Error")||"";c.flash.warning=e.getResponseHeader("X-Flash-Warning")||
"";c.flash.message=e.getResponseHeader("X-Flash-Message")||"";if(typeof b.onFlashUpdate==="function")if(c.flash.notice!==""||c.flash.error!==""||c.flash.warning!==""||c.flash.message!=="")b.onFlashUpdate(c.flash.notice,c.flash.error,c.flash.warning,c.flash.message)};c.baseURL=b.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";c.route=b.route;c.DefaultCallback=function(e,f,j,m){c.SetFlash(m);var s=$.parseJSON($(f).find("JSON").text()),
u=$(f).find("Template").text();f=i($(f).find("Error"));typeof e==="function"&&e(u,s,j,m,f);c.ClearFlash()};c.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};c.ConstructRoute=function(e){for(var f=
"",j="",m=0;m<c.route.length;m++){f+=c.route[m];j=e[c.route[m]]||"";if(j!=="")f+="/"+j;if(m!==c.route.length-1)f+="/"}return f};c.Index=function(e){var f=e.successCallback||null,j=c.ConstructRoute(e);$.ajax({url:c.baseURL+j,dataType:"xml",type:"GET",processData:true,contentType:"application/json",data:e.send,success:function(m,s,u){c.DefaultCallback(f,m,s,u)},error:function(m,s,u){c.DefaultErrorCallback(m,s,u)}})};c.Show=function(e){var f=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+
e,dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(j,m,s){c.DefaultCallback(f,j,m,s)},error:function(j,m,s){c.DefaultErrorCallback(j,m,s)}})};c.New=function(e){var f=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e+"/new",dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(j,m,s){c.DefaultCallback(f,j,m,s)},error:function(j,m,s){c.DefaultErrorCallback(j,m,s)}})};c.Create=function(e){var f=e.successCallback||
null,j=c.ConstructRoute(e);e=JSON.stringify(e.send);$.ajax({url:c.baseURL+j,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:e,success:function(m,s,u){c.DefaultCallback(f,m,s,u)},error:function(m,s,u){c.DefaultErrorCallback(m,s,u)}})};c.Edit=function(e){var f=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e+"/edit",dataType:"xml",type:"GET",parseData:false,contentType:"application/json",success:function(j,m,s){c.DefaultCallback(f,j,m,s)},error:function(j,
m,s){c.DefaultErrorCallback(j,m,s)}})};c.Update=function(e){var f=e.successCallback||null,j=c.ConstructRoute(e);e=JSON.stringify(e.send);e=e.replace(/\\u000a/g,"\\n");$.ajax({url:c.baseURL+j,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:e,beforeSend:function(m){m.setRequestHeader("X-Http-Method-Override","PUT")},success:function(m,s,u){c.DefaultCallback(f,m,s,u)},error:function(m,s,u){c.DefaultErrorCallback(m,s,u)}})};c.Destroy=function(e){var f=e.successCallback||
null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e,dataType:"xml",type:"POST",processData:false,contentType:"application/json",beforeSend:function(j){j.setRequestHeader("X-Http-Method-Override","DELETE")},success:function(j,m,s){c.DefaultCallback(f,j,m,s)},error:function(j,m,s){c.DefaultErrorCallback(j,m,s)}})};return c},List=Controller({route:["lists"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),ListListItem=Controller({route:["lists",
"list_items"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}});
jQuery(function(b){var c=b("meta[name=csrf-token]").attr("content"),i=b("meta[name=csrf-param]").attr("content");b.fn.extend({triggerAndReturn:function(f,j){var m=new b.Event(f);this.trigger(m,j);return m.result!==false},callRemote:function(){var f=this,j=f.attr("method")||f.attr("data-method")||"GET",m=f.attr("action")||f.attr("href"),s=f.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(f.triggerAndReturn("ajax:before")){var u=
f.is("form")?f.serializeArray():[];b.ajax({url:m,data:u,dataType:s,type:j.toUpperCase(),beforeSend:function(p){f.trigger("ajax:loading",p)},success:function(p,E,y){f.trigger("ajax:success",[p,E,y])},complete:function(p){f.trigger("ajax:complete",p)},error:function(p,E,y){f.trigger("ajax:failure",[p,E,y])}})}f.trigger("ajax:after")}}});b("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var f=b(this);if(f.triggerAndReturn("confirm"))if(!confirm(f.attr("data-confirm")))return false});
b("form[data-remote]").live("submit.rails",function(f){b(this).callRemote();f.preventDefault()});b("a[data-remote],input[data-remote]").live("click.rails",function(f){b(this).callRemote();f.preventDefault()});b("a[data-method]:not([data-remote])").live("click.rails",function(f){var j=b(this),m=j.attr("href");j=j.attr("data-method");m=b('<form method="post" action="'+m+'"></form>');j='<input name="_method" value="'+j+'" type="hidden" />';if(i!==undefined&&c!==undefined)j+='<input name="'+i+'" value="'+
c+'" type="hidden" />';m.hide().append(j).appendTo("body");f.preventDefault();m.submit()});var e=function(){b(this).find("input[data-disable-with]").each(function(){var f=b(this);f.data("enable-with",f.val()).attr("value",f.attr("data-disable-with")).attr("disabled","disabled")})};b("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",e);b("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",e);b("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){b(this).find("input[data-disable-with]").each(function(){var f=b(this);f.removeAttr("disabled").val(f.data("enable-with"))})});e=b().jquery;if(e==="1.4"||e==="1.4.1"||e==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(b){b.confirmationDialog=function(c,i,e,f,j){dialog=b('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+f+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});f={};f[c]=function(){b(dialog).dialog("close");i()};f[e]=function(){b(dialog).dialog("close");typeof j==="function"&&j()};dialog.dialog("option","buttons",
f);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","right",function(m){m=b(m.target);if(m.next("button").length>0){m.blur();m.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(m){m=b(m.target);if(m.prev("button").length>0){m.blur();m.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){$.widget("ui.Dashboard",{_TriggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_NothingToDoText:function(){return'<p class="nothing-todo">no items scheduled</p>'},_TriggerReinitOfPanes:function(){this._trigger("ReinitPanes",0,{})},_SetupCustomDeadlinePicker:function(b){var c=this,i=$(this),e=b.find(".dashboard-list-item-deadline-hidden"),f=b.data("data"),j=f.list_item.deadline_date.split("-"),m=j[0],s=j[1],u=j[2];e.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",
beforeShow:function(p,E){E.input.datepicker("setDate",m+","+s+","+u)},onSelect:function(p){f.list_item.deadlineType="customdeadline";f.list_item.customDeadlineValue=p;f.list_item.template="dashboard";ListListItem.Update({successCallback:function(E,y){var F=b.parent();b.hide("slow",function(){b.remove();F.find(".dashboard-item").length===0&&F.append(c._NothingToDoText())});c._CreateDashboardItem(y,E,{highlightCategory:true,addType:"prepend"})},lists:f.list_item.list_id,list_items:f.list_item.id,send:f});
i.datepicker("hide")}})},_AppendToDashboard:function(b,c,i){i=i||{};b.find(".nothing-todo").remove();i.addType==="prepend"?b.find("div[data-type=scheduleColumn]").first().prepend(c):b.find("div[data-type=scheduleColumn]").first().append(c);i.highlightCategory===true&&c.effect("highlight",{},2E3)},_CreateDashboardItem:function(b,c,i){var e=this,f=$($.mustache(c,b.list_item));switch(b.list_item.deadline_category){case "today":e._AppendToDashboard(e.today,f,i);break;case "tomorrow":e._AppendToDashboard(e.tomorrow,
f,i);break;case "this week":e._AppendToDashboard(e.thisweek,f,i);break;case "next week":e._AppendToDashboard(e.nextweek,f,i);break;default:e._AppendToDashboard(e.later,f,i)}f.data("data",b);f.find(".dashboard-list-item-title").bind("click",function(){e._trigger("OpenList",0,{selectedList:b.list_item})});f.find(".dashboard-item-more").bind("click",function(){e._trigger("OpenList",0,{selectedList:b.list_item})});f.find(".full-content").bind("click",function(){$(this).hide();f.find(".shortend-content").show()});
f.find(".shortend-content").bind("click",function(){$(this).hide();f.find(".full-content").show()});f.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var j=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');$that.append(j);$that.animate({width:"100%",paddingLeft:"14px"},200);j.find(".yes").bind("click",function(){b.list_item.completed=true;ListListItem.Update({successCallback:function(){f.stop(true,
true).hide("slow",function(){f.remove()})},lists:b.list_item.list_id,list_items:b.list_item.id,send:b});j.find(".no").trigger("click");return false});j.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){j.remove()});return false})});f.find(".dashboard-item-more").bind("click",function(){e._trigger("OpenList",0,{selectedList:b.list_item})});e._SetupCustomDeadlinePicker(f);f.find(".dashboard-list-item-deadline").bind("click",function(){f.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});
return f},_Filter:function(){var b=this.selectedText;if(b==="")this.wrapper.find(".dashboard-item").show();else{this.wrapper.find(".dashboard-item:not(:Contains('"+b+"'))").hide();this.wrapper.find(".dashboard-item:Contains('"+b+"')").show()}},_create:function(){},options:{},Show:function(){var b=this;b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn"></div></div>');
b.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn"></div></div>');b.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn"></div></div>');b.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn"></div></div>');b.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn"></div></div>');b.element.append(b.header);b.element.append(b.wrapper);
b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');ListItem.Index({successCallback:function(c,i){$.each(i,function(e,f){b._CreateDashboardItem(f,c)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append(b._NothingToDoText())});b._TriggerReinitOfPanes();b._TriggerResize()},send:{show:"dashboard"}})},
Hide:function(){this.element.children().remove()},destroy:function(){},Filter:function(b){this.selectedText=b;this._Filter()}})})();
(function(b){function c(i){if(typeof i.data==="string"){var e=i.handler,f=i.data.toLowerCase().split(" ");i.handler=function(j){if(!(this!==j.target&&(/textarea|select/i.test(j.target.nodeName)||j.target.type==="text"))){var m=j.type!=="keypress"&&b.hotkeys.specialKeys[j.which],s=String.fromCharCode(j.which).toLowerCase(),u="",p={};if(j.altKey&&m!=="alt")u+="alt+";if(j.ctrlKey&&m!=="ctrl")u+="ctrl+";if(j.metaKey&&!j.ctrlKey&&m!=="meta")u+="meta+";if(j.shiftKey&&m!=="shift")u+="shift+";if(m)p[u+m]=
true;else{p[u+s]=true;p[u+b.hotkeys.shiftNums[s]]=true;if(u==="shift+")p[b.hotkeys.shiftNums[s]]=true}m=0;for(s=f.length;m<s;m++)if(p[f[m]])return e.apply(this,arguments)}}}}b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:c}})})(jQuery);
(function(){$.widget("ui.ListItemView",{_SetSelectedListItem:function(b,c){this.selectedListItem={element:b,data:c}},_Filter:function(){var b=this.selectedText;if(b==="")this.listItemList.find(".row").show();else{this.listItemList.find(".row:not(:Contains('"+b+"'))").hide();this.listItemList.find(".row:Contains('"+b+"')").show()}},_SetupDeadlineButton:function(b){var c=b.find("#deadline-settings-wrapper"),i=b.find("#save-deadline");i.bind("click keydown","return",function(){i.data("settings-visible")?
c.hide("fast",function(){c.find(".deadline-button").first();i.data("settings-visible",false)}):c.show("fast",function(){c.find(".deadline-button").first().focus();i.data("settings-visible",true)});return false})},_SetupCustomDeadlinePicker:function(){$("#custom-deadline-display").datepicker({minDate:new Date,altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",
new Date))},_TriggerReinitOfPanes:function(){this._trigger("ReinitPanes",0,{})},_TriggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_AddListItem:function(b,c,i){var e=this,f=$($.mustache(c,b.list_item));f.data("data",b);f.data("isFullsize",false);i?e.listItemList.prepend(f):e.listItemList.append(f);f.find(".handle").height(f.height());f.bind("keyup","space",function(){e.toolbar.find("#list-item-completed").effect("puff",{},300,function(){$(this).show();f.find(".undo").length===
0?e.toolbar.find("#list-item-completed").trigger("click"):f.find(".undo").trigger("click")});return false});f.bind("keydown","del",function(){e.toolbar.find("#list-item-delete").effect("puff",{},300,function(){$(this).show();e.toolbar.find("#list-item-delete").trigger("click")});return false});f.bind("focus",function(j){if($(j.target).hasClass("row")){e.listItemList.find(".row").removeClass("selected-row");$(j.target).addClass("selected-row");$(j.target).data("data");if(e.toolbar)$(j.target).data("isFullsize")===
true?e.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"}):e.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"});e._SetSelectedListItem($(j.target),$(j.target).data("data"))}});$.browser.msie&&f.bind("click ",function(){f.focus();return false});f.bind("keydown","down",function(j){j.preventDefault();$(j.target).nextAll("div:visible").first().focus();return false});f.bind("keydown","up",function(j){j.preventDefault();$(j.target).prevAll("div:visible").first().focus();
return false});f.bind("keydown dblclick","return",function(){if(f.find("form").length>0)return false;e.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});e.listItemList.find(".row").find("form").remove();ListListItem.Edit({successCallback:function(j){if($.browser.msie&&f.find("form").length>0)return false;var m=$(j),s=f.data("isFullsize");e.listItemList.find(".row").hide();e.selectedListItem.element.show();m.hide();e.selectedListItem.element.prepend(m);m.find("textarea").markItUp(mySettings);
e._SetupDeadlineButton(m);e._SetupCustomDeadlinePicker();s===false&&e._ToggleFullsize(f);e.selectedListItem.element.find(".handle").hide();m.show("slow",function(){m.find("textarea").focus()});m.find("textarea").bind("keydown","esc",function(){m.find("#cancel-edit").trigger("click")});m.find(".deadline-button").bind("keydown click","return",function(u){u.preventDefault();var p=f.find("form").serializeForm();p.list_item.deadlineType=$(u.target).attr("data-deadline");p.list_item.customDeadlineValue=
$("#custom-deadline-value").val();ListListItem.Update({send:p,successCallback:function(E,y){m.hide("slow",function(){$(this).remove();e.selectedListItem.element.find(".handle").show();f.find(".list-item-content").html(y.list_item.body_rendered);f.find(".list-item-deadline").html(y.list_item.deadline_in_words);f.find(".handle").height(f.find(".list-item-content").height());s===false&&e._ToggleFullsize(f);e._SetSelectedListItem(f,y);f.data("data",y);e._Filter();f.focus()})},lists:e.selectedListItem.data.list_item.list_id,
list_items:e.selectedListItem.data.list_item.id});return false});m.find("#cancel-edit").bind("keydown click","return",function(u){u.preventDefault();e.selectedListItem.element.find(".handle").show();m.hide("slow",function(){$(this).remove();s===false&&e._ToggleFullsize(f);e._Filter();f.focus()});return false});return false},lists:e.selectedListItem.data.list_item.list_id,list_items:e.selectedListItem.data.list_item.id})});f.bind("keydown","left",function(){e._trigger("SelectLastList",0,{})});f.bind("keydown",
"shift+return",function(){e.toolbar.find("#list-item-new").effect("puff",{},300,function(){$(this).show();e._AddNewListItem()})});f.bind("keydown","l",function(){e.toolbar.find("#list-item-fullsize").effect("puff",{},300,function(){e.toolbar.find("#list-item-fullsize").trigger("click");$(this).show()});return false});ListKungFu&&ListKungFu.LayoutCenter&&f.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+f.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},
appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};e._trigger("StartedDraggingListItem",0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});e._CorrectHeight(f)},_ToggleFullsize:function(b){if(b.data("isFullsize")===true){this._CorrectHeight(b,false);b.data("isFullsize",false);this.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"})}else{this._CorrectHeight(b,
true);b.data("isFullsize",true);this.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"})}},_CorrectHeight:function(b,c){b.height()>150&&!c?b.height(150):b.height("auto");this._TriggerResize()},_DeleteListItem:function(b,c){ListListItem.Destroy({successCallback:function(){b.hide("slow",function(){var i=b.next(".row");i.length>0||(i=b.prev(".row"));i.focus();b.remove()})},lists:c.list_item.list_id,list_items:c.list_item.id})},_MarkCompleted:function(b,c){var i=this;
c.list_item.completed=true;ListListItem.Update({successCallback:function(){var e="list-item-undo-"+c.list_item.id;b.find(".list-item-wrapper").hide("slow",function(){var f=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');f.bind("click",function(){i._MarkUncompleted(b,c,e)});b.append(f);i._CorrectHeight(b);f.delay(5E3,e).queue(e,function(){b.hide("slow",function(){b.remove()})}).dequeue(e);i.toolbar&&i.toolbar.find("#showCompleted").get(0).checked===true&&i._ToggleCompleted(true);
b.focus()})},lists:c.list_item.list_id,list_items:c.list_item.id,send:c})},_MarkUncompleted:function(b,c,i){var e=this;i!==""&&b.clearQueue(i);c.list_item.completed=false;ListListItem.Update({successCallback:function(){b.find(".undo").hide("slow",function(){$(this).remove()});b.find(".list-item-wrapper").show("slow",function(){e._CorrectHeight(b)});e.toolbar&&e.toolbar.find("#showCompleted").get(0).checked===true&&e._ToggleCompleted(true)},lists:c.list_item.list_id,list_items:c.list_item.id,send:c})},
_ToggleCompleted:function(b){var c=this;if(b===true){if(c.completedList){c.completedList.remove();c.completedList=null}c.completedList=$('<div id="completedList"></div>');b=c.element.data("data-list");ListListItem.Index({successCallback:function(i,e){$.each(e,function(f,j){c.completedList.append("<div>"+j.list_item.body_rendered+"</div>")});e.length===0&&c.completedList.append("<div>No completed items</div>");c.wrapper.prepend(c.completedList)},send:{show:"completed"},lists:b.list.id})}else{c.completedList.remove();
c.completedList=null}},_CreateToolbar:function(){var b=this;b.header.html("");b.toolbar=$('<div id="list-item-toolbar"><div id="list-name"></div><div id="list-item-toolbar-buttons"><button id="list-item-completed">Completed [space]</button><button id="list-item-new">Create [shift+return]</button><button id="list-item-delete">Delete [del]</button><button id="list-item-edit">Edit [return]</button><button id="list-item-fullsize">Fullsize [l]</button><input type="checkbox" id="showCompleted"/><label for="showCompleted">Show Completed Items</label></div></div>');
b.listName=b.toolbar.find("#list-name");b.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});b.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.toolbar.find("#list-item-fullsize").button({text:false,icons:{primary:"ui-icon-zoomin"}});b.toolbar.find("#list-item-new").bind("click",
function(){b._AddNewListItem()});b.toolbar.find("#showCompleted").bind("change",function(c){b._ToggleCompleted(c.target.checked);b.selectedListItem.element.focus()});b.toolbar.find("#list-item-completed").bind("click",function(){b._MarkCompleted(b.selectedListItem.element,b.selectedListItem.data)});b.toolbar.find("#list-item-delete").bind("click",function(){var c=function(){b._DeleteListItem(b.selectedListItem.element,b.selectedListItem.data)};if(typeof b.deleteDialog==="undefined")b.deleteDialog=
$.confirmationDialog("Delete List Item",c,"Cancel","Do you really want to delete?");b.deleteDialog.dialog("open")});b.toolbar.find("#list-item-edit").bind("click",function(){b.selectedListItem.element.trigger("dblclick")});b.toolbar.find("#list-item-fullsize").bind("click",function(){b._ToggleFullsize(b.selectedListItem.element)});b.header.append(b.toolbar)},_AddNewListItem:function(){var b=this,c=b.element.data("data-list");if(b.listItemList.find("#new_list_item").length>0)return false;ListListItem.New({successCallback:function(i){if($.browser.msie&&
b.listItemList.find("#new_list_item").length>0)return false;var e=$(i);b.listItemList.prepend(e);b._SetupDeadlineButton(e);b._SetupCustomDeadlinePicker();e.find("textarea").markItUp(mySettings);e.find("textarea").focus();b.listItemList.find(".row").hide();e.find("#cancel-edit").bind("click",function(f){f.preventDefault();e.hide("slow",function(){$(this).remove();b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus()})});e.find(".deadline-button").bind("click",function(f){f.preventDefault();
var j=e.serializeForm();j.list_item.body=j.list_item.body.replace(/\n/g,"\n\n");j.list_item.deadlineType=$(f.target).attr("data-deadline");j.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:j,successCallback:function(m,s){e.hide("slow",function(){b._AddListItem(s,m,true);$(this).remove();b.toolbar.find("#list-item-search").trigger("ClearValue");b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();b.listItemList.find(".row").first().find(".handle").height(b.listItemList.find(".row").first().find(".list-item-content").height())})},
lists:c.list.id});return false});e.find("textarea").bind("keydown","esc",function(){e.find("#cancel-edit").trigger("click")})},lists:c.list.id})},_create:function(){var b=this;b.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');b.listItemList=$('<div id="list-item-list"></div>');b.header=$('<div class="header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.listItemList);b._TriggerResize();$(document).bind("keydown","c",function(){var c=b.toolbar.find("#showCompleted");
if(c.length>0){if(c.get(0).checked===true)c.get(0).checked=false;else c.get(0).checked=true;c.trigger("change")}});$(document).bind("keyup","f",function(){b.toolbar.find("#list-item-search").focus()})},options:{},RemoveList:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")},OpenList:function(b){var c=this;c.RemoveList();c._create();c.element.data("data-list",b);ListListItem.Index({successCallback:function(i,e){c._CreateToolbar();$.each(e,function(f,
j){c._AddListItem(j,i)});b.id?c.listItemList.find(".row").each(function(){var f=$(this);if(f.data("data").list_item.id===b.id){f.focus();return false}}):c.listItemList.find(".row").first().focus();c.listItemList.find(".row").length===0&&c._AddNewListItem();c.listName.text(b.list.title)},lists:b.list.id});c._TriggerReinitOfPanes()},SelectListItem:function(){this.selectedListItem?this.selectedListItem.element.effect("highlight",{},300,function(){$(this).show().focus()}):this.listItemList.find(".row").first().effect("highlight",
{},300,function(){$(this).show().focus()})},destroy:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")},Filter:function(b){this.selectedText=b;this._Filter()}})})();
(function(){$.widget("ui.ListView",{_ReplaceList:function(b,c,i){c=this._GetListElement(c,i);b.replaceWith(c);this._AdjustHeight();this._triggerResize();c.focus()},_DroppableConfigTags:function(){var b=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(c,i){var e=$(this);if(e.position().top<b.wrapper.height()){var f=i.draggable.data("data"),j=e.data("data");j.list.tag_id=f.tag.id;List.Update({send:j,successCallback:function(m,s){b._ReplaceList(e,s,m)},
lists:j.list.id})}}}},_DroppableConfigListItems:function(b){var c=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(i,e){if($(this).position().top<c.wrapper.height()){var f=e.draggable.data("data"),j=$(this).data("data");f={list_item:{body:f.list_item.body.replace(/\n/g,"\n\n")}};ListListItem.Create({send:f,successCallback:function(){$(i.target).find(".fake-drop").remove();b.effect("highlight",{},3E3)},lists:j.list.id})}},over:function(i,e){var f=
$('<div class="fake-drop"></div>');f.html("<p>"+e.helper.text()+"</p>");$(i.target).append(f)},out:function(i){$(i.target).find(".fake-drop").remove()}}},_IsNewList:function(b){return this.selectedList===null||this.selectedList.data.list.id!==b.list.id?true:false},_HighlightFormErrors:function(b,c){for(var i in c){var e=c[i],f;for(f in e){for(var j=e[f],m=$('<div class="error_explanation"><ul></ul></div>'),s=m.find("ul"),u=b.find("*[name="+(i+"["+f+"]")+"]"),p=0;p<j.length;p++){u.parent(".field").addClass("field_with_errors");
s.append("<li>"+j[p]+"</li>")}u.parent(".field").append(m)}}},_ClearFormErrors:function(b){b.find(".field").removeClass("field_with_errors");b.find(".error_explanation").remove()},_DeleteList:function(b){var c=this,i=c.selectedList.element.next(),e=c.selectedList.element.prev();b=b||0;List.Destroy({successCallback:function(){c.selectedList.element.delay(b).fadeOut(function(){$(this).remove();i.length>0?i.focus():e.focus();c._ToggleEmptyListImage()});c._trigger("CloseList",0,{})},lists:c.selectedList.data.list.id})},
_CreateToolbar:function(){var b=this,c=$('<div id="list-toolbar"><button id="list-new">Create [shift+return]</button><button id="list-delete">Delete [del]</button><button id="list-edit">Edit [space]</button></div>');b.element.find("div.header").append(c);c.find("#list-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});c.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});c.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});c.find("#list-delete").bind("click",
function(i){if(b.selectedList!==null){if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List",function(){if(b.listForm!==null){b.listForm.bind("FormHidden",function(){b._DeleteList(1E3)});b._HideForm()}else b._DeleteList()},"Cancel","Do you really want to delete?");b.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();$(i.target).blur();return false});c.find("#list-new").bind("click",function(i){b.listlist.hide("slide",
{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.New({successCallback:function(e,f){b.emptyListImage.hide();b.listForm.append(e);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b._trigger("CloseList",0,{});b.listForm.find("#list-back-button").bind("click",function(){b._HideForm()});b.listForm.find("#list_title").bind("keydown",
"esc",function(){b._HideForm()});b.listForm.bind("submit",function(j){j.preventDefault();j=$(this).find("form").serializeForm();f.list=j.list;List.Create({send:f,successCallback:function(m,s,u,p,E){b._ClearFormErrors(b.listForm);E===false?b._HideForm(s,m):b._HighlightFormErrors(b.listForm,E)}});return false});b.selectedList=null}})});$(i.target).blur();return false});c.find("#list-edit").bind("click",function(){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();
b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.Edit({successCallback:function(i){b.listForm.append(i);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b.listForm.find("#list-back-button").bind("click",function(){b._HideForm();return false});b.listForm.find("#list_title").bind("keydown","esc",function(){b._HideForm();return false});b.listForm.bind("submit",function(e){e.preventDefault();
e=$(this).find("form").serializeForm();List.Update({send:e,successCallback:function(f,j,m,s,u){b._ClearFormErrors(b.listForm);u===false?b._HideForm(j,f):b._HighlightFormErrors(b.listForm,u)},lists:b.selectedList.data.list.id});return false})},lists:b.selectedList.data.list.id})})});return c},_GetListElement:function(b,c){var i=this,e=$($.mustache(c,b.list));e.attr("tabindex",0);e.data("data",b);e.addClass("row");$.browser.msie&&e.bind("click",function(){e.focus();return false});e.bind("keydown","down",
function(f){f.preventDefault();$(f.target).nextAll("div:visible").first().focus();return false});e.bind("keydown","up",function(f){f.preventDefault();$(f.target).prevAll("div:visible").first().focus();return false});e.bind("focus",function(f){f=$(f.target);i.selectedList={element:f,data:f.data("data")};i.listlist.find(".row").removeClass("selected-row");f.addClass("selected-row");i.listlist.find(".assigned-tags").hide();f.find(".assigned-tags").show();i._AdjustHeight()});e.bind("keydown dblclick",
"return",function(){i._trigger("OpenList",0,{selectedList:e.data("data")})});e.bind("keydown","right",function(){i._trigger("SelectListItem",0,{})});e.bind("keydown","shift+return",function(){i.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});e.bind("keydown","del",function(){i.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});e.bind("keydown","space",function(){i.toolbar.find("#list-edit").effect("puff",
{},300,function(){$(this).show();$(this).trigger("click")});return false});e.droppable(i._DroppableConfigListItems(e));e.find(".assigned-tag-delete").bind("click",function(f){var j=$(f.target).parent(".assigned-tag");f=j.attr("data-id");var m=e.data("data");m.list.tag_id=f;m.list.tag_action="remove";List.Update({send:m,successCallback:function(s,u){j.hide("slow",function(){j.remove();i._ReplaceList(e,u,s);i._Filter()})},lists:m.list.id})});e.find(".assigned-tags").hide();return e},_triggerResize:function(){this._trigger("ContentDimensionsChanged",
0,{})},_AdjustHeight:function(){this.listlist.find(".row").each(function(){var b=$(this),c=b.find(".list-tag");b=b.find(".list-name");c.height(b.height()+10+"px")})},_AddListToDOM:function(b,c){this.listlist=$('<div id="list-list"></div>');this.wrapper.append(this.listlist);for(var i=0;i<b.length;i++)this.listlist.append(this._GetListElement(b[i],c));this._AdjustHeight();this._triggerResize()},_SelectLastList:function(){this.selectedList?this.selectedList.element.effect("highlight",{},300,function(){$(this).show();
$(this).focus()}):this.listlist.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})},_RegisterGlobalKeyboardShortcuts:function(){var b=this;$(document).bind("keydown","ctrl+l",function(){b._SelectLastList()})},_ShowListView:function(b,c){var i=this;i.listlist.show("slide",{direction:"left"},"slow",function(){if(b){var e=i._GetListElement(b,c);i._IsNewList(b)?i.listlist.prepend(e):i.selectedList.element.replaceWith(e);i._AdjustHeight();i._ToggleEmptyListImage();
i.selectedList={data:b,element:e}}i.selectedList&&i.selectedList.element.focus()})},_HideForm:function(b,c){var i=this;i.listForm.hide("slide",{direction:"left"},"slow",function(){i._ShowListView(b,c);i.listForm.trigger("FormHidden");i._ToggleEmptyListImage();i.selectedList?i.selectedList.element.focus():i.listlist.find(".row").first().focus();i.listForm.remove();i.listForm=null})},_Filter:function(){this._FilterBySearchText();this._FilterByTags()},_FilterBySearchText:function(){var b=this.selectedText;
this.listlist.find(".row").show();if(b){this.listlist.find(".row:visible:not(:Contains('"+b+"'))").hide();this.listlist.find(".row:visible:Contains('"+b+"')").show()}this._AdjustHeight();this._triggerResize()},_FilterByTags:function(){var b=this;b.listlist.find(".row:visible").each(function(){var c=$(this),i=c.data("data"),e=0;if(b.selectedTags.length>0){for(var f=0;f<i.list.tags.length;f++)for(var j=0;j<b.selectedTags.length;j++)b.selectedTags[j]===i.list.tags[f].id&&e++;e===b.selectedTags.length?
c.show():c.hide()}})},_create:function(){var b=this;b.selectedList=null;b.wrapper=b.element.find("div#list-wrapper");b.toolbar=b._CreateToolbar();b.listForm=null;b.selectedTags=[];var c=new Date;c=Date.UTC(c.getFullYear(),c.getMonth(),c.getDay(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds());b.emptyListImage=$('<img src="/images/empty/list.jpg?'+c+'"/>');b.emptyListImage.css({position:"absolute",top:"45px",left:"15px"});b.emptyListImage.hide();b.toolbar.append(b.emptyListImage);
List.Index({successCallback:function(i,e){b.wrapper.find(".row").remove();b._AddListToDOM(e,i);b._ToggleEmptyListImage()}});b._RegisterGlobalKeyboardShortcuts()},_ToggleEmptyListImage:function(){if(this.listlist.find(".row").length>0){this.emptyListImage.hide();this.listlist.find(".row").first().focus()}else this.emptyListImage.show()},options:{},SetupDroppable:function(b){var c=this;c.listlist.find(".row").each(function(){var i=$(this);i.droppable("destroy");switch(b){case "listitem":i.droppable(c._DroppableConfigListItems(i));
break;case "tag":i.droppable(c._DroppableConfigTags())}})},ReloadLists:function(){var b=this;List.Index({successCallback:function(c,i){b.wrapper.find(".row").remove();b._AddListToDOM(i,c);b._Filter();b._ToggleEmptyListImage()}})},SelectList:function(){this._SelectLastList()},Filter:function(b,c){if(b)this.selectedTags=b;if(!(c==null||typeof c==="undefined"))this.selectedText=c;this._Filter()},destroy:function(){this.toolbar.remove();this.listForm.remove();this.wrapper.find(".row").remove()}})})();
(function(b){b.fn.serializeForm=function(){var c=b(this).find('*[name*="]"]'),i={};b.each(c,function(e,f){var j=b(f),m=j.get(0).name.split("[")[0],s=j.get(0).name.split("[")[1];s=s.replace("]","");j=j.val();i[m]=i[m]||{};i[m][s]=j});return i}})(jQuery);
(function(){$.widget("ui.StatusBar",{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b).fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}})})();if(!this.JSON)this.JSON={};
(function(){function b(p){return p<10?"0"+p:p}function c(p){f.lastIndex=0;return f.test(p)?'"'+p.replace(f,function(E){var y=s[E];return typeof y==="string"?y:"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+p+'"'}function i(p,E){var y,F,H,I,C=j,K,D=E[p];if(D&&typeof D==="object"&&typeof D.toJSON==="function")D=D.toJSON(p);if(typeof u==="function")D=u.call(E,p,D);switch(typeof D){case "string":return c(D);case "number":return isFinite(D)?String(D):"null";case "boolean":case "null":return String(D);
case "object":if(!D)return"null";j+=m;K=[];if(Object.prototype.toString.apply(D)==="[object Array]"){I=D.length;for(y=0;y<I;y+=1)K[y]=i(y,D)||"null";H=K.length===0?"[]":j?"[\n"+j+K.join(",\n"+j)+"\n"+C+"]":"["+K.join(",")+"]";j=C;return H}if(u&&typeof u==="object"){I=u.length;for(y=0;y<I;y+=1){F=u[y];if(typeof F==="string")if(H=i(F,D))K.push(c(F)+(j?": ":":")+H)}}else for(F in D)if(Object.hasOwnProperty.call(D,F))if(H=i(F,D))K.push(c(F)+(j?": ":":")+H);H=K.length===0?"{}":j?"{\n"+j+K.join(",\n"+j)+
"\n"+C+"}":"{"+K.join(",")+"}";j=C;return H}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,m,s={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},u;if(typeof JSON.stringify!=="function")JSON.stringify=function(p,E,y){var F;m=j="";if(typeof y==="number")for(F=0;F<y;F+=1)m+=" ";else if(typeof y==="string")m=y;if((u=E)&&typeof E!=="function"&&(typeof E!=="object"||typeof E.length!=="number"))throw Error("JSON.stringify");return i("",
{"":p})};if(typeof JSON.parse!=="function")JSON.parse=function(p,E){function y(H,I){var C,K,D=H[I];if(D&&typeof D==="object")for(C in D)if(Object.hasOwnProperty.call(D,C)){K=y(D,C);if(K!==undefined)D[C]=K;else delete D[C]}return E.call(H,I,D)}var F;p=String(p);e.lastIndex=0;if(e.test(p))p=p.replace(e,function(H){return"\\u"+("0000"+H.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(p.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){F=eval("("+p+")");return typeof E==="function"?y({"":F},""):F}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var b=function(){};b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(c,i,e,f){if(!f){this.context=i;this.buffer=[]}if(!this.includes("",c))if(f)return c;else{this.send(c);return}c=this.render_pragmas(c);c=this.render_section(c,i,e);if(f)return this.render_tags(c,i,e,f);this.render_tags(c,i,e,f)},send:function(c){c!=""&&this.buffer.push(c)},render_pragmas:function(c){if(!this.includes("%",c))return c;
var i=this;return c.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(e,f,j){if(!i.pragmas_implemented[f])throw{message:"This implementation of mustache doesn't understand the '"+f+"' pragma"};i.pragmas[f]={};if(j){e=j.split("=");i.pragmas[f][e[0]]=e[1]}return""})},render_partial:function(c,i,e){c=this.trim(c);if(!e||e[c]===undefined)throw{message:"unknown_partial '"+c+"'"};if(typeof i[c]!="object")return this.render(e[c],i,e,true);return this.render(e[c],i[c],e,true)},render_section:function(c,
i,e){if(!this.includes("#",c)&&!this.includes("^",c))return c;var f=this;return c.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(j,m,s,u){j=f.find(s,i);if(m=="^")return!j||f.is_array(j)&&j.length===0?f.render(u,i,e,true):"";else if(m=="#")return f.is_array(j)?f.map(j,function(p){return f.render(u,f.create_context(p),e,true)}).join(""):f.is_object(j)?f.render(u,f.create_context(j),e,true):typeof j==="function"?
j.call(i,u,function(p){return f.render(p,i,e,true)}):j?f.render(u,i,e,true):""})},render_tags:function(c,i,e,f){var j=this,m=function(){return RegExp(j.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+j.ctag+"+","g")},s=m(),u=function(E,y,F){switch(y){case "!":return"";case "=":j.set_delimiters(F);s=m();return"";case ">":return j.render_partial(F,i,e);case "{":return j.find(F,i);default:return j.escape(j.find(F,i))}};c=c.split("\n");for(var p=0;p<c.length;p++){c[p]=c[p].replace(s,u,this);f||this.send(c[p])}if(f)return c.join("\n")},
set_delimiters:function(c){c=c.split(" ");this.otag=this.escape_regex(c[0]);this.ctag=this.escape_regex(c[1])},escape_regex:function(c){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return c.replace(arguments.callee.sRE,"\\$1")},find:function(c,i){c=this.trim(c);var e;if(i[c]===false||i[c]===0||i[c])e=i[c];else if(this.context[c]===false||this.context[c]===0||this.context[c])e=this.context[c];if(typeof e==="function")return e.apply(i);
if(e!==undefined)return e;return""},includes:function(c,i){return i.indexOf(this.otag+c)!=-1},escape:function(c){return String(c===null?"":c).replace(/&(?!\w+;)|["<>\\]/g,function(i){switch(i){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return i}})},create_context:function(c){if(this.is_object(c))return c;else{var i=".";if(this.pragmas["IMPLICIT-ITERATOR"])i=this.pragmas["IMPLICIT-ITERATOR"].iterator;var e={};e[i]=c;return e}},
is_object:function(c){return c&&typeof c=="object"},is_array:function(c){return Object.prototype.toString.call(c)==="[object Array]"},trim:function(c){return c.replace(/^\s*|\s*$/g,"")},map:function(c,i){if(typeof c.map=="function")return c.map(i);else{for(var e=[],f=c.length,j=0;j<f;j++)e.push(i(c[j]));return e}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(c,i,e,f){var j=new b;if(f)j.send=f;j.render(c,i,e);if(!f)return j.buffer.join("\n")}}}();
(function(b){b.mustache=function(c,i,e){return Mustache.to_html(c,i,e)}})(jQuery);
(function(b){b.fn.layout=function(c){function i(d){if(!d)return true;var g=d.keyCode;if(g<33)return true;var h={38:"north",40:"south",37:"west",39:"east"},k=g>=37&&g<=40,l=d.shiftKey,n=d.ctrlKey,t=false,q,w,r;if(!n&&!l)return true;else if(k&&p[h[g]].enableCursorHotkey)t=h[g];else b.each(v.borderPanes.split(","),function(x,A){q=p[A];w=q.customHotkey;r=q.customHotkeyModifier;if(l&&r=="SHIFT"||n&&r=="CTRL"||n&&l)if(w&&g==(isNaN(w)||w<=9?w.toUpperCase().charCodeAt(0):w)){t=A;return false}});if(!t)return true;
q=p[t];h=y[t];if(!q.enableCursorHotkey||h.isHidden||!B[t])return true;if((h=d.target||d.srcElement)&&l&&k&&(h.tagName=="TEXTAREA"||h.tagName=="INPUT"&&(g==37||g==39)))return true;ba(t);d.stopPropagation();return d.returnValue=false}function e(d){if(this&&this.tagName)d=this;d=typeof d=="string"?B[d]:b(d).attr("pane")?b(d):b(d).parents("div[pane]:first");if(d.length){var g=d.attr("pane"),h=y[g];h.cssSaved&&f(g);if(h.isSliding||h.isResizing||h.isClosed)h.cssSaved=false;else{var k={zIndex:v.zIndex.pane_normal+
1},l={},n=d.css("overflow"),t=d.css("overflowX"),q=d.css("overflowY");if(n!="visible"){l.overflow=n;k.overflow="visible"}if(t&&t!="visible"&&t!="auto"){l.overflowX=t;k.overflowX="visible"}if(q&&q!="visible"&&q!="auto"){l.overflowY=t;k.overflowY="visible"}h.cssSaved=l;d.css(k);b.each(v.allPanes.split(","),function(w,r){r!=g&&f(r)})}}}function f(d){if(this&&this.tagName)d=this;d=typeof d=="string"?B[d]:b(d).hasClass("ui-layout-pane")?b(d):b(d).parents("div[pane]:first");if(d.length){var g=d.attr("pane");
g=y[g];var h=g.cssSaved||{};!g.isSliding&&!g.isResizing&&d.css("zIndex",v.zIndex.pane_normal);d.css(h);g.cssSaved=false}}function j(d,g,h){var k=b(d);if(k.length)if(v.borderPanes.indexOf(g)==-1)alert("Error Adding Button \n\nInvalid pane: "+g);else{d=p[g].buttonClass+"-"+h;k.addClass(d+" "+d+"-"+g);return k}else alert("Error Adding Button \n\nInvalid selector: "+d);return false}function m(d,g){b.each(v[d].pins,function(h,k){s(b(k),d,g)})}function s(d,g,h){var k=d.attr("pin");if(!(k&&h==(k=="down"))){var l=
p[g].buttonClass+"-pin",n=l+"-"+g;g=l+"-up";k=n+"-up";l+="-down";n+="-down";d.attr("pin",h?"down":"up").attr("title",h?"Un-Pin":"Pin").removeClass(h?g:l).removeClass(h?k:n).addClass(h?l:g).addClass(h?n:k)}}var u={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},p={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:u.contentSelector,contentIgnoreSelector:u.contentIgnoreSelector,paneClass:u.paneClass,resizerClass:u.resizerClass,togglerClass:u.togglerClass,buttonClass:u.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},E={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},y={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},F={north:"south",south:"north",east:"west",west:"east"},H=function(d){if(typeof d=="string")return true;else if(typeof d=="object")try{return d.constructor.toString().match(/string/i)!==null}catch(g){}return false},I=function(d){return typeof d=="string"||H(d)?b.trim(d):d},C=function(d,g){return Math.max(d,g)},K=function(d){var g={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};d=d||{};if(d.effects||
d.defaults||d.north||d.south||d.west||d.east||d.center)g=b.extend(g,d);else b.each(d,function(h,k){a=h.split("__");g[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=k});return g},D=function(d,g,h){function k(t){n=v[t];if(n.doCallback){cpPane=n.callback.split(",")[1];cpPane!=t&&cpPane!=g&&k(cpPane,true)}else{n.doCallback=true;n.callback=l}}var l=d+","+g+","+(h?1:0),n;b.each(v.borderPanes.split(","),function(t,q){if(v[q].isMoving){k(q);return false}})},la=function(d){d=v[d];v.isLayoutBusy=false;delete d.isMoving;
if(d.doCallback&&d.callback){d.doCallback=false;var g=d.callback.split(","),h=g[2]>0?true:false;if(g[0]=="open")V(g[1],h);else g[0]=="close"&&T(g[1],h);if(!d.doCallback)d.callback=null}},L=function(d,g){if(g){var h;try{if(typeof g=="function")h=g;else if(typeof g!="string")return;else if(g.indexOf(",")>0){var k=g.split(",");h=eval(k[0]);if(typeof h=="function"&&k.length>1)return h(k[1])}else h=eval(g);if(typeof h=="function")return h(d,B[d],b.extend({},y[d]),b.extend({},p[d]),p.name)}catch(l){}}},
Q=function(d,g){var h=0,k=false,l="";if(!b.browser.msie)if(b.curCSS(d[0],"display",true)=="none"){k=true;l=b.curCSS(d[0],"visibility",true);d.css({display:"block",visibility:"hidden"})}h=parseInt(b.curCSS(d[0],g,true),10)||0;if(k){d.css({display:"none"});l&&l!="hidden"&&d.css({visibility:l})}return h},R=function(d,g){var h;if(H(d)){d=I(d);h=B[d]}else h=b(d);if(g<=0)return 0;else g>0||(g=H(d)?S(d):h.outerWidth());return b.boxModel?g-Q(h,"paddingLeft")-Q(h,"paddingRight")-(b.curCSS(h[0],"borderLeftStyle",
true)=="none"?0:Q(h,"borderLeftWidth"))-(b.curCSS(h[0],"borderRightStyle",true)=="none"?0:Q(h,"borderRightWidth")):g},N=function(d,g){var h;if(H(d)){d=I(d);h=B[d]}else h=b(d);if(g<=0)return 0;else g>0||(g=H(d)?S(d):h.outerHeight());return b.boxModel?g-Q(h,"paddingTop")-Q(h,"paddingBottom")-(b.curCSS(h[0],"borderTopStyle",true)=="none"?0:Q(h,"borderTopWidth"))-(b.curCSS(h[0],"borderBottomStyle",true)=="none"?0:Q(h,"borderBottomWidth")):g},S=function(d,g){var h=B[d],k=p[d],l=y[d],n=g?k.spacing_open:
0;k=g?k.spacing_closed:0;return!h||l.isHidden?0:l.isClosed||l.isSliding&&g?k:v[d].dir=="horz"?h.outerHeight()+n:h.outerWidth()+n},ca=function(d){var g=z,h=v[d].dir,k=y[d],l=B[F[d]],n=p[d].spacing_open,t=p[F[d]].spacing_open,q=!l?0:h=="horz"?l.outerHeight():l.outerWidth();l=k.minSize||0;h=Math.min(k.maxSize||9999,(h=="horz"?g.innerHeight:g.innerWidth)-n-q-t);var w,r;switch(d){case "north":w=g.offsetTop+l;r=g.offsetTop+h;break;case "west":w=g.offsetLeft+l;r=g.offsetLeft+h;break;case "south":w=g.offsetTop+
g.innerHeight-h;r=g.offsetTop+g.innerHeight-l;break;case "east":w=g.offsetLeft+g.innerWidth-h;r=g.offsetLeft+g.innerWidth-l}b.extend(k,{minSize:l,maxSize:h,minPosition:w,maxPosition:r})},ma=function(){var d={top:S("north",true),bottom:S("south",true),left:S("west",true),right:S("east",true),width:0,height:0};with(d){width=z.innerWidth-left-right;height=z.innerHeight-bottom-top;top+=z.top;bottom+=z.bottom;left+=z.left;right+=z.right}return d},na=function(d){var g={},h,k,l;b.each("Left,Right,Top,Bottom".split(","),
function(){h=I(this);k=g["border"+h]=Q(d,"border"+h+"Width");l=g["padding"+h]=Q(d,"padding"+h);g["offset"+h]=k+l;if(d==M)g[h.toLowerCase()]=b.boxModel?l:0});g.innerWidth=g.outerWidth=d.outerWidth();g.innerHeight=g.outerHeight=d.outerHeight();if(b.boxModel){g.innerWidth-=g.offsetLeft+g.offsetRight;g.innerHeight-=g.offsetTop+g.offsetBottom}return g},ra=function(d,g,h,k){var l=window.layout=window.layout||{};l=l.timers=l.timers||{};d="layout_"+y.id+"_"+d+"_"+g;l[d]||(l[d]=setTimeout(h,k))},da=function(d,
g){var h=window.layout=window.layout||{};h=h.timers=h.timers||{};var k="layout_"+y.id+"_"+d+"_"+g;if(h[k]){clearTimeout(h[k]);delete h[k];return true}else return false},sa=function(){try{if(M[0].tagName=="BODY"){b("html").css({height:"100%",overflow:"hidden"});b("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var d={overflow:"hidden"},g=M.css("position"),h=M.css("height");if(!M.hasClass("ui-layout-pane")){if(!g||"fixed,absolute,relative".indexOf(g)<
0)d.position="relative";if(!h||h=="auto")d.height="100%"}M.css(d)}}catch(k){}z=y.container=na(M)},ta=function(){b.each(v.borderPanes.split(","),function(d,g){var h=p[g];if(h.enableCursorHotkey||h.customHotkey){b(document).keydown(i);return false}})},ua=function(){c=K(c);if(c.effects){b.extend(E,c.effects);delete c.effects}b.each("name,scrollToBookmarkOnLoad".split(","),function(h,k){if(c[k]!==undefined)p[k]=c[k];else if(c.defaults[k]!==undefined){p[k]=c.defaults[k];delete c.defaults[k]}});b.each("paneSelector,resizerCursor,customHotkey".split(","),
function(h,k){delete c.defaults[k]});b.extend(p.defaults,c.defaults);v.center=b.extend(true,{},v.defaults,v.center);b.extend(p.center,c.center);var d=b.extend(true,{},p.defaults,c.defaults,p.center);b.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(h,k){p.center[k]=d[k]});var g=p.defaults;b.each(v.borderPanes.split(","),function(h,k){v[k]=b.extend(true,{},v.defaults,v[k]);o=p[k]=b.extend(true,{},p.defaults,p[k],c.defaults,c[k]);if(!o.paneClass)o.paneClass=
u.paneClass;if(!o.resizerClass)o.resizerClass=u.resizerClass;if(!o.togglerClass)o.togglerClass=u.togglerClass;b.each(["_open","_close",""],function(l,n){var t="fxName"+n,q="fxSpeed"+n,w="fxSettings"+n;o[t]=c[k][t]||c[k].fxName||c.defaults[t]||c.defaults.fxName||o[t]||o.fxName||g[t]||g.fxName||"none";var r=o[t];if(r=="none"||!b.effects||!b.effects[r]||!E[r]&&!o[w]&&!o.fxSettings)r=o[t]="none";r=E[r]||{};t=r.all||{};r=r[k]||{};o[w]=b.extend({},t,r,g.fxSettings||{},g[w]||{},o.fxSettings,o[w],c.defaults.fxSettings,
c.defaults[w]||{},c[k].fxSettings,c[k][w]||{});o[q]=c[k][q]||c[k].fxSpeed||c.defaults[q]||c.defaults.fxSpeed||o[q]||o[w].duration||o.fxSpeed||o.fxSettings.duration||g.fxSpeed||g.fxSettings.duration||r.duration||t.duration||"normal"})})},oa=function(){b.each(v.allPanes.split(","),function(){var d=I(this),g=p[d],h=y[d],k=v[d].dir,l=g.size=="auto"||isNaN(g.size)?0:g.size,n=g.minSize||1,t=g.maxSize||9999,q=g.spacing_open||0,w=g.paneSelector,r={},x;X[d]=false;if(w.substr(0,1)==="#")x=B[d]=M.find(w+":first");
else{x=B[d]=M.children(w+":first");x.length||(x=B[d]=M.children("form:first").children(w+":first"))}if(!x.length){B[d]=false;return true}x.attr("pane",d).addClass(g.paneClass+" "+g.paneClass+"-"+d);if(d!="center"){h.isClosed=false;h.isSliding=false;h.isResizing=false;h.isHidden=false;h.noRoom=false;v[d].pins=[]}r=b.extend({visibility:"visible",display:"block"},v.defaults.cssReq,v[d].cssReq);g.applyDefaultStyles&&b.extend(r,v.defaults.cssDef,v[d].cssDef);x.css(r);r={};switch(d){case "north":r.top=
z.top;r.left=z.left;r.right=z.right;break;case "south":r.bottom=z.bottom;r.left=z.left;r.right=z.right;break;case "west":r.left=z.left;break;case "east":r.right=z.right}if(k=="horz"){if(l===0||l=="auto"){x.css({height:"auto"});l=x.outerHeight()}l=C(l,n);l=Math.min(l,t);l=Math.min(l,z.innerHeight-q);r.height=C(1,N(d,l));h.size=l;h.maxSize=t;h.minSize=C(n,l-r.height+1);x.css(r)}else if(k=="vert"){if(l===0||l=="auto"){x.css({width:"auto","float":"left"});l=x.outerWidth();x.css({"float":"none"})}l=C(l,
n);l=Math.min(l,t);l=Math.min(l,z.innerWidth-q);r.width=C(1,R(d,l));h.size=l;h.maxSize=t;h.minSize=C(n,l-r.width+1);x.css(r);W(d,null,true)}else if(d=="center"){x.css(r);W("center",null,true)}if(g.initClosed&&g.closable){x.hide().addClass("closed");h.isClosed=true}else if(g.initHidden||g.initClosed){ga(d,true);h.isHidden=true}else x.addClass("open");g.showOverflowOnHover&&x.hover(e,f);if(g.contentSelector){h=X[d]=x.children(g.contentSelector+":first");if(!h.length){X[d]=false;return true}h.css(v.content.cssReq);
g.applyDefaultStyles&&h.css(v.content.cssDef);x.css({overflow:"hidden"})}})},va=function(){b.each(v.borderPanes.split(","),function(){var d=I(this),g=p[d],h=y[d],k=g.resizerClass,l=g.togglerClass,n=B[d];O[d]=false;Y[d]=false;if(!(!n||!g.closable&&!g.resizable)){var t=v[d].edge;n=n.is(":visible");var q="-"+d,w=n?"-open":"-closed",r;r=O[d]=b("<span></span>");n&&g.resizable||!n&&g.slidable&&r.attr("title",g.sliderTip).css("cursor",g.sliderCursor);r.attr("id",g.paneSelector.substr(0,1)=="#"?g.paneSelector.substr(1)+
"-resizer":"").attr("resizer",d).css(v.resizers.cssReq).css(t,z[t]+S(d)).addClass(k+" "+k+q+" "+k+w+" "+k+q+w).appendTo(M);g.applyDefaultStyles&&r.css(v.resizers.cssDef);if(g.closable){k=Y[d]=b("<div></div>");k.attr("id",g.paneSelector.substr(0,1)=="#"?g.paneSelector.substr(1)+"-toggler":"").css(v.togglers.cssReq).attr("title",n?g.togglerTip_open:g.togglerTip_closed).click(function(x){ba(d);x.stopPropagation()}).mouseover(function(x){x.stopPropagation()}).addClass(l+" "+l+q+" "+l+w+" "+l+q+w).appendTo(r);
if(g.togglerContent_open)b("<span>"+g.togglerContent_open+"</span>").addClass("content content-open").css("display",h.isClosed?"none":"block").appendTo(k);if(g.togglerContent_closed)b("<span>"+g.togglerContent_closed+"</span>").addClass("content content-closed").css("display",h.isClosed?"block":"none").appendTo(k);g.applyDefaultStyles&&k.css(v.togglers.cssDef);n||ha(d,true)}}});Z("all",true)},wa=function(){var d=typeof b.fn.draggable=="function",g;b.each(v.borderPanes.split(","),function(){var h=
I(this),k=p[h],l=y[h];if(!d||!B[h]||!k.resizable){k.resizable=false;return true}var n=k.resizerClass,t=n+"-drag",q=n+"-"+h+"-drag",w=n+"-dragging",r=n+"-"+h+"-dragging",x=false,A=O[h];l.isClosed||A.attr("title",k.resizerTip).css("cursor",k.resizerCursor);A.draggable({containment:M[0],axis:v[h].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:k.resizerDragOpacity,zIndex:v.zIndex.resizing,start:function(){if(false===L(h,k.onresize_start))return false;l.isResizing=true;da(h,"closeSlider");
A.addClass(t+" "+q);x=false;var G=h=="east"||h=="south"?k.spacing_open:0;ca(h);l.minPosition-=G;l.maxPosition-=G;g=v[h].dir=="horz"?"top":"left";b(k.maskIframesOnResize===true?"iframe":k.maskIframesOnResize).each(function(){b('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(b(this).offset()).appendTo(this.parentNode)})},drag:function(G,J){if(!x){b(".ui-draggable-dragging").addClass(w+
" "+r).children().css("visibility","hidden");x=true;l.isSliding&&B[h].css("zIndex",v.zIndex.sliding)}if(J.position[g]<l.minPosition)J.position[g]=l.minPosition;else if(J.position[g]>l.maxPosition)J.position[g]=l.maxPosition},stop:function(G,J){var P=J.position,U;A.removeClass(t+" "+q);switch(h){case "north":U=P.top;break;case "west":U=P.left;break;case "south":U=z.outerHeight-P.top-A.outerHeight();break;case "east":U=z.outerWidth-P.left-A.outerWidth()}ia(h,U-z[v[h].edge]);b("div.ui-layout-mask").remove();
l.isResizing=false}})})},ga=function(d,g){var h=p[d],k=y[d],l=B[d],n=O[d];if(!(!l||k.isHidden))if(false!==L(d,h.onhide_start)){k.isSliding=false;n&&n.hide();if(g||k.isClosed){k.isClosed=true;k.isHidden=true;l.hide();W(v[d].dir=="horz"?"all":"center");L(d,h.onhide_end||h.onhide)}else{k.isHiding=true;T(d,false)}}},ea=function(d,g){var h=p[d],k=y[d],l=O[d];if(B[d]&&k.isHidden)if(false!==L(d,h.onshow_start)){k.isSliding=false;k.isShowing=true;l&&h.spacing_open>0&&l.show();g===false?T(d,true):V(d)}},ba=
function(d){var g=y[d];if(g.isHidden)ea(d);else g.isClosed?V(d):T(d)},T=function(d,g,h){function k(){ha(d,true);J||L(d,q.onclose_end||q.onclose);if(J)L(d,q.onshow_end||q.onshow);if(P)L(d,q.onhide_end||q.onhide);la(d)}var l=B[d],n=O[d],t=Y[d],q=p[d],w=y[d];h=!h&&!w.isClosed&&q.fxName_close!="none";var r=v[d].edge,x=q.resizerClass,A=q.togglerClass,G="-"+d,J=w.isShowing,P=w.isHiding;delete w.isShowing;delete w.isHiding;if(!(!l||!q.resizable&&!q.closable))if(!(!g&&w.isClosed&&!J))if(v.isLayoutBusy)D("close",
d,g);else if(!(!J&&false===L(d,q.onclose_start))){v[d].isMoving=true;v.isLayoutBusy=true;w.isClosed=true;if(P)w.isHidden=true;else if(J)w.isHidden=false;m(d,false);w.isSliding||W(v[d].dir=="horz"?"all":"center");if(n){n.css(r,z[r]).removeClass(x+"-open "+x+G+"-open").removeClass(x+"-sliding "+x+G+"-sliding").addClass(x+"-closed "+x+G+"-closed");q.resizable&&n.draggable("disable").css("cursor","default").attr("title","");t&&t.removeClass(A+"-open "+A+G+"-open").addClass(A+"-closed "+A+G+"-closed").attr("title",
q.togglerTip_closed);Z()}if(h){fa(d,true);l.hide(q.fxName_close,q.fxSettings_close,q.fxSpeed_close,function(){fa(d,false);w.isClosed&&k()})}else{l.hide();k()}}},V=function(d,g,h){function k(){w.isSliding||W(v[d].dir=="vert"?"center":"all");if(n){n.css(r,z[r]+S(d)).removeClass(x+P+" "+x+G+P).addClass(x+J+" "+x+G+J).addClass(!w.isSliding?"":x+U+" "+x+G+U);q.resizable?n.draggable("enable").css("cursor",q.resizerCursor).attr("title",q.resizerTip):n.css("cursor","default");t&&t.removeClass(A+P+" "+A+G+
P).addClass(A+J+" "+A+G+J).attr("title",q.togglerTip_open);Z("all")}aa(d);m(d,!w.isSliding);L(d,q.onopen_end||q.onopen);if(ja)L(d,q.onshow_end||q.onshow);la(d)}var l=B[d],n=O[d],t=Y[d],q=p[d],w=y[d];h=!h&&w.isClosed&&q.fxName_open!="none";var r=v[d].edge,x=q.resizerClass,A=q.togglerClass,G="-"+d,J="-open",P="-closed",U="-sliding",ja=w.isShowing;delete w.isShowing;if(!(!l||!q.resizable&&!q.closable))if(w.isClosed||w.isSliding)if(w.isHidden&&!ja)ea(d,true);else if(v.isLayoutBusy)D("open",d,g);else if(false!==
L(d,q.onopen_start)){v[d].isMoving=true;v.isLayoutBusy=true;w.isSliding&&!g&&ka(d,false);w.isClosed=false;if(ja)w.isHidden=false;ca(d);w.size>w.maxSize&&l.css(v[d].sizeType,C(1,v[d].dir=="horz"?N(d,w.maxSize):R(d,w.maxSize)));ha(d,false);if(h){fa(d,true);l.show(q.fxName_open,q.fxSettings_open,q.fxSpeed_open,function(){fa(d,false);w.isClosed||k()})}else{l.show();k()}}},fa=function(d,g){var h=B[d];if(g){h.css({zIndex:v.zIndex.animation});if(d=="south")h.css({top:z.top+z.innerHeight-h.outerHeight()});
else d=="east"&&h.css({left:z.left+z.innerWidth-h.outerWidth()})}else{y[d].isSliding||h.css({zIndex:v.zIndex.pane_normal});if(d=="south")h.css({top:"auto"});else d=="east"&&h.css({left:"auto"})}},ha=function(d,g){var h=p[d],k=O[d],l=h.slideTrigger_open;if(k&&h.slidable){if(l!="click"&&l!="dblclick"&&l!="mouseover")l="click";k[g?"bind":"unbind"](l,xa).css("cursor",g?h.sliderCursor:"default").attr("title",g?h.sliderTip:"")}},ka=function(d,g){function h(t){da(d,"closeSlider");t.stopPropagation()}var k=
p[d].slideTrigger_close,l=B[d],n=O[d];y[d].isSliding=g;da(d,"closeSlider");l.css({zIndex:g?v.zIndex.sliding:v.zIndex.pane_normal});n.css({zIndex:g?v.zIndex.sliding:v.zIndex.resizer_normal});if(k!="click"&&k!="mouseout")k="mouseout";if(g){l.bind(k,pa);n.bind(k,pa);k="mouseout";l.bind("mouseover",h);n.bind("mouseover",h)}else{l.unbind(k);n.unbind(k);k="mouseout";l.unbind("mouseover");n.unbind("mouseover");da(d,"closeSlider")}},xa=function(){var d=b(this).attr("resizer");if(y[d].isClosed){ka(d,true);
V(d,true)}},pa=function(){function d(){ka(h,false);k.isClosed||T(h)}var g=b(this),h=g.attr("pane")||g.attr("resizer");g=p[h];var k=y[h];k.isClosed||k.isResizing||(g.slideTrigger_close=="click"?d():ra(h,"closeSlider",d,300))},ia=function(d,g){var h=v[d].edge,k=v[d].dir,l=p[d],n=y[d],t=B[d],q=O[d];ca(d);n.minSize=C(n.minSize,l.minSize);if(l.maxSize>0)n.maxSize=Math.min(n.maxSize,l.maxSize);g=C(g,n.minSize);g=Math.min(g,n.maxSize);n.size=g;q.css(h,g+z[h]);t.css(v[d].sizeType,C(1,v[d].dir=="horz"?N(d,
g):R(d,g)));n.isSliding||W(k=="horz"?"all":"center");Z();aa(d);L(d,l.onresize_end||l.onresize)},W=function(d,g,h){if(!d||d=="all")d="east,west,center";var k=ma();g&&b.extend(k,g);b.each(d.split(","),function(){if(B[this]){var l=I(this),n=p[l],t=y[l],q=B[l],w=O[l],r=true,x={};if(l=="center"){k=ma();x=b.extend({},k);x.width=C(1,R(l,x.width));x.height=C(1,N(l,x.height));r=x.width>1&&x.height>1;if(b.browser.msie&&(!b.boxModel||b.browser.version<7)){B.north&&B.north.css({width:R(B.north,z.innerWidth)});
B.south&&B.south.css({width:R(B.south,z.innerWidth)})}}else{x.top=k.top;x.bottom=k.bottom;x.height=C(1,N(l,k.height));r=x.height>1}if(r){q.css(x);if(t.noRoom){t.noRoom=false;if(t.isHidden)return;else ea(l,!t.isClosed)}if(!h){aa(l);L(l,n.onresize_end||n.onresize)}}else if(!t.noRoom){t.noRoom=true;if(!t.isHidden)if(h){q.hide();w&&w.hide()}else ga(l)}}})},aa=function(d){if(!d||d=="all")d=v.allPanes;b.each(d.split(","),function(){if(X[this]){var g=I(this),h=p[g].contentIgnoreSelector,k=B[g];g=X[g];var l=
g[0],n=N(k);k.children().each(function(){if(this!=l){var t=b(this);if(!h||!t.is(h))n-=t.outerHeight()}});if(n>0)n=N(g,n);n<1?g.hide():g.css({height:n}).show()}})},Z=function(d,g){if(!d||d=="all")d=v.borderPanes;b.each(d.split(","),function(){var h=I(this),k=p[h],l=y[h],n=B[h],t=O[h],q=Y[h];if(!(!n||!t||!k.resizable&&!k.closable)){var w=v[h].dir,r=l.isClosed?"_closed":"_open";h=k["spacing"+r];var x=k["togglerAlign"+r];r=k["togglerLength"+r];var A;if(h==0)t.hide();else{!l.noRoom&&!l.isHidden&&t.show();
if(w=="horz"){A=n.outerWidth();t.css({width:C(1,R(t,A)),height:C(1,N(t,h)),left:Q(n,"left")})}else{A=n.outerHeight();t.css({height:C(1,N(t,A)),width:C(1,R(t,h)),top:z.top+S("north",true)})}if(q){if(r==0||l.isSliding&&k.hideTogglerOnSlide){q.hide();return}else q.show();if(!(r>0)||r=="100%"||r>A){r=A;n=0}else if(typeof x=="string")switch(x){case "top":case "left":n=0;break;case "bottom":case "right":n=A-r;break;default:n=Math.floor((A-r)/2)}else{n=parseInt(x);n=x>=0?n:A-r+n}A=k.togglerContent_open?
q.children(".content-open"):false;var G=k.togglerContent_closed?q.children(".content-closed"):false;x=l.isClosed?G:A;if(A)A.css("display",l.isClosed?"none":"block");if(G)G.css("display",l.isClosed?"block":"none");if(w=="horz"){l=R(q,r);q.css({width:C(0,l),height:C(1,N(q,h)),left:n});x&&x.css("marginLeft",Math.floor((l-x.outerWidth())/2))}else{l=N(q,r);q.css({height:C(0,l),width:C(1,R(q,h)),top:n});x&&x.css("marginTop",Math.floor((l-x.outerHeight())/2))}}if(g&&k.initHidden){t.hide();q&&q.hide()}}}})},
qa=function(){var d=z.innerWidth,g=z.innerHeight;z=y.container=na(M);var h=z.innerHeight<g,k=z.innerWidth<d,l,n;if(h||k)b.each(["south","north","east","west"],function(t,q){l=y[q];n=v[q].dir;if(!l.isClosed&&(h&&n=="horz"||k&&n=="vert")){ca(q);l.size>l.maxSize&&ia(q,l.maxSize)}});W("all");Z("all")},M=b(this).css({overflow:"hidden"}),B={},X={},O={},Y={},v={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},z=y.container;(function(){ua();sa();oa();va();wa();aa("all");if(p.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();b(window).resize(function(){var d="timerLayout_"+y.id;window[d]&&clearTimeout(window[d]);window[d]=null;window[d]=setTimeout(qa,100)})})();return{options:p,state:y,panes:B,toggle:ba,open:V,close:T,hide:ga,show:ea,resizeContent:aa,sizePane:ia,reinitPane:oa,resizeAll:qa,addToggleBtn:function(d,g){var h=
j(d,g,"toggle");if(h)h.attr("title",y[g].isClosed?"Open":"Close").click(function(k){ba(g);k.stopPropagation()})},addOpenBtn:function(d,g){var h=j(d,g,"open");h&&h.attr("title","Open").click(function(k){V(g);k.stopPropagation()})},addCloseBtn:function(d,g){var h=j(d,g,"close");h&&h.attr("title","Close").click(function(k){T(g);k.stopPropagation()})},addPinBtn:function(d,g){var h=j(d,g,"pin");if(h){var k=y[g];h.click(function(l){s(b(this),g,k.isSliding||k.isClosed);k.isSliding||k.isClosed?V(g):T(g);
l.stopPropagation()});s(h,g,!k.isClosed&&!k.isSliding);v[g].pins.push(d)}},allowOverflow:e,resetOverflow:f,cssWidth:R,cssHeight:N}}})(jQuery);
(function(){$.widget("ui.TagView",{_GetTag:function(b,c){var i=this,e=$($.mustache(c,b.tag));e.data("data",b);if(!i.tagMenu){i.tagMenu=e.find(".tag-menu");i.tagMenu.hide()}e.find(".tag-menu").remove();e.find(".color-selector").bind("click",function(f){var j=i.tagMenu;f=$(f.target);var m=f.parent(".tag").data("data");if(j.data("visible")===true&&j.data("tagId")===b.tag.id){j.hide("fast");j.data("visible",false);j.data("tagId",null);j.data("tag",null);j.data("target",null)}else{j.show("fast");j.css({left:e.position().left,
top:e.position().top-100});j.data("visible",true);j.data("tagId",m.tag.id);j.data("tag",m);j.data("target",f)}return false});ListKungFu&&ListKungFu.LayoutWest&&e.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};i._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});e.bind("click",function(){var f=e.data("data");if(e.data("selected")){i._RemoveSelectedTag(f.tag.id);
e.removeClass("tag-selected");e.data("selected",false)}else{i._AddSelectedTag(f.tag.id);e.addClass("tag-selected");e.data("selected",true)}i._trigger("TagSelected",0,i.selectedTags);return false});return e},_AddSelectedTag:function(b){this.selectedTags.push(b);this.selectedTags=jQuery.unique(widget.selectedTags)},_RemoveSelectedTag:function(b){for(var c=[],i=0;i<this.selectedTags.length;i++)this.selectedTags[i]!==b&&c.push(this.selectedTags[i]);this.selectedTags=c},_CreateToolbar:function(){widget.tagList.append(widget.tagMenu);
widget.tagMenu.find(".color").bind("click",function(b){var c=$(b.target).attr("data-colorclass");b=widget.tagMenu.data("tag");var i=b.tag.color_class,e=widget.tagMenu.data("target");b.tag.color_class=c;Tag.Update({send:b,successCallback:function(f,j){widget._trigger("AfterColorChanged",0,{});e.parent(".tag").removeClass(i);e.parent(".tag").addClass(c);e.removeClass(i);e.addClass(c);widget.tagMenu.hide("fast");widget.tagMenu.data("visible",false);widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",
null);widget.tagMenu.data("target",null);e.data("data",j)},tags:b.tag.id})});widget.tagMenu.find(".delete-label").bind("click",function(){widget.tagMenu.hide("fast");widget.tagMenu.data("visible",false);var b=function(){widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",null);widget.tagMenu.data("target",null)},c=function(){var i=widget.tagMenu.data("tag"),e=widget.tagMenu.data("target");Tag.Destroy({successCallback:function(){widget._trigger("AfterTagDeleted",0,{});e.hide("fast",function(){e.parent(".tag").remove();
widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",null);widget.tagMenu.data("target",null)})},tags:i.tag.id})};if(typeof widget.deleteDialog==="undefined")widget.deleteDialog=$.confirmationDialog("Delete Tag",c,"Cancel","Delete Tag and remove it from all lists?",b);widget.deleteDialog.dialog("open");return false})},_create:function(){widget=this;widget.header=$('<h1 id="tags-header">Notebook Tags</h1>');widget.toolbar=$('<div id="tag-toolbar"></div>');widget.addTagInput=$('<input type="text" value="" id="add-tag"/>');
widget.addTagButton=$('<button id="tag-new">Create Tag</button>');widget.tagList=$('<div class="tags"></div>');widget.element.append(widget.header);widget.element.append(widget.toolbar);widget.toolbar.append(widget.addTagInput);widget.toolbar.append(widget.addTagButton);widget.element.append(widget.tagList);widget.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});widget.selectedTags=[];Tag.Index({successCallback:function(b,c){for(var i=0;i<c.length;i++)widget.tagList.append(widget._GetTag(c[i],
b));widget.tagMenu&&widget._CreateToolbar()}});widget.addTagButton.bind("click",function(){if($.trim(widget.addTagInput.val())!==""&&widget.tagList.find(".tag-name:HasExactValue('"+$.trim(widget.addTagInput.val())+"')").length===0){var b={};b.tag={name:widget.addTagInput.val(),color_class:"c1"};Tag.Create({send:b,successCallback:function(c,i){var e=widget._GetTag(i,c);widget.tagList.prepend(e);widget.addTagInput.val("");widget.addTagInput.trigger("keyup");widget.tagMenu&&widget._CreateToolbar()}});
return false}});widget.addTagInput.bind("keyup","return",function(){widget.addTagButton.trigger("click")});widget.addTagInput.bind("keyup",function(){var b=$(this).val();if(b==="")widget.tagList.find(".tag").show();else{widget.tagList.find(".tag:not(:Contains('"+b+"'))").hide();widget.tagList.find(".tag:Contains('"+b+"')").show()}widget.tagList.find(".tag-name:HasExactValue('"+$.trim(b)+"')").length>0?widget.addTagButton.button("option","disabled",true):widget.addTagButton.button("option","disabled",
false)})},options:{},destroy:function(){widget.element.children().remove()}})})();
(function(){$.widget("ui.UltimateSearch",{_create:function(){var b=this;b.searchText=$('<div><input type="text" id="ultimate-search-text"/><span id="ultimate-search-text-cancel"></span></div>');b.searchOptions=$('<div id="searchOptions"><input type="checkbox" id="searchLists" class="searchOptionCheckbox" checked /><label for="searchLists" class="searchOptionLabel">Search List</label><input type="checkbox" id="searchDashboard" class="searchOptionCheckbox" checked /><label for="searchDashboard" class="searchOptionLabel">Search Dashboard</label><input type="checkbox" id="searchListItems" class="searchOptionCheckbox" checked /><label for="searchListItems" class="searchOptionLabel">Search List Items</label></div>');b.element.append(b.searchText);
b.element.append(b.searchOptions);$(document).bind("keyup","ctrl+f",function(){b.searchText.focus()});$(document).bind("keyup","shift+f",function(){b.searchText.focus()});b.searchText.bind("keyup",function(c){c=$(c.target).val();b._trigger("OnFilterChanged",0,{searchOptions:{searchLists:b.searchOptions.find("#searchLists:checked").length>0?true:false,searchListItems:b.searchOptions.find("#searchListItems:checked").length>0?true:false,searchDashboard:b.searchOptions.find("#searchDashboard:checked").length>
0?true:false},searchText:c})});b.searchText.find("#ultimate-search-text-cancel").bind("click",function(){b.searchText.find("#ultimate-search-text").val("").trigger("keyup")});b.searchText.bind("keyup","enter",function(){b.searchText.find("#ultimate-search-text").trigger("keyup")})},_init:function(){},options:{},destroy:function(){}})})();
