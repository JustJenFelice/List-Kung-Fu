var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};ListKungFu.TinyMceInitAutoFocus=function(b){tinyMCE.execCommand("mceFocus",false,b.editorId)};
ListKungFu.TinyMCEDefaultOptions={theme:"advanced",plugins:"style,table,advhr,advimage,advlink,inlinepopups,searchreplace,print,contextmenu,paste,fullscreen,noneditable,nonbreaking,xhtmlxtras",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect,fontselect,fontsizeselect",theme_advanced_buttons2:"cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,code,|,forecolor,backcolor",
theme_advanced_buttons3:"tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,cite,abbr,acronym|,advhr,|,print,|,fullscreen",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:false,init_instance_callback:ListKungFu.TinyMceInitAutoFocus,width:"100%",setup:function(b){var c=false;b.onKeyUp.add(function(e,g){if(g.keyCode===18)return c=false});b.onKeyDown.add(function(e,g){if(g.keyCode===27){ListKungFu.LayoutCenter.ListItemView("CloseEditor");
return false}if(g.keyCode===18){c=true;return false}if(c===true&&g.keyCode===83){g.preventDefault();ListKungFu.LayoutCenter.ListItemView("FocusElement","saveButton");return false}})}};jQuery.expr[":"].Contains=function(b,c,e){return jQuery(b).text().toLowerCase().indexOf(e[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(b,c,e){return jQuery.trim(jQuery(b).text().toLowerCase())===e[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:72,minSize:72},south:{minSize:30},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(b,c){ListKungFu.LayoutWest.ListView("SetupDroppable",c.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(b,c){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",c.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(b,c){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",c.selectedList)},OpenListItem:function(b,c){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemShow({listItem:c.selectedListItem})}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(b,
c){ListKungFu.LayoutWest.ListView("SetupDroppable",c.dragType)},AfterColorChanged:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},AfterTagDeleted:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},TagSelected:function(b,c){ListKungFu.LayoutWest.ListView("Filter",c,null)}});ListKungFu.LayoutNorth.find("#ultimate-search-widget").UltimateSearch({OnFilterChanged:function(b,c){var e=c.searchOptions.searchLists,g=c.searchOptions.searchListItems;c.searchOptions.searchDashboard&&ListKungFu.LayoutCenter.Dashboard("Filter",
c.searchText);e&&ListKungFu.LayoutWest.ListView("Filter",null,c.searchText);g&&ListKungFu.LayoutCenter.ListItemView("Filter",c.searchText)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(b){var c={};c.ClearFlash=function(){c.flash={notice:"",error:"",warning:"",message:""}};c.ClearFlash();c.SetFlash=function(e){if(e&&!e.cachedAt){c.flash.notice=e.getResponseHeader("X-Flash-Notice")||"";c.flash.error=e.getResponseHeader("X-Flash-Error")||"";c.flash.warning=e.getResponseHeader("X-Flash-Warning")||"";c.flash.message=e.getResponseHeader("X-Flash-Message")||""}if(typeof b.onFlashUpdate==="function")if(c.flash.notice!==""||c.flash.error!==""||c.flash.warning!==""||
c.flash.message!=="")b.onFlashUpdate(c.flash.notice,c.flash.error,c.flash.warning,c.flash.message)};c.baseURL=b.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";c.route=b.route;c.DefaultCallback=function(e,g,f,j){c.SetFlash(j);var m=g.data,y="";if(g.template&&$.trim(g.template)!=="")y=$("#"+g.template).html();g=g.errors;if(!$.isArray(m))for(var x in m){m[x].isSaved=m[x].id&&m[x].id!==null?true:false;m[x].isNew=m[x].id&&
m[x].id!==null?false:true}typeof e==="function"&&e(y,m,f,j,g);c.ClearFlash()};c.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};c.ConstructRoute=function(e){for(var g="",f="",j=0;j<
c.route.length;j++){g+=c.route[j];f=e[c.route[j]]||"";if(f!=="")g+="/"+f;if(j!==c.route.length-1)g+="/"}return g};c.Index=function(e){var g=e.successCallback||null,f=c.ConstructRoute(e);jQuery.retrieveJSON(c.baseURL+f,e.send||{},function(j,m,y){c.DefaultCallback(g,j,m,y)},c.DefaultErrorCallback)};c.Show=function(e){var g=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e,dataType:"json",type:"GET",processData:false,contentType:"application/json",beforeSend:function(f){f.setRequestHeader("X-CSRF-Token",
$('meta[name="csrf-token"]').attr("content"))},success:function(f,j,m){c.DefaultCallback(g,f,j,m)},error:function(f,j,m){c.DefaultErrorCallback(f,j,m)}})};c.New=function(e){var g=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e+"/new",dataType:"json",type:"GET",processData:false,contentType:"application/json",beforeSend:function(f){f.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},success:function(f,j,m){c.DefaultCallback(g,f,j,m)},error:function(f,
j,m){c.DefaultErrorCallback(f,j,m)}})};c.Create=function(e){var g=e.successCallback||null,f=c.ConstructRoute(e);e=JSON.stringify(e.send);$.ajax({url:c.baseURL+f,dataType:"json",type:"POST",processData:false,contentType:"application/json",data:e,beforeSend:function(j){j.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},success:function(j,m,y){c.DefaultCallback(g,j,m,y)},error:function(j,m,y){c.DefaultErrorCallback(j,m,y)}})};c.Edit=function(e){var g=e.successCallback||
null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e+"/edit",dataType:"json",type:"GET",parseData:false,contentType:"application/json",beforeSend:function(f){f.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},success:function(f,j,m){c.DefaultCallback(g,f,j,m)},error:function(f,j,m){c.DefaultErrorCallback(f,j,m)}})};c.Update=function(e){var g=e.successCallback||null,f=c.ConstructRoute(e);e=JSON.stringify(e.send);e=e.replace(/\\u000a/g,"\\n");$.ajax({url:c.baseURL+f,dataType:"json",
type:"POST",processData:false,contentType:"application/json",data:e,beforeSend:function(j){j.setRequestHeader("X-Http-Method-Override","PUT");j.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},success:function(j,m,y){c.DefaultCallback(g,j,m,y)},error:function(j,m,y){c.DefaultErrorCallback(j,m,y)}})};c.Destroy=function(e){var g=e.successCallback||null;e=c.ConstructRoute(e);$.ajax({url:c.baseURL+e,dataType:"json",type:"POST",processData:false,contentType:"application/json",
beforeSend:function(f){f.setRequestHeader("X-Http-Method-Override","DELETE");f.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},success:function(f,j,m){c.DefaultCallback(g,f,j,m)},error:function(f,j,m){c.DefaultErrorCallback(f,j,m)}})};return c},List=Controller({route:["lists"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),ListListItem=Controller({route:["lists","list_items"],onFlashUpdate:function(b,
c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(b,c){ListKungFu.LayoutSouth.StatusBar("SetAlert",c);ListKungFu.LayoutSouth.StatusBar("SetNotice",b)}});
jQuery(function(b){var c=b("meta[name=csrf-token]").attr("content"),e=b("meta[name=csrf-param]").attr("content");b.fn.extend({triggerAndReturn:function(f,j){var m=new b.Event(f);this.trigger(m,j);return m.result!==false},callRemote:function(){var f=this,j=f.attr("method")||f.attr("data-method")||"GET",m=f.attr("action")||f.attr("href"),y=f.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(f.triggerAndReturn("ajax:before")){var x=
f.is("form")?f.serializeArray():[];b.ajax({url:m,data:x,dataType:y,type:j.toUpperCase(),beforeSend:function(n){f.trigger("ajax:loading",n)},success:function(n,C,w){f.trigger("ajax:success",[n,C,w])},complete:function(n){f.trigger("ajax:complete",n)},error:function(n,C,w){f.trigger("ajax:failure",[n,C,w])}})}f.trigger("ajax:after")}}});b("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var f=b(this);if(f.triggerAndReturn("confirm"))if(!confirm(f.attr("data-confirm")))return false});
b("form[data-remote]").live("submit.rails",function(f){b(this).callRemote();f.preventDefault()});b("a[data-remote],input[data-remote]").live("click.rails",function(f){b(this).callRemote();f.preventDefault()});b("a[data-method]:not([data-remote])").live("click.rails",function(f){var j=b(this),m=j.attr("href");j=j.attr("data-method");m=b('<form method="post" action="'+m+'"></form>');j='<input name="_method" value="'+j+'" type="hidden" />';if(e!==undefined&&c!==undefined)j+='<input name="'+e+'" value="'+
c+'" type="hidden" />';m.hide().append(j).appendTo("body");f.preventDefault();m.submit()});var g=function(){b(this).find("input[data-disable-with]").each(function(){var f=b(this);f.data("enable-with",f.val()).attr("value",f.attr("data-disable-with")).attr("disabled","disabled")})};b("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",g);b("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",g);b("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){b(this).find("input[data-disable-with]").each(function(){var f=b(this);f.removeAttr("disabled").val(f.data("enable-with"))})});g=b().jquery;if(g==="1.4"||g==="1.4.1"||g==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(b){b.confirmationDialog=function(c,e,g,f,j){dialog=b('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+f+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});f={};f[c]=function(){b(dialog).dialog("close");e()};f[g]=function(){b(dialog).dialog("close");typeof j==="function"&&j()};dialog.dialog("option","buttons",
f);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","right",function(m){m=b(m.target);if(m.next("button").length>0){m.blur();m.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(m){m=b(m.target);if(m.prev("button").length>0){m.blur();m.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){$.widget("ui.Dashboard",{_ClearDashboard:function(){this.today.find(".data-schedule-column").children().remove();this.tomorrow.find(".data-schedule-column").children().remove();this.thisweek.find(".data-schedule-column").children().remove();this.nextweek.find(".data-schedule-column").children().remove();this.later.find(".data-schedule-column").children().remove()},_InitCategories:function(){this.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn" class="data-schedule-column"></div></div>');
this.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn" class="data-schedule-column"></div></div>');this.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn" class="data-schedule-column"></div></div>');this.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn" class="data-schedule-column"></div></div>');this.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn" class="data-schedule-column"></div></div>')},
_TriggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_NothingToDoText:function(){return'<p class="nothing-todo">no items scheduled</p>'},_TriggerReinitOfPanes:function(){this._trigger("ReinitPanes",0,{})},_SetupCustomDeadlinePicker:function(b){var c=this,e=$(this),g=b.find(".dashboard-list-item-deadline-hidden"),f=b.data("data"),j=f.list_item.deadline_date.split("-"),m=j[0],y=j[1],x=j[2];g.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",beforeShow:function(n,C){C.input.datepicker("setDate",
m+","+y+","+x)},onSelect:function(n){f.list_item.deadlineType="customdeadline";f.list_item.customDeadlineValue=n;f.list_item.template="dashboard";ListListItem.Update({successCallback:function(C,w){var F=b.parent();b.hide("slow",function(){b.remove();F.find(".dashboard-item").length===0&&F.append(c._NothingToDoText())});c._CreateDashboardItem(w,C,{highlightCategory:true,addType:"prepend"})},lists:f.list_item.list_id,list_items:f.list_item.id,send:f});e.datepicker("hide")}})},_AppendToDashboard:function(b,
c,e){e=e||{};b.find(".nothing-todo").remove();e.addType==="prepend"?b.find("div[data-type=scheduleColumn]").first().prepend(c):b.find("div[data-type=scheduleColumn]").first().append(c);e.highlightCategory===true&&c.effect("highlight",{},2E3)},_CreateDashboardItem:function(b,c,e){var g=this,f=$($.mustache(c,b.list_item));switch(b.list_item.deadline_category){case "today":g._AppendToDashboard(g.today,f,e);break;case "tomorrow":g._AppendToDashboard(g.tomorrow,f,e);break;case "this week":g._AppendToDashboard(g.thisweek,
f,e);break;case "next week":g._AppendToDashboard(g.nextweek,f,e);break;default:g._AppendToDashboard(g.later,f,e)}f.data("data",b);f.find(".dashboard-list-item-title").bind("click",function(){g._trigger("OpenList",0,{selectedList:b.list_item})});f.find(".dashboard-item-more").bind("click",function(){g._trigger("OpenList",0,{selectedList:b.list_item})});f.find(".full-content").bind("dblclick",function(){g._trigger("OpenListItem",0,{selectedListItem:b})});f.find(".shortend-content").bind("dblclick",
function(){g._trigger("OpenListItem",0,{selectedListItem:b})});f.find(".full-content").bind("click",function(){$(this).hide();f.find(".shortend-content").show()});f.find(".shortend-content").bind("click",function(){$(this).hide();f.find(".full-content").show()});f.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var j=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');
$that.append(j);$that.animate({width:"100%",paddingLeft:"14px"},200);j.find(".yes").bind("click",function(){b.list_item.completed=true;ListListItem.Update({successCallback:function(){f.stop(true,true).hide("slow",function(){f.remove()})},lists:b.list_item.list_id,list_items:b.list_item.id,send:b});j.find(".no").trigger("click");return false});j.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){j.remove()});return false})});f.find(".dashboard-item-more").bind("click",
function(){g._trigger("OpenList",0,{selectedList:b.list_item})});g._SetupCustomDeadlinePicker(f);f.find(".dashboard-list-item-deadline").bind("click",function(){f.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});return f},_Filter:function(){var b=this.selectedText;if(b==="")this.wrapper.find(".dashboard-item").show();else{this.wrapper.find(".dashboard-item:not(:Contains('"+b+"'))").hide();this.wrapper.find(".dashboard-item:Contains('"+
b+"')").show()}},_create:function(){},options:{},Show:function(){var b=this;b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b._InitCategories();b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');
ListItem.Index({successCallback:function(c,e,g){g==="success"&&b._ClearDashboard();$.each(e,function(f,j){b._CreateDashboardItem(j,c)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append(b._NothingToDoText())});b._TriggerReinitOfPanes();b._TriggerResize()},send:{show:"dashboard"}})},Hide:function(){this.element.children().remove()},destroy:function(){},Filter:function(b){this.selectedText=b;this._Filter()}})})();
(function(b){function c(e){if(typeof e.data==="string"){var g=e.handler,f=e.data.toLowerCase().split(" ");e.handler=function(j){if(!(this!==j.target&&(/textarea|select/i.test(j.target.nodeName)||j.target.type==="text"))){var m=j.type!=="keypress"&&b.hotkeys.specialKeys[j.which],y=String.fromCharCode(j.which).toLowerCase(),x="",n={};if(j.altKey&&m!=="alt")x+="alt+";if(j.ctrlKey&&m!=="ctrl")x+="ctrl+";if(j.metaKey&&!j.ctrlKey&&m!=="meta")x+="meta+";if(j.shiftKey&&m!=="shift")x+="shift+";if(m)n[x+m]=
true;else{n[x+y]=true;n[x+b.hotkeys.shiftNums[y]]=true;if(x==="shift+")n[b.hotkeys.shiftNums[y]]=true}m=0;for(y=f.length;m<y;m++)if(n[f[m]])return g.apply(this,arguments)}}}}b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:c}})})(jQuery);
(function(){$.widget("ui.ListItemView",{_SetSelectedListItem:function(b,c){this.selectedListItem={element:b,data:c}},_Filter:function(){var b=this.selectedText;if(b==="")this.listItemList.find(".row").show();else{this.listItemList.find(".row:not(:Contains('"+b+"'))").hide();this.listItemList.find(".row:Contains('"+b+"')").show()}},_SetupDeadlineButton:function(b){var c=b.find("#deadline-settings-wrapper"),e=b.find("#save-deadline");e.bind("click keydown","return",function(){e.data("settings-visible")?
c.hide("fast",function(){c.find(".deadline-button").first();e.data("settings-visible",false)}):c.show("fast",function(){c.find(".deadline-button").first().focus();e.data("settings-visible",true)});return false})},_SetupCustomDeadlinePicker:function(){$("#custom-deadline-display").datepicker({minDate:new Date,altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",
new Date))},_TriggerReinitOfPanes:function(){this._trigger("ReinitPanes",0,{})},_TriggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_AddListItem:function(b,c,e){var g=this,f=$($.mustache(c,b.list_item));f.data("data",b);e?g.listItemList.prepend(f):g.listItemList.append(f);f.find(".handle").height(f.height());f.bind("keyup","space",function(){g.toolbar.find("#list-item-completed").effect("puff",{},300,function(){$(this).show();f.find(".undo").length===0?g.toolbar.find("#list-item-completed").trigger("click"):
f.find(".undo").trigger("click")});return false});f.bind("keydown","del",function(){g.toolbar.find("#list-item-delete").effect("puff",{},300,function(){$(this).show();g.toolbar.find("#list-item-delete").trigger("click")});return false});f.bind("focus",function(j){if($(j.target).hasClass("row")){g.listItemList.find(".row").removeClass("selected-row");$(j.target).addClass("selected-row");var m=$(j.target).data("data");g._SetSelectedListItem($(j.target),m)}});if($.browser.msie){f.get(0).onselectstart=
function(){return false};f.bind("click",function(){f.focus();return false})}f.bind("keydown","down",function(j){j.preventDefault();$(j.target).nextAll("div:visible").first().focus();return false});f.bind("keydown","up",function(j){j.preventDefault();$(j.target).prevAll("div:visible").first().focus();return false});f.bind("keydown","e",function(){f.trigger("edit")});f.bind("beforeEdit",function(){g.listItemList.find(".row").hide();g.selectedListItem.element.show();g.selectedListItem.element.find(".list-item-content").hide();
g.selectedListItem.element.find(".list-item-info").hide();g.selectedListItem.element.removeClass("selected-row");g.selectedListItem.element.find(".handle").hide()});f.bind("afterEdit",function(j,m){g.selectedListItem.element.find(".handle").show();if(m){f.find(".list-item-content").html(m.list_item.body_shortend);f.find(".list-item-deadline").html(m.list_item.deadline_in_words);g._SetSelectedListItem(f,m);f.data("data",m)}f.find(".handle").height(f.find(".list-item-content").height());f.find(".list-item-content").show();
f.find(".list-item-info").show();g._Filter();g._CorrectHeight(f);f.focus()});f.bind("edit",function(){if(f.find("form").length>0)return false;g.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});g.listItemList.find(".row").ListItemEdit("destroy");g.selectedListItem&&g.selectedListItem.element.ListItemEdit({height:g.element.find("#list-item-wrapper").height()-110,listId:g.selectedListItem.data.list_item.list_id,listItemId:g.selectedListItem.data.list_item.id})});f.bind("keydown",
"left",function(){g._trigger("SelectLastList",0,{})});f.bind("keydown","shift+return",function(){g.toolbar.find("#list-item-new").effect("puff",{},300,function(){$(this).show();g._AddNewListItem()})});f.bind("keydown","return",function(){f.trigger("show");return false});f.bind("dblclick",function(){f.trigger("show");return false});f.bind("show",function(){var j=g.element,m=g.selectedListItem.data;g.RemoveList();j.ListItemShow({listItem:m})});ListKungFu&&ListKungFu.LayoutCenter&&f.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+
f.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};g._trigger("StartedDraggingListItem",0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});g._CorrectHeight(f)},_CorrectHeight:function(b){b.height()>150?b.height(150):b.height("auto");this._TriggerResize()},_DeleteListItem:function(b,
c){ListListItem.Destroy({successCallback:function(){b.hide("slow",function(){var e=b.next(".row");e.length>0||(e=b.prev(".row"));e.focus();b.remove()})},lists:c.list_item.list_id,list_items:c.list_item.id})},_MarkCompleted:function(b,c){var e=this;c.list_item.completed=true;ListListItem.Update({successCallback:function(){var g="list-item-undo-"+c.list_item.id;b.find(".list-item-wrapper").hide("slow",function(){var f=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');f.bind("click",
function(){e._MarkUncompleted(b,c,g)});b.append(f);e._CorrectHeight(b);f.delay(5E3,g).queue(g,function(){b.hide("slow",function(){b.remove()})}).dequeue(g);e.toolbar&&e.toolbar.find("#showCompleted").get(0).checked===true&&e._ToggleCompleted(true);b.focus()})},lists:c.list_item.list_id,list_items:c.list_item.id,send:c})},_MarkUncompleted:function(b,c,e){var g=this;e!==""&&b.clearQueue(e);c.list_item.completed=false;ListListItem.Update({successCallback:function(){b.find(".undo").hide("slow",function(){$(this).remove()});
b.find(".list-item-wrapper").show("slow",function(){g._CorrectHeight(b)});g.toolbar&&g.toolbar.find("#showCompleted").get(0).checked===true&&g._ToggleCompleted(true);g._Filter()},lists:c.list_item.list_id,list_items:c.list_item.id,send:c})},_ToggleCompleted:function(b){var c=this;if(b===true){if(c.completedList){c.completedList.remove();c.completedList=null}c.completedList=$('<div id="completedList"></div>');b=c.element.data("data-list");ListListItem.Index({successCallback:function(e,g){$.each(g,
function(f,j){c.completedList.append("<div>"+j.list_item.body_shortend+"</div>")});g.length===0&&c.completedList.append("<div>No completed items</div>");c.wrapper.prepend(c.completedList)},send:{show:"completed"},lists:b.list.id})}else{c.completedList.remove();c.completedList=null}},_CreateToolbar:function(){var b=this;b.header.html("");b.toolbar=$('<div id="list-item-toolbar"><div id="list-title"></div><div id="list-item-toolbar-buttons"><button id="list-item-completed">Completed [space]</button><button id="list-item-new">Create [shift+return]</button><button id="list-item-delete">Delete [del]</button><button id="list-item-edit">Edit [return]</button><input type="checkbox" id="showCompleted"/><label for="showCompleted">Show Completed Items</label></div></div>');
b.listName=b.toolbar.find("#list-title");b.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});b.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.toolbar.find("#list-item-new").bind("click",function(){b._AddNewListItem()});b.toolbar.find("#showCompleted").bind("change",
function(c){b._ToggleCompleted(c.target.checked);b.selectedListItem&&b.selectedListItem.element.focus()});b.toolbar.find("#list-item-completed").bind("click",function(){b._MarkCompleted(b.selectedListItem.element,b.selectedListItem.data)});b.toolbar.find("#list-item-delete").bind("click",function(){var c=function(){b._DeleteListItem(b.selectedListItem.element,b.selectedListItem.data)};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List Item",c,"Cancel","Do you really want to delete?");
b.deleteDialog.dialog("open")});b.toolbar.find("#list-item-edit").bind("click",function(){b.selectedListItem&&b.selectedListItem.element.trigger("edit")});b.header.append(b.toolbar)},_AddNewListItem:function(){var b=this,c=b.element.data("data-list");if(b.listItemList.find("#new_list_item").length>0)return false;ListListItem.New({successCallback:function(e,g){if($.browser.msie&&b.listItemList.find("#new_list_item").length>0)return false;var f=$($.mustache(e,g.list_item));b.listItemList.prepend(f);
b._SetupDeadlineButton(f);b._SetupCustomDeadlinePicker();var j=ListKungFu.TinyMCEDefaultOptions;j.height=b.listItemList.parent("#list-item-wrapper").height()-150;f.find("textarea.editorarea").tinymce(j);b.listItemList.find(".row").hide();f.find("#cancel-edit").bind("click",function(m){m.preventDefault();f.hide("slow",function(){$(this).remove();b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();$.browser.msie&&b.listItemList.find(".row").first().click()})});f.find(".deadline-button").bind("click",
function(m){m.preventDefault();var y=f.serializeForm();y.list_item.deadlineType=$(m.target).attr("data-deadline");y.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:y,successCallback:function(x,n){f.hide("slow",function(){b._AddListItem(n,x,true);$(this).remove();b.toolbar.find("#list-item-search").trigger("ClearValue");b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();b.listItemList.find(".row").first().find(".handle").height(b.listItemList.find(".row").first().find(".list-item-content").height())})},
lists:c.list.id});return false})},lists:c.list.id})},_create:function(){var b=this;b.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');b.listItemList=$('<div id="list-item-list"></div>');b.header=$('<div class="list-item-header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.listItemList);b.selectedText="";b._TriggerResize();$(document).bind("keydown","c",function(){var c=b.toolbar.find("#showCompleted");if(c.length>0){if(c.get(0).checked===
true)c.get(0).checked=false;else c.get(0).checked=true;c.trigger("change")}});$(document).bind("keyup","f",function(){b.toolbar.find("#list-item-search").focus()})},options:{},RemoveList:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")},destroy:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")},OpenList:function(b){var c=this;ListListItem.Index({successCallback:function(e,g){c.RemoveList();c.element.ListItemShow("destroy");
c._create();c.element.data("data-list",b);c.selectedListItem=null;c._CreateToolbar();$.each(g,function(f,j){c._AddListItem(j,e)});b.id&&c.listItemList.find(".row").each(function(){var f=$(this);if(f.data("data").list_item.id===b.id){f.focus();return false}});c.listItemList.find(".row").length===0&&c._AddNewListItem();c.listName.text(b.list.title);c._TriggerReinitOfPanes()},lists:b.list.id})},SelectListItem:function(){this.selectedListItem?this.selectedListItem.element.effect("highlight",{},300).focus():
this.listItemList.find(".row").first().effect("highlight",{},300).focus()},Filter:function(b){this.selectedText=b;this._Filter()},FocusElement:function(b){switch(b){case "saveButton":$("#save-whenever").focus();$("#keepit").focus()}},CloseEditor:function(){$("#cancel-edit").click()}})})();
(function(){$.widget("ui.ListView",{_ReplaceList:function(b,c,e){c=this._GetListElement(c,e);b.replaceWith(c);this._AdjustHeight();this._triggerResize();c.focus()},_DroppableConfigTags:function(){var b=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(c,e){var g=$(this);if(g.position().top<b.wrapper.height()){var f=e.draggable.data("data"),j=g.data("data");j.list.tag_id=f.tag.id;List.Update({send:j,successCallback:function(m,y){b._ReplaceList(g,y,m)},
lists:j.list.id})}}}},_DroppableConfigListItems:function(b){var c=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(e,g){if($(this).position().top<c.wrapper.height()){var f=g.draggable.data("data"),j=$(this).data("data");ListListItem.Create({send:f,successCallback:function(){$(e.target).find(".fake-drop").remove();$(e.target).find(".list-name").show();$(e.target).find(".list-tag").show();b.effect("highlight",{},3E3)},lists:j.list.id})}},over:function(e,
g){$(e.target).find(".list-name").hide();$(e.target).find(".list-tag").hide();var f=$('<div class="fake-drop"></div>');f.html("<p>"+g.helper.text()+"</p>");$(e.target).append(f)},out:function(e){$(e.target).find(".fake-drop").remove();$(e.target).find(".list-name").show();$(e.target).find(".list-tag").show()}}},_IsNewList:function(b){return this.selectedList===null||this.selectedList.data.list.id!==b.list.id?true:false},_HighlightFormErrors:function(b,c){for(var e in c){for(var g=c[e],f=$('<div class="error_explanation"><ul></ul></div>'),
j=f.find("ul"),m=$('*[name*="'+e+'"]'),y=0;y<g.length;y++){m.parent(".field").addClass("field_with_errors");j.append("<li>"+g[y]+"</li>")}m.parent(".field").append(f)}},_ClearFormErrors:function(b){b.find(".field").removeClass("field_with_errors");b.find(".error_explanation").remove()},_DeleteList:function(b){var c=this,e=c.selectedList.element.next(),g=c.selectedList.element.prev();b=b||0;List.Destroy({successCallback:function(){c.selectedList.element.delay(b).fadeOut(function(){$(this).remove();
e.length>0?e.focus():g.focus();c._ToggleEmptyListImage()});c._trigger("CloseList",0,{})},lists:c.selectedList.data.list.id})},_CreateToolbar:function(){var b=this,c=$('<div id="list-toolbar"><button id="list-new">Create [shift+return]</button><button id="list-delete">Delete [del]</button><button id="list-edit">Edit [space]</button></div>');b.element.find("div.header").append(c);c.find("#list-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});c.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});
c.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});c.find("#list-delete").bind("click",function(e){if(b.selectedList!==null){if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List",function(){if(b.listForm!==null){b.listForm.bind("FormHidden",function(){b._DeleteList(1E3)});b._HideForm()}else b._DeleteList()},"Cancel","Do you really want to delete?");b.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();
$(e.target).blur();return false});c.find("#list-new").bind("click",function(e){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.New({successCallback:function(g,f){b.emptyListImage.hide();b.listForm.append($.mustache(g,f.list));b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});
b._trigger("CloseList",0,{});b.listForm.find("#list-back-button").bind("click",function(){b._HideForm()});b.listForm.find("#list_title").bind("keydown","esc",function(){b._HideForm()});b.listForm.bind("submit",function(j){j.preventDefault();j=$(this).find("form").serializeForm();f.list=j.list;List.Create({send:f,successCallback:function(m,y,x,n,C){b._ClearFormErrors(b.listForm);C===false?b._HideForm(y,m):b._HighlightFormErrors(b.listForm,C)}});return false});b.selectedList=null}})});$(e.target).blur();
return false});c.find("#list-edit").bind("click",function(){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.Edit({successCallback:function(e,g){b.listForm.append($($.mustache(e,g.list)));b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b.listForm.find("#list-back-button").bind("click",
function(){b._HideForm();return false});b.listForm.find("#list_title").bind("keydown","esc",function(){b._HideForm();return false});b.listForm.bind("submit",function(f){f.preventDefault();f=$(this).find("form").serializeForm();List.Update({send:f,successCallback:function(j,m,y,x,n){b._ClearFormErrors(b.listForm);n===false?b._HideForm(m,j):b._HighlightFormErrors(b.listForm,n)},lists:b.selectedList.data.list.id});return false})},lists:b.selectedList.data.list.id})})});return c},_GetListElement:function(b,
c){var e=this,g=$($.mustache(c,b.list));g.attr("tabindex",0);g.data("data",b);g.addClass("row");if($.browser.msie){g.get(0).onselectstart=function(){return false};g.bind("click",function(){g.focus();return false})}g.bind("keydown","down",function(f){f.preventDefault();$(f.target).nextAll("div:visible").first().focus();return false});g.bind("keydown","up",function(f){f.preventDefault();$(f.target).prevAll("div:visible").first().focus();return false});g.bind("focus",function(f){f=$(f.target);e.selectedList=
{element:f,data:f.data("data")};e.listlist.find(".row").removeClass("selected-row");f.addClass("selected-row");e.listlist.find(".assigned-tags").hide();f.find(".assigned-tags").show();e._AdjustHeight()});g.bind("keydown dblclick","return",function(){e._trigger("OpenList",0,{selectedList:g.data("data")})});g.bind("keydown","right",function(){e._trigger("SelectListItem",0,{})});g.bind("keydown","shift+return",function(){e.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});
return false});g.bind("keydown","del",function(){e.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});g.bind("keydown","e",function(){e.toolbar.find("#list-edit").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});g.droppable(e._DroppableConfigListItems(g));g.find(".assigned-tag-delete").bind("click",function(f){var j=$(f.target).parent(".assigned-tag");f=j.attr("data-id");var m=g.data("data");m.list.tag_id=f;m.list.tag_action=
"remove";List.Update({send:m,successCallback:function(y,x){j.hide("slow",function(){j.remove();e._ReplaceList(g,x,y);e._Filter()})},lists:m.list.id})});g.find(".assigned-tags").hide();return g},_triggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_AdjustHeight:function(){this.listlist.find(".row").each(function(){var b=$(this),c=b.find(".list-tag");b=b.find(".list-name");c.height(b.height()+10+"px")})},_AddListToDOM:function(b,c){this.listlist=$('<div id="list-list"></div>');
this.wrapper.append(this.listlist);for(var e=0;e<b.length;e++)this.listlist.append(this._GetListElement(b[e],c));this._AdjustHeight();this._triggerResize()},_SelectLastList:function(){this.selectedList?this.selectedList.element.effect("highlight",{},300).show().focus():this.listlist.find(".row").first().effect("highlight",{},300).show().focus()},_RegisterGlobalKeyboardShortcuts:function(){var b=this;$(document).bind("keydown","ctrl+l",function(){b._SelectLastList()})},_ShowListView:function(b,c){var e=
this;e.listlist.show("slide",{direction:"left"},"slow",function(){if(b){var g=e._GetListElement(b,c);e._IsNewList(b)?e.listlist.prepend(g):e.selectedList.element.replaceWith(g);e._AdjustHeight();e._ToggleEmptyListImage();e.selectedList={data:b,element:g}}e.selectedList&&e.selectedList.element.focus()})},_HideForm:function(b,c){var e=this;e.listForm.hide("slide",{direction:"left"},"slow",function(){e._ShowListView(b,c);e.listForm.trigger("FormHidden");e._ToggleEmptyListImage();e.selectedList?e.selectedList.element.focus():
e.listlist.find(".row").first().focus();e.listForm.remove();e.listForm=null})},_Filter:function(){this._FilterBySearchText();this._FilterByTags()},_FilterBySearchText:function(){var b=this.selectedText;this.listlist.find(".row").show();if(b){this.listlist.find(".row:visible:not(:Contains('"+b+"'))").hide();this.listlist.find(".row:visible:Contains('"+b+"')").show()}this._AdjustHeight();this._triggerResize()},_FilterByTags:function(){var b=this;b.listlist.find(".row:visible").each(function(){var c=
$(this),e=c.data("data"),g=0;if(b.selectedTags.length>0){for(var f=0;f<e.list.tags.length;f++)for(var j=0;j<b.selectedTags.length;j++)b.selectedTags[j]===e.list.tags[f].id&&g++;g===b.selectedTags.length?c.show():c.hide()}})},_create:function(){var b=this;b.selectedList=null;b.wrapper=b.element.find("div#list-wrapper");b.toolbar=b._CreateToolbar();b.listForm=null;b.selectedTags=[];b.emptyListImage=$('<img src="/images/empty/list.jpg"/>');b.emptyListImage.css({position:"absolute",top:"45px",left:"15px"});
b.emptyListImage.hide();b.toolbar.append(b.emptyListImage);List.Index({successCallback:function(c,e){b.wrapper.find(".row").remove();b._AddListToDOM(e,c);b._ToggleEmptyListImage()}});b._RegisterGlobalKeyboardShortcuts()},_ToggleEmptyListImage:function(){if(this.listlist.find(".row").length>0){this.emptyListImage.hide();this.listlist.find(".row").first().focus()}else this.emptyListImage.show()},options:{},SetupDroppable:function(b){var c=this;c.listlist.find(".row").each(function(){var e=$(this);e.droppable("destroy");
switch(b){case "listitem":e.droppable(c._DroppableConfigListItems(e));break;case "tag":e.droppable(c._DroppableConfigTags())}})},ReloadLists:function(){var b=this;List.Index({successCallback:function(c,e){b.wrapper.find(".row").remove();b._AddListToDOM(e,c);b._Filter();b._ToggleEmptyListImage()}})},SelectList:function(){this._SelectLastList()},Filter:function(b,c){if(b)this.selectedTags=b;if(!(c==null||typeof c==="undefined"))this.selectedText=c;this._Filter()},destroy:function(){this.toolbar.remove();
this.listForm.remove();this.wrapper.find(".row").remove()}})})();(function(b){b.fn.serializeForm=function(){var c=b(this).find('*[name*="]"]'),e={};b.each(c,function(g,f){var j=b(f),m=j.get(0).name.split("[")[0],y=j.get(0).name.split("[")[1];y=y.replace("]","");j=j.val();e[m]=e[m]||{};e[m][y]=j});return e}})(jQuery);
(function(){$.widget("ui.StatusBar",{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b).fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}})})();if(!this.JSON)this.JSON={};
(function(){function b(n){return n<10?"0"+n:n}function c(n){f.lastIndex=0;return f.test(n)?'"'+n.replace(f,function(C){var w=y[C];return typeof w==="string"?w:"\\u"+("0000"+C.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function e(n,C){var w,F,H,I,A=j,G,z=C[n];if(z&&typeof z==="object"&&typeof z.toJSON==="function")z=z.toJSON(n);if(typeof x==="function")z=x.call(C,n,z);switch(typeof z){case "string":return c(z);case "number":return isFinite(z)?String(z):"null";case "boolean":case "null":return String(z);
case "object":if(!z)return"null";j+=m;G=[];if(Object.prototype.toString.apply(z)==="[object Array]"){I=z.length;for(w=0;w<I;w+=1)G[w]=e(w,z)||"null";H=G.length===0?"[]":j?"[\n"+j+G.join(",\n"+j)+"\n"+A+"]":"["+G.join(",")+"]";j=A;return H}if(x&&typeof x==="object"){I=x.length;for(w=0;w<I;w+=1){F=x[w];if(typeof F==="string")if(H=e(F,z))G.push(c(F)+(j?": ":":")+H)}}else for(F in z)if(Object.hasOwnProperty.call(z,F))if(H=e(F,z))G.push(c(F)+(j?": ":":")+H);H=G.length===0?"{}":j?"{\n"+j+G.join(",\n"+j)+
"\n"+A+"}":"{"+G.join(",")+"}";j=A;return H}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,m,y={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},x;if(typeof JSON.stringify!=="function")JSON.stringify=function(n,C,w){var F;m=j="";if(typeof w==="number")for(F=0;F<w;F+=1)m+=" ";else if(typeof w==="string")m=w;if((x=C)&&typeof C!=="function"&&(typeof C!=="object"||typeof C.length!=="number"))throw Error("JSON.stringify");return e("",
{"":n})};if(typeof JSON.parse!=="function")JSON.parse=function(n,C){function w(H,I){var A,G,z=H[I];if(z&&typeof z==="object")for(A in z)if(Object.hasOwnProperty.call(z,A)){G=w(z,A);if(G!==undefined)z[A]=G;else delete z[A]}return C.call(H,I,z)}var F;n=String(n);g.lastIndex=0;if(g.test(n))n=n.replace(g,function(H){return"\\u"+("0000"+H.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){F=eval("("+n+")");return typeof C==="function"?w({"":F},""):F}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var b=function(){};b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(c,e,g,f){if(!f){this.context=e;this.buffer=[]}if(!this.includes("",c))if(f)return c;else{this.send(c);return}c=this.render_pragmas(c);c=this.render_section(c,e,g);if(f)return this.render_tags(c,e,g,f);this.render_tags(c,e,g,f)},send:function(c){c!=""&&this.buffer.push(c)},render_pragmas:function(c){if(!this.includes("%",c))return c;
var e=this;return c.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(g,f,j){if(!e.pragmas_implemented[f])throw{message:"This implementation of mustache doesn't understand the '"+f+"' pragma"};e.pragmas[f]={};if(j){g=j.split("=");e.pragmas[f][g[0]]=g[1]}return""})},render_partial:function(c,e,g){c=this.trim(c);if(!g||g[c]===undefined)throw{message:"unknown_partial '"+c+"'"};if(typeof e[c]!="object")return this.render(g[c],e,g,true);return this.render(g[c],e[c],g,true)},render_section:function(c,
e,g){if(!this.includes("#",c)&&!this.includes("^",c))return c;var f=this;return c.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(j,m,y,x){j=f.find(y,e);if(m=="^")return!j||f.is_array(j)&&j.length===0?f.render(x,e,g,true):"";else if(m=="#")return f.is_array(j)?f.map(j,function(n){return f.render(x,f.create_context(n),g,true)}).join(""):f.is_object(j)?f.render(x,f.create_context(j),g,true):typeof j==="function"?
j.call(e,x,function(n){return f.render(n,e,g,true)}):j?f.render(x,e,g,true):""})},render_tags:function(c,e,g,f){var j=this,m=function(){return RegExp(j.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+j.ctag+"+","g")},y=m(),x=function(C,w,F){switch(w){case "!":return"";case "=":j.set_delimiters(F);y=m();return"";case ">":return j.render_partial(F,e,g);case "{":return j.find(F,e);default:return j.escape(j.find(F,e))}};c=c.split("\n");for(var n=0;n<c.length;n++){c[n]=c[n].replace(y,x,this);f||this.send(c[n])}if(f)return c.join("\n")},
set_delimiters:function(c){c=c.split(" ");this.otag=this.escape_regex(c[0]);this.ctag=this.escape_regex(c[1])},escape_regex:function(c){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return c.replace(arguments.callee.sRE,"\\$1")},find:function(c,e){c=this.trim(c);var g;if(e[c]===false||e[c]===0||e[c])g=e[c];else if(this.context[c]===false||this.context[c]===0||this.context[c])g=this.context[c];if(typeof g==="function")return g.apply(e);
if(g!==undefined)return g;return""},includes:function(c,e){return e.indexOf(this.otag+c)!=-1},escape:function(c){return String(c===null?"":c).replace(/&(?!\w+;)|["<>\\]/g,function(e){switch(e){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return e}})},create_context:function(c){if(this.is_object(c))return c;else{var e=".";if(this.pragmas["IMPLICIT-ITERATOR"])e=this.pragmas["IMPLICIT-ITERATOR"].iterator;var g={};g[e]=c;return g}},
is_object:function(c){return c&&typeof c=="object"},is_array:function(c){return Object.prototype.toString.call(c)==="[object Array]"},trim:function(c){return c.replace(/^\s*|\s*$/g,"")},map:function(c,e){if(typeof c.map=="function")return c.map(e);else{for(var g=[],f=c.length,j=0;j<f;j++)g.push(e(c[j]));return g}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(c,e,g,f){var j=new b;if(f)j.send=f;j.render(c,e,g);if(!f)return j.buffer.join("\n")}}}();
(function(b){b.mustache=function(c,e,g){return Mustache.to_html(c,e,g)}})(jQuery);
(function(b){b.fn.layout=function(c){function e(d){if(!d)return true;var h=d.keyCode;if(h<33)return true;var i={38:"north",40:"south",37:"west",39:"east"},k=h>=37&&h<=40,l=d.shiftKey,p=d.ctrlKey,s=false,q,u,r;if(!p&&!l)return true;else if(k&&n[i[h]].enableCursorHotkey)s=i[h];else b.each(t.borderPanes.split(","),function(v,D){q=n[D];u=q.customHotkey;r=q.customHotkeyModifier;if(l&&r=="SHIFT"||p&&r=="CTRL"||p&&l)if(u&&h==(isNaN(u)||u<=9?u.toUpperCase().charCodeAt(0):u)){s=D;return false}});if(!s)return true;
q=n[s];i=w[s];if(!q.enableCursorHotkey||i.isHidden||!E[s])return true;if((i=d.target||d.srcElement)&&l&&k&&(i.tagName=="TEXTAREA"||i.tagName=="INPUT"&&(h==37||h==39)))return true;ba(s);d.stopPropagation();return d.returnValue=false}function g(d){if(this&&this.tagName)d=this;d=typeof d=="string"?E[d]:b(d).attr("pane")?b(d):b(d).parents("div[pane]:first");if(d.length){var h=d.attr("pane"),i=w[h];i.cssSaved&&f(h);if(i.isSliding||i.isResizing||i.isClosed)i.cssSaved=false;else{var k={zIndex:t.zIndex.pane_normal+
1},l={},p=d.css("overflow"),s=d.css("overflowX"),q=d.css("overflowY");if(p!="visible"){l.overflow=p;k.overflow="visible"}if(s&&s!="visible"&&s!="auto"){l.overflowX=s;k.overflowX="visible"}if(q&&q!="visible"&&q!="auto"){l.overflowY=s;k.overflowY="visible"}i.cssSaved=l;d.css(k);b.each(t.allPanes.split(","),function(u,r){r!=h&&f(r)})}}}function f(d){if(this&&this.tagName)d=this;d=typeof d=="string"?E[d]:b(d).hasClass("ui-layout-pane")?b(d):b(d).parents("div[pane]:first");if(d.length){var h=d.attr("pane");
h=w[h];var i=h.cssSaved||{};!h.isSliding&&!h.isResizing&&d.css("zIndex",t.zIndex.pane_normal);d.css(i);h.cssSaved=false}}function j(d,h,i){var k=b(d);if(k.length)if(t.borderPanes.indexOf(h)==-1)alert("Error Adding Button \n\nInvalid pane: "+h);else{d=n[h].buttonClass+"-"+i;k.addClass(d+" "+d+"-"+h);return k}else alert("Error Adding Button \n\nInvalid selector: "+d);return false}function m(d,h){b.each(t[d].pins,function(i,k){y(b(k),d,h)})}function y(d,h,i){var k=d.attr("pin");if(!(k&&i==(k=="down"))){var l=
n[h].buttonClass+"-pin",p=l+"-"+h;h=l+"-up";k=p+"-up";l+="-down";p+="-down";d.attr("pin",i?"down":"up").attr("title",i?"Un-Pin":"Pin").removeClass(i?h:l).removeClass(i?k:p).addClass(i?l:h).addClass(i?p:k)}}var x={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},n={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:x.contentSelector,contentIgnoreSelector:x.contentIgnoreSelector,paneClass:x.paneClass,resizerClass:x.resizerClass,togglerClass:x.togglerClass,buttonClass:x.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},C={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},w={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},F={north:"south",south:"north",east:"west",west:"east"},H=function(d){if(typeof d=="string")return true;else if(typeof d=="object")try{return d.constructor.toString().match(/string/i)!==null}catch(h){}return false},I=function(d){return typeof d=="string"||H(d)?b.trim(d):d},A=function(d,h){return Math.max(d,h)},G=function(d){var h={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};d=d||{};if(d.effects||
d.defaults||d.north||d.south||d.west||d.east||d.center)h=b.extend(h,d);else b.each(d,function(i,k){a=i.split("__");h[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=k});return h},z=function(d,h,i){function k(s){p=t[s];if(p.doCallback){cpPane=p.callback.split(",")[1];cpPane!=s&&cpPane!=h&&k(cpPane,true)}else{p.doCallback=true;p.callback=l}}var l=d+","+h+","+(i?1:0),p;b.each(t.borderPanes.split(","),function(s,q){if(t[q].isMoving){k(q);return false}})},ca=function(d){d=t[d];t.isLayoutBusy=false;delete d.isMoving;
if(d.doCallback&&d.callback){d.doCallback=false;var h=d.callback.split(","),i=h[2]>0?true:false;if(h[0]=="open")V(h[1],i);else h[0]=="close"&&T(h[1],i);if(!d.doCallback)d.callback=null}},L=function(d,h){if(h){var i;try{if(typeof h=="function")i=h;else if(typeof h!="string")return;else if(h.indexOf(",")>0){var k=h.split(",");i=eval(k[0]);if(typeof i=="function"&&k.length>1)return i(k[1])}else i=eval(h);if(typeof i=="function")return i(d,E[d],b.extend({},w[d]),b.extend({},n[d]),n.name)}catch(l){}}},
M=function(d,h){var i=0,k=false,l="";if(!b.browser.msie)if(b.curCSS(d[0],"display",true)=="none"){k=true;l=b.curCSS(d[0],"visibility",true);d.css({display:"block",visibility:"hidden"})}i=parseInt(b.curCSS(d[0],h,true),10)||0;if(k){d.css({display:"none"});l&&l!="hidden"&&d.css({visibility:l})}return i},N=function(d,h){var i;if(H(d)){d=I(d);i=E[d]}else i=b(d);if(h<=0)return 0;else h>0||(h=H(d)?S(d):i.outerWidth());return b.boxModel?h-M(i,"paddingLeft")-M(i,"paddingRight")-(b.curCSS(i[0],"borderLeftStyle",
true)=="none"?0:M(i,"borderLeftWidth"))-(b.curCSS(i[0],"borderRightStyle",true)=="none"?0:M(i,"borderRightWidth")):h},P=function(d,h){var i;if(H(d)){d=I(d);i=E[d]}else i=b(d);if(h<=0)return 0;else h>0||(h=H(d)?S(d):i.outerHeight());return b.boxModel?h-M(i,"paddingTop")-M(i,"paddingBottom")-(b.curCSS(i[0],"borderTopStyle",true)=="none"?0:M(i,"borderTopWidth"))-(b.curCSS(i[0],"borderBottomStyle",true)=="none"?0:M(i,"borderBottomWidth")):h},S=function(d,h){var i=E[d],k=n[d],l=w[d],p=h?k.spacing_open:
0;k=h?k.spacing_closed:0;return!i||l.isHidden?0:l.isClosed||l.isSliding&&h?k:t[d].dir=="horz"?i.outerHeight()+p:i.outerWidth()+p},da=function(d){var h=B,i=t[d].dir,k=w[d],l=E[F[d]],p=n[d].spacing_open,s=n[F[d]].spacing_open,q=!l?0:i=="horz"?l.outerHeight():l.outerWidth();l=k.minSize||0;i=Math.min(k.maxSize||9999,(i=="horz"?h.innerHeight:h.innerWidth)-p-q-s);var u,r;switch(d){case "north":u=h.offsetTop+l;r=h.offsetTop+i;break;case "west":u=h.offsetLeft+l;r=h.offsetLeft+i;break;case "south":u=h.offsetTop+
h.innerHeight-i;r=h.offsetTop+h.innerHeight-l;break;case "east":u=h.offsetLeft+h.innerWidth-i;r=h.offsetLeft+h.innerWidth-l}b.extend(k,{minSize:l,maxSize:i,minPosition:u,maxPosition:r})},ma=function(){var d={top:S("north",true),bottom:S("south",true),left:S("west",true),right:S("east",true),width:0,height:0};with(d){width=B.innerWidth-left-right;height=B.innerHeight-bottom-top;top+=B.top;bottom+=B.bottom;left+=B.left;right+=B.right}return d},na=function(d){var h={},i,k,l;b.each("Left,Right,Top,Bottom".split(","),
function(){i=I(this);k=h["border"+i]=M(d,"border"+i+"Width");l=h["padding"+i]=M(d,"padding"+i);h["offset"+i]=k+l;if(d==O)h[i.toLowerCase()]=b.boxModel?l:0});h.innerWidth=h.outerWidth=d.outerWidth();h.innerHeight=h.outerHeight=d.outerHeight();if(b.boxModel){h.innerWidth-=h.offsetLeft+h.offsetRight;h.innerHeight-=h.offsetTop+h.offsetBottom}return h},ra=function(d,h,i,k){var l=window.layout=window.layout||{};l=l.timers=l.timers||{};d="layout_"+w.id+"_"+d+"_"+h;l[d]||(l[d]=setTimeout(i,k))},ea=function(d,
h){var i=window.layout=window.layout||{};i=i.timers=i.timers||{};var k="layout_"+w.id+"_"+d+"_"+h;if(i[k]){clearTimeout(i[k]);delete i[k];return true}else return false},sa=function(){try{if(O[0].tagName=="BODY"){b("html").css({height:"100%",overflow:"hidden"});b("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var d={overflow:"hidden"},h=O.css("position"),i=O.css("height");if(!O.hasClass("ui-layout-pane")){if(!h||"fixed,absolute,relative".indexOf(h)<
0)d.position="relative";if(!i||i=="auto")d.height="100%"}O.css(d)}}catch(k){}B=w.container=na(O)},ta=function(){b.each(t.borderPanes.split(","),function(d,h){var i=n[h];if(i.enableCursorHotkey||i.customHotkey){b(document).keydown(e);return false}})},ua=function(){c=G(c);if(c.effects){b.extend(C,c.effects);delete c.effects}b.each("name,scrollToBookmarkOnLoad".split(","),function(i,k){if(c[k]!==undefined)n[k]=c[k];else if(c.defaults[k]!==undefined){n[k]=c.defaults[k];delete c.defaults[k]}});b.each("paneSelector,resizerCursor,customHotkey".split(","),
function(i,k){delete c.defaults[k]});b.extend(n.defaults,c.defaults);t.center=b.extend(true,{},t.defaults,t.center);b.extend(n.center,c.center);var d=b.extend(true,{},n.defaults,c.defaults,n.center);b.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(i,k){n.center[k]=d[k]});var h=n.defaults;b.each(t.borderPanes.split(","),function(i,k){t[k]=b.extend(true,{},t.defaults,t[k]);o=n[k]=b.extend(true,{},n.defaults,n[k],c.defaults,c[k]);if(!o.paneClass)o.paneClass=
x.paneClass;if(!o.resizerClass)o.resizerClass=x.resizerClass;if(!o.togglerClass)o.togglerClass=x.togglerClass;b.each(["_open","_close",""],function(l,p){var s="fxName"+p,q="fxSpeed"+p,u="fxSettings"+p;o[s]=c[k][s]||c[k].fxName||c.defaults[s]||c.defaults.fxName||o[s]||o.fxName||h[s]||h.fxName||"none";var r=o[s];if(r=="none"||!b.effects||!b.effects[r]||!C[r]&&!o[u]&&!o.fxSettings)r=o[s]="none";r=C[r]||{};s=r.all||{};r=r[k]||{};o[u]=b.extend({},s,r,h.fxSettings||{},h[u]||{},o.fxSettings,o[u],c.defaults.fxSettings,
c.defaults[u]||{},c[k].fxSettings,c[k][u]||{});o[q]=c[k][q]||c[k].fxSpeed||c.defaults[q]||c.defaults.fxSpeed||o[q]||o[u].duration||o.fxSpeed||o.fxSettings.duration||h.fxSpeed||h.fxSettings.duration||r.duration||s.duration||"normal"})})},oa=function(){b.each(t.allPanes.split(","),function(){var d=I(this),h=n[d],i=w[d],k=t[d].dir,l=h.size=="auto"||isNaN(h.size)?0:h.size,p=h.minSize||1,s=h.maxSize||9999,q=h.spacing_open||0,u=h.paneSelector,r={},v;X[d]=false;if(u.substr(0,1)==="#")v=E[d]=O.find(u+":first");
else{v=E[d]=O.children(u+":first");v.length||(v=E[d]=O.children("form:first").children(u+":first"))}if(!v.length){E[d]=false;return true}v.attr("pane",d).addClass(h.paneClass+" "+h.paneClass+"-"+d);if(d!="center"){i.isClosed=false;i.isSliding=false;i.isResizing=false;i.isHidden=false;i.noRoom=false;t[d].pins=[]}r=b.extend({visibility:"visible",display:"block"},t.defaults.cssReq,t[d].cssReq);h.applyDefaultStyles&&b.extend(r,t.defaults.cssDef,t[d].cssDef);v.css(r);r={};switch(d){case "north":r.top=
B.top;r.left=B.left;r.right=B.right;break;case "south":r.bottom=B.bottom;r.left=B.left;r.right=B.right;break;case "west":r.left=B.left;break;case "east":r.right=B.right}if(k=="horz"){if(l===0||l=="auto"){v.css({height:"auto"});l=v.outerHeight()}l=A(l,p);l=Math.min(l,s);l=Math.min(l,B.innerHeight-q);r.height=A(1,P(d,l));i.size=l;i.maxSize=s;i.minSize=A(p,l-r.height+1);v.css(r)}else if(k=="vert"){if(l===0||l=="auto"){v.css({width:"auto","float":"left"});l=v.outerWidth();v.css({"float":"none"})}l=A(l,
p);l=Math.min(l,s);l=Math.min(l,B.innerWidth-q);r.width=A(1,N(d,l));i.size=l;i.maxSize=s;i.minSize=A(p,l-r.width+1);v.css(r);W(d,null,true)}else if(d=="center"){v.css(r);W("center",null,true)}if(h.initClosed&&h.closable){v.hide().addClass("closed");i.isClosed=true}else if(h.initHidden||h.initClosed){ha(d,true);i.isHidden=true}else v.addClass("open");h.showOverflowOnHover&&v.hover(g,f);if(h.contentSelector){i=X[d]=v.children(h.contentSelector+":first");if(!i.length){X[d]=false;return true}i.css(t.content.cssReq);
h.applyDefaultStyles&&i.css(t.content.cssDef);v.css({overflow:"hidden"})}})},va=function(){b.each(t.borderPanes.split(","),function(){var d=I(this),h=n[d],i=w[d],k=h.resizerClass,l=h.togglerClass,p=E[d];Q[d]=false;Y[d]=false;if(!(!p||!h.closable&&!h.resizable)){var s=t[d].edge;p=p.is(":visible");var q="-"+d,u=p?"-open":"-closed",r;r=Q[d]=b("<span></span>");p&&h.resizable||!p&&h.slidable&&r.attr("title",h.sliderTip).css("cursor",h.sliderCursor);r.attr("id",h.paneSelector.substr(0,1)=="#"?h.paneSelector.substr(1)+
"-resizer":"").attr("resizer",d).css(t.resizers.cssReq).css(s,B[s]+S(d)).addClass(k+" "+k+q+" "+k+u+" "+k+q+u).appendTo(O);h.applyDefaultStyles&&r.css(t.resizers.cssDef);if(h.closable){k=Y[d]=b("<div></div>");k.attr("id",h.paneSelector.substr(0,1)=="#"?h.paneSelector.substr(1)+"-toggler":"").css(t.togglers.cssReq).attr("title",p?h.togglerTip_open:h.togglerTip_closed).click(function(v){ba(d);v.stopPropagation()}).mouseover(function(v){v.stopPropagation()}).addClass(l+" "+l+q+" "+l+u+" "+l+q+u).appendTo(r);
if(h.togglerContent_open)b("<span>"+h.togglerContent_open+"</span>").addClass("content content-open").css("display",i.isClosed?"none":"block").appendTo(k);if(h.togglerContent_closed)b("<span>"+h.togglerContent_closed+"</span>").addClass("content content-closed").css("display",i.isClosed?"block":"none").appendTo(k);h.applyDefaultStyles&&k.css(t.togglers.cssDef);p||ia(d,true)}}});Z("all",true)},wa=function(){var d=typeof b.fn.draggable=="function",h;b.each(t.borderPanes.split(","),function(){var i=
I(this),k=n[i],l=w[i];if(!d||!E[i]||!k.resizable){k.resizable=false;return true}var p=k.resizerClass,s=p+"-drag",q=p+"-"+i+"-drag",u=p+"-dragging",r=p+"-"+i+"-dragging",v=false,D=Q[i];l.isClosed||D.attr("title",k.resizerTip).css("cursor",k.resizerCursor);D.draggable({containment:O[0],axis:t[i].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:k.resizerDragOpacity,zIndex:t.zIndex.resizing,start:function(){if(false===L(i,k.onresize_start))return false;l.isResizing=true;ea(i,"closeSlider");
D.addClass(s+" "+q);v=false;var J=i=="east"||i=="south"?k.spacing_open:0;da(i);l.minPosition-=J;l.maxPosition-=J;h=t[i].dir=="horz"?"top":"left";b(k.maskIframesOnResize===true?"iframe":k.maskIframesOnResize).each(function(){b('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(b(this).offset()).appendTo(this.parentNode)})},drag:function(J,K){if(!v){b(".ui-draggable-dragging").addClass(u+
" "+r).children().css("visibility","hidden");v=true;l.isSliding&&E[i].css("zIndex",t.zIndex.sliding)}if(K.position[h]<l.minPosition)K.position[h]=l.minPosition;else if(K.position[h]>l.maxPosition)K.position[h]=l.maxPosition},stop:function(J,K){var R=K.position,U;D.removeClass(s+" "+q);switch(i){case "north":U=R.top;break;case "west":U=R.left;break;case "south":U=B.outerHeight-R.top-D.outerHeight();break;case "east":U=B.outerWidth-R.left-D.outerWidth()}ja(i,U-B[t[i].edge]);b("div.ui-layout-mask").remove();
l.isResizing=false}})})},ha=function(d,h){var i=n[d],k=w[d],l=E[d],p=Q[d];if(!(!l||k.isHidden))if(false!==L(d,i.onhide_start)){k.isSliding=false;p&&p.hide();if(h||k.isClosed){k.isClosed=true;k.isHidden=true;l.hide();W(t[d].dir=="horz"?"all":"center");L(d,i.onhide_end||i.onhide)}else{k.isHiding=true;T(d,false)}}},fa=function(d,h){var i=n[d],k=w[d],l=Q[d];if(E[d]&&k.isHidden)if(false!==L(d,i.onshow_start)){k.isSliding=false;k.isShowing=true;l&&i.spacing_open>0&&l.show();h===false?T(d,true):V(d)}},ba=
function(d){var h=w[d];if(h.isHidden)fa(d);else h.isClosed?V(d):T(d)},T=function(d,h,i){function k(){ia(d,true);K||L(d,q.onclose_end||q.onclose);if(K)L(d,q.onshow_end||q.onshow);if(R)L(d,q.onhide_end||q.onhide);ca(d)}var l=E[d],p=Q[d],s=Y[d],q=n[d],u=w[d];i=!i&&!u.isClosed&&q.fxName_close!="none";var r=t[d].edge,v=q.resizerClass,D=q.togglerClass,J="-"+d,K=u.isShowing,R=u.isHiding;delete u.isShowing;delete u.isHiding;if(!(!l||!q.resizable&&!q.closable))if(!(!h&&u.isClosed&&!K))if(t.isLayoutBusy)z("close",
d,h);else if(!(!K&&false===L(d,q.onclose_start))){t[d].isMoving=true;t.isLayoutBusy=true;u.isClosed=true;if(R)u.isHidden=true;else if(K)u.isHidden=false;m(d,false);u.isSliding||W(t[d].dir=="horz"?"all":"center");if(p){p.css(r,B[r]).removeClass(v+"-open "+v+J+"-open").removeClass(v+"-sliding "+v+J+"-sliding").addClass(v+"-closed "+v+J+"-closed");q.resizable&&p.draggable("disable").css("cursor","default").attr("title","");s&&s.removeClass(D+"-open "+D+J+"-open").addClass(D+"-closed "+D+J+"-closed").attr("title",
q.togglerTip_closed);Z()}if(i){ga(d,true);l.hide(q.fxName_close,q.fxSettings_close,q.fxSpeed_close,function(){ga(d,false);u.isClosed&&k()})}else{l.hide();k()}}},V=function(d,h,i){function k(){u.isSliding||W(t[d].dir=="vert"?"center":"all");if(p){p.css(r,B[r]+S(d)).removeClass(v+R+" "+v+J+R).addClass(v+K+" "+v+J+K).addClass(!u.isSliding?"":v+U+" "+v+J+U);q.resizable?p.draggable("enable").css("cursor",q.resizerCursor).attr("title",q.resizerTip):p.css("cursor","default");s&&s.removeClass(D+R+" "+D+J+
R).addClass(D+K+" "+D+J+K).attr("title",q.togglerTip_open);Z("all")}aa(d);m(d,!u.isSliding);L(d,q.onopen_end||q.onopen);if(ka)L(d,q.onshow_end||q.onshow);ca(d)}var l=E[d],p=Q[d],s=Y[d],q=n[d],u=w[d];i=!i&&u.isClosed&&q.fxName_open!="none";var r=t[d].edge,v=q.resizerClass,D=q.togglerClass,J="-"+d,K="-open",R="-closed",U="-sliding",ka=u.isShowing;delete u.isShowing;if(!(!l||!q.resizable&&!q.closable))if(u.isClosed||u.isSliding)if(u.isHidden&&!ka)fa(d,true);else if(t.isLayoutBusy)z("open",d,h);else if(false!==
L(d,q.onopen_start)){t[d].isMoving=true;t.isLayoutBusy=true;u.isSliding&&!h&&la(d,false);u.isClosed=false;if(ka)u.isHidden=false;da(d);u.size>u.maxSize&&l.css(t[d].sizeType,A(1,t[d].dir=="horz"?P(d,u.maxSize):N(d,u.maxSize)));ia(d,false);if(i){ga(d,true);l.show(q.fxName_open,q.fxSettings_open,q.fxSpeed_open,function(){ga(d,false);u.isClosed||k()})}else{l.show();k()}}},ga=function(d,h){var i=E[d];if(h){i.css({zIndex:t.zIndex.animation});if(d=="south")i.css({top:B.top+B.innerHeight-i.outerHeight()});
else d=="east"&&i.css({left:B.left+B.innerWidth-i.outerWidth()})}else{w[d].isSliding||i.css({zIndex:t.zIndex.pane_normal});if(d=="south")i.css({top:"auto"});else d=="east"&&i.css({left:"auto"})}},ia=function(d,h){var i=n[d],k=Q[d],l=i.slideTrigger_open;if(k&&i.slidable){if(l!="click"&&l!="dblclick"&&l!="mouseover")l="click";k[h?"bind":"unbind"](l,xa).css("cursor",h?i.sliderCursor:"default").attr("title",h?i.sliderTip:"")}},la=function(d,h){function i(s){ea(d,"closeSlider");s.stopPropagation()}var k=
n[d].slideTrigger_close,l=E[d],p=Q[d];w[d].isSliding=h;ea(d,"closeSlider");l.css({zIndex:h?t.zIndex.sliding:t.zIndex.pane_normal});p.css({zIndex:h?t.zIndex.sliding:t.zIndex.resizer_normal});if(k!="click"&&k!="mouseout")k="mouseout";if(h){l.bind(k,pa);p.bind(k,pa);k="mouseout";l.bind("mouseover",i);p.bind("mouseover",i)}else{l.unbind(k);p.unbind(k);k="mouseout";l.unbind("mouseover");p.unbind("mouseover");ea(d,"closeSlider")}},xa=function(){var d=b(this).attr("resizer");if(w[d].isClosed){la(d,true);
V(d,true)}},pa=function(){function d(){la(i,false);k.isClosed||T(i)}var h=b(this),i=h.attr("pane")||h.attr("resizer");h=n[i];var k=w[i];k.isClosed||k.isResizing||(h.slideTrigger_close=="click"?d():ra(i,"closeSlider",d,300))},ja=function(d,h){var i=t[d].edge,k=t[d].dir,l=n[d],p=w[d],s=E[d],q=Q[d];da(d);p.minSize=A(p.minSize,l.minSize);if(l.maxSize>0)p.maxSize=Math.min(p.maxSize,l.maxSize);h=A(h,p.minSize);h=Math.min(h,p.maxSize);p.size=h;q.css(i,h+B[i]);s.css(t[d].sizeType,A(1,t[d].dir=="horz"?P(d,
h):N(d,h)));p.isSliding||W(k=="horz"?"all":"center");Z();aa(d);L(d,l.onresize_end||l.onresize)},W=function(d,h,i){if(!d||d=="all")d="east,west,center";var k=ma();h&&b.extend(k,h);b.each(d.split(","),function(){if(E[this]){var l=I(this),p=n[l],s=w[l],q=E[l],u=Q[l],r=true,v={};if(l=="center"){k=ma();v=b.extend({},k);v.width=A(1,N(l,v.width));v.height=A(1,P(l,v.height));r=v.width>1&&v.height>1;if(b.browser.msie&&(!b.boxModel||b.browser.version<7)){E.north&&E.north.css({width:N(E.north,B.innerWidth)});
E.south&&E.south.css({width:N(E.south,B.innerWidth)})}}else{v.top=k.top;v.bottom=k.bottom;v.height=A(1,P(l,k.height));r=v.height>1}if(r){q.css(v);if(s.noRoom){s.noRoom=false;if(s.isHidden)return;else fa(l,!s.isClosed)}if(!i){aa(l);L(l,p.onresize_end||p.onresize)}}else if(!s.noRoom){s.noRoom=true;if(!s.isHidden)if(i){q.hide();u&&u.hide()}else ha(l)}}})},aa=function(d){if(!d||d=="all")d=t.allPanes;b.each(d.split(","),function(){if(X[this]){var h=I(this),i=n[h].contentIgnoreSelector,k=E[h];h=X[h];var l=
h[0],p=P(k);k.children().each(function(){if(this!=l){var s=b(this);if(!i||!s.is(i))p-=s.outerHeight()}});if(p>0)p=P(h,p);p<1?h.hide():h.css({height:p}).show()}})},Z=function(d,h){if(!d||d=="all")d=t.borderPanes;b.each(d.split(","),function(){var i=I(this),k=n[i],l=w[i],p=E[i],s=Q[i],q=Y[i];if(!(!p||!s||!k.resizable&&!k.closable)){var u=t[i].dir,r=l.isClosed?"_closed":"_open";i=k["spacing"+r];var v=k["togglerAlign"+r];r=k["togglerLength"+r];var D;if(i==0)s.hide();else{!l.noRoom&&!l.isHidden&&s.show();
if(u=="horz"){D=p.outerWidth();s.css({width:A(1,N(s,D)),height:A(1,P(s,i)),left:M(p,"left")})}else{D=p.outerHeight();s.css({height:A(1,P(s,D)),width:A(1,N(s,i)),top:B.top+S("north",true)})}if(q){if(r==0||l.isSliding&&k.hideTogglerOnSlide){q.hide();return}else q.show();if(!(r>0)||r=="100%"||r>D){r=D;p=0}else if(typeof v=="string")switch(v){case "top":case "left":p=0;break;case "bottom":case "right":p=D-r;break;default:p=Math.floor((D-r)/2)}else{p=parseInt(v);p=v>=0?p:D-r+p}D=k.togglerContent_open?
q.children(".content-open"):false;var J=k.togglerContent_closed?q.children(".content-closed"):false;v=l.isClosed?J:D;if(D)D.css("display",l.isClosed?"none":"block");if(J)J.css("display",l.isClosed?"block":"none");if(u=="horz"){l=N(q,r);q.css({width:A(0,l),height:A(1,P(q,i)),left:p});v&&v.css("marginLeft",Math.floor((l-v.outerWidth())/2))}else{l=P(q,r);q.css({height:A(0,l),width:A(1,N(q,i)),top:p});v&&v.css("marginTop",Math.floor((l-v.outerHeight())/2))}}if(h&&k.initHidden){s.hide();q&&q.hide()}}}})},
qa=function(){var d=B.innerWidth,h=B.innerHeight;B=w.container=na(O);var i=B.innerHeight<h,k=B.innerWidth<d,l,p;if(i||k)b.each(["south","north","east","west"],function(s,q){l=w[q];p=t[q].dir;if(!l.isClosed&&(i&&p=="horz"||k&&p=="vert")){da(q);l.size>l.maxSize&&ja(q,l.maxSize)}});W("all");Z("all")},O=b(this).css({overflow:"hidden"}),E={},X={},Q={},Y={},t={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},B=w.container;(function(){ua();sa();oa();va();wa();aa("all");if(n.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();b(window).resize(function(){var d="timerLayout_"+w.id;window[d]&&clearTimeout(window[d]);window[d]=null;window[d]=setTimeout(qa,100)})})();return{options:n,state:w,panes:E,toggle:ba,open:V,close:T,hide:ha,show:fa,resizeContent:aa,sizePane:ja,reinitPane:oa,resizeAll:qa,addToggleBtn:function(d,h){var i=
j(d,h,"toggle");if(i)i.attr("title",w[h].isClosed?"Open":"Close").click(function(k){ba(h);k.stopPropagation()})},addOpenBtn:function(d,h){var i=j(d,h,"open");i&&i.attr("title","Open").click(function(k){V(h);k.stopPropagation()})},addCloseBtn:function(d,h){var i=j(d,h,"close");i&&i.attr("title","Close").click(function(k){T(h);k.stopPropagation()})},addPinBtn:function(d,h){var i=j(d,h,"pin");if(i){var k=w[h];i.click(function(l){y(b(this),h,k.isSliding||k.isClosed);k.isSliding||k.isClosed?V(h):T(h);
l.stopPropagation()});y(i,h,!k.isClosed&&!k.isSliding);t[h].pins.push(d)}},allowOverflow:g,resetOverflow:f,cssWidth:N,cssHeight:P}}})(jQuery);
(function(){$.widget("ui.TagView",{_GetTag:function(b,c){var e=this,g=$($.mustache(c,b.tag));g.data("data",b);if(!e.tagMenu){e.tagMenu=g.find(".tag-menu");e.tagMenu.hide()}g.find(".tag-menu").remove();g.find(".color-selector").bind("click",function(f){var j=e.tagMenu;f=$(f.target);var m=f.parent(".tag").data("data");if(j.data("visible")===true&&j.data("tagId")===b.tag.id){j.hide("fast");j.data("visible",false);j.data("tagId",null);j.data("tag",null);j.data("target",null)}else{j.show("fast");j.css({left:g.position().left,
top:g.position().top-100});j.data("visible",true);j.data("tagId",m.tag.id);j.data("tag",m);j.data("target",f)}return false});ListKungFu&&ListKungFu.LayoutWest&&g.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};e._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});g.bind("click",function(){var f=g.data("data");if(g.data("selected")){e._RemoveSelectedTag(f.tag.id);
g.removeClass("tag-selected");g.data("selected",false)}else{e._AddSelectedTag(f.tag.id);g.addClass("tag-selected");g.data("selected",true)}e._trigger("TagSelected",0,e.selectedTags);return false});return g},_AddSelectedTag:function(b){this.selectedTags.push(b);this.selectedTags=jQuery.unique(widget.selectedTags)},_RemoveSelectedTag:function(b){for(var c=[],e=0;e<this.selectedTags.length;e++)this.selectedTags[e]!==b&&c.push(this.selectedTags[e]);this.selectedTags=c},_CreateToolbar:function(){widget.tagList.append(widget.tagMenu);
widget.tagMenu.find(".color").bind("click",function(b){var c=$(b.target).attr("data-colorclass");b=widget.tagMenu.data("tag");var e=b.tag.color_class,g=widget.tagMenu.data("target");b.tag.color_class=c;Tag.Update({send:b,successCallback:function(f,j){widget._trigger("AfterColorChanged",0,{});g.parent(".tag").removeClass(e);g.parent(".tag").addClass(c);g.removeClass(e);g.addClass(c);widget.tagMenu.hide("fast");widget.tagMenu.data("visible",false);widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",
null);widget.tagMenu.data("target",null);g.data("data",j)},tags:b.tag.id})});widget.tagMenu.find(".delete-label").bind("click",function(){widget.tagMenu.hide("fast");widget.tagMenu.data("visible",false);var b=function(){widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",null);widget.tagMenu.data("target",null)},c=function(){var e=widget.tagMenu.data("tag"),g=widget.tagMenu.data("target");Tag.Destroy({successCallback:function(){widget._trigger("AfterTagDeleted",0,{});g.hide("fast",function(){g.parent(".tag").remove();
widget.tagMenu.data("tagId",null);widget.tagMenu.data("tag",null);widget.tagMenu.data("target",null)})},tags:e.tag.id})};if(typeof widget.deleteDialog==="undefined")widget.deleteDialog=$.confirmationDialog("Delete Tag",c,"Cancel","Delete Tag and remove it from all lists?",b);widget.deleteDialog.dialog("open");return false})},_create:function(){widget=this;widget.header=$('<h1 class="subsection-header">Notebook Tags</h1>');widget.toolbar=$('<div id="tag-toolbar"></div>');widget.addTagInput=$('<input type="text" value="" id="add-tag"/>');
widget.addTagButton=$('<button id="tag-new">Create Tag</button>');widget.tagList=$('<div class="tags"></div>');widget.element.append(widget.header);widget.element.append(widget.toolbar);widget.toolbar.append(widget.addTagInput);widget.toolbar.append(widget.addTagButton);widget.element.append(widget.tagList);widget.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});widget.selectedTags=[];Tag.Index({successCallback:function(b,c,e){e==="success"&&widget.tagList.find(".tag").remove();
for(e=0;e<c.length;e++)widget.tagList.append(widget._GetTag(c[e],b));widget.tagMenu&&widget._CreateToolbar()}});widget.addTagButton.bind("click",function(){if($.trim(widget.addTagInput.val())!==""&&widget.tagList.find(".tag-name:HasExactValue('"+$.trim(widget.addTagInput.val())+"')").length===0){var b={};b.tag={name:widget.addTagInput.val(),color_class:"c1"};Tag.Create({send:b,successCallback:function(c,e){var g=widget._GetTag(e,c);widget.tagList.prepend(g);widget.addTagInput.val("");widget.addTagInput.trigger("keyup");
widget.tagMenu&&widget._CreateToolbar()}});return false}});widget.addTagInput.bind("keyup","return",function(){widget.addTagButton.trigger("click")});widget.addTagInput.bind("keyup",function(){var b=$(this).val();if(b==="")widget.tagList.find(".tag").show();else{widget.tagList.find(".tag:not(:Contains('"+b+"'))").hide();widget.tagList.find(".tag:Contains('"+b+"')").show()}widget.tagList.find(".tag-name:HasExactValue('"+$.trim(b)+"')").length>0?widget.addTagButton.button("option","disabled",true):
widget.addTagButton.button("option","disabled",false)})},options:{},destroy:function(){widget.element.children().remove()}})})();
(function(){$.widget("ui.UltimateSearch",{_create:function(){var b=this;b.searchText=$('<div><input type="text" id="ultimate-search-text"/><span id="ultimate-search-text-cancel"></span></div>');b.searchOptions=$('<div id="searchOptions"><input type="checkbox" id="searchLists" class="searchOptionCheckbox" checked /><label for="searchLists" class="searchOptionLabel">Search List</label><input type="checkbox" id="searchDashboard" class="searchOptionCheckbox" checked /><label for="searchDashboard" class="searchOptionLabel">Search Dashboard</label><input type="checkbox" id="searchListItems" class="searchOptionCheckbox" checked /><label for="searchListItems" class="searchOptionLabel">Search List Items</label></div>');b.element.append(b.searchText);
b.element.append(b.searchOptions);$(document).bind("keyup","ctrl+f",function(){b.searchText.focus()});$(document).bind("keyup","shift+f",function(){b.searchText.focus()});b.searchText.bind("keyup",function(c){c=$(c.target).val();b._trigger("OnFilterChanged",0,{searchOptions:{searchLists:b.searchOptions.find("#searchLists:checked").length>0?true:false,searchListItems:b.searchOptions.find("#searchListItems:checked").length>0?true:false,searchDashboard:b.searchOptions.find("#searchDashboard:checked").length>
0?true:false},searchText:c})});b.searchText.find("#ultimate-search-text-cancel").bind("click",function(){b.searchText.find("#ultimate-search-text").val("").trigger("keyup")});b.searchText.bind("keyup","enter",function(){b.searchText.find("#ultimate-search-text").trigger("keyup")})},_init:function(){},options:{},destroy:function(){}})})();
(function(){$.widget("ui.ListItemShow",{_CreateToolbar:function(){var b=this;b.header.html("");b.toolbar=$('<div id="list-item-show-toolbar"><button id="back-to-list">Back [Alt+Backspace]</button><button id="list-item-edit">Edit [return]</button><div style="clear:both">&nbsp;</div></div>');b.toolbar.find("#back-to-list").button({text:false,icons:{primary:"ui-icon-arrowthick-1-w"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#back-to-list").bind("click",
function(){b.listItemElement.trigger("back-to-list")});b.toolbar.find("#list-item-edit").bind("click",function(){b.listItemElement.trigger("edit")});b.header.append(b.toolbar)},_create:function(){},_init:function(){var b=this;b.element.children().remove();b.wrapper=$('<div class="ui-layout-content" id="list-item-show-wrapper"></div>');b.header=$('<div id="list-item-show-header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b._CreateToolbar();b.wrapper.bind("beforeEdit",function(){b.element.find("#list-item-show-content").hide()});
b.wrapper.bind("afterEdit",function(c,e){e&&b.element.find("#list-item-show-content").html(e.list_item.body);b.element.find("#list-item-show-content").show().focus()});ListListItem.Show({successCallback:function(c,e){var g=$($.mustache(c,e.list_item));g.data("data",e);g.bind("keydown","left",function(){g.trigger("back-to-list")});g.bind("keydown","return",function(){b.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});g.trigger("edit")});g.bind("dblclick",function(){g.trigger("edit")});
g.bind("back-to-list",function(){var f=b.listItemElement.data("data");b.destroy();b.element.ListItemView("OpenList",f.list_item)});g.bind("edit",function(){var f=b.listItemElement.data("data");b.element.find("#list-item-show-wrapper").ListItemEdit({height:b.element.find("#list-item-show-wrapper").height()-70,listId:f.list_item.list_id,listItemId:f.list_item.id})});$.browser.msie&&g.bind("click",function(){g.focus();return false});g.height(b.element.height()-60);b.wrapper.append(g);g.focus();b.listItemElement=
g},lists:b.options.listItem.list_item.list_id,list_items:b.options.listItem.list_item.id})},options:{listItem:null},destroy:function(){this.element.children().remove()}})})();
(function(){$.widget("ui.ListItemEdit",{_SetupDeadlineButton:function(b){var c=b.find("#deadline-settings-wrapper"),e=b.find("#save-deadline");e.bind("click keydown","return",function(){e.data("settings-visible")?c.hide("fast",function(){c.find(".deadline-button").first();e.data("settings-visible",false)}):c.show("fast",function(){c.find(".deadline-button").first().focus();e.data("settings-visible",true)});return false})},_SetupCustomDeadlinePicker:function(){$("#custom-deadline-display").datepicker({minDate:new Date,
altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",new Date))},_create:function(){},_init:function(){var b=this;b.destroy();ListListItem.Edit({successCallback:function(c,e){b.element.trigger("beforeEdit");var g=$($.mustache(c,e.list_item));g.hide();b.element.prepend(g);b.element.height("auto");var f=ListKungFu.TinyMCEDefaultOptions;
f.height=b.options.height;g.find("textarea.editorarea").tinymce(f);b._SetupDeadlineButton(g);b._SetupCustomDeadlinePicker();g.show("slow",function(){g.find("textarea").focus()});g.find(".deadline-button").bind("keydown click","return",function(j){j.preventDefault();var m=b.element.find("form").serializeForm();m.list_item.deadlineType=$(j.target).attr("data-deadline");m.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Update({send:m,successCallback:function(y,x){g.hide("slow",
function(){b.destroy();b.element.trigger("afterEdit",x)})},lists:b.options.listId,list_items:b.options.listItemId});return false});g.find("#cancel-edit").bind("keydown click","return",function(j){j.preventDefault();b.destroy();b.element.trigger("afterEdit");return false});return false},lists:b.options.listId,list_items:b.options.listItemId})},options:{height:"auto",listId:null,listItemId:null},destroy:function(){this.element.children("form").remove()}})})();
(function(b){function c(f,j,m,y){if(jQuery.isFunction(j)){m=j;j=null}var x=f+"?"+b.param(j||{});if(g[x])return false;g[x]=true;return jQuery.ajax({type:"GET",url:f,data:j,success:function(n,C){delete g[x];if(undefined===n)window.navigator.onLine||(e=function(){c(f,j,m,y)});else m(n,C)},error:function(n,C,w){y(n,C,w);delete g[x]},dataType:"json",ifModified:true})}var e=null,g={};if(typeof b.support.localStorage==="undefined")b.support.localStorage=!!window.localStorage;if(b.support.localStorage){b(window).bind("online",
function(){e&&e()});b(window).bind("offline",function(){jQuery.event.trigger("ajaxStop")});b.retrieveJSON=function(f,j,m,y){function x(){for(var A=[],G=0;G<localStorage.length;++G){var z=localStorage.key(G);/:date$/.test(z)&&A.push(z)}A.sort(function(ca,L){var M=localStorage[ca],N=localStorage[L];return M<N?-1:M>N?+1:0});for(G=0;G<A.length/2;++G){z=A[G];delete localStorage[z];delete localStorage[z.substr(0,z.length-5)]}}function n(){c(f,j,function(A,G){if(G=="notmodified")return false;for(;;)try{localStorage[F]=
JSON.stringify(A);localStorage[F+":date"]=new Date;break}catch(z){if(z.name=="QUOTA_EXCEEDED_ERR"||z.name=="NS_ERROR_DOM_QUOTA_REACHED")x()}m(A,G,H&&{cachedAt:I,retrievedAt:C})},y)}if(b.isFunction(j)){m=j;j={}}var C=new Date,w=b.param(j),F="offline.jquery:"+f+":"+w,H=localStorage[F],I=new Date(Date.parse(localStorage[F+":date"]));if(H)if(m(b.parseJSON(H),"cached",{cachedAt:I})===false)return false;if(window.navigator.onLine)n();else e=n;return true};b.clearJSON=function(f,j){var m=b.param(j||{});
delete localStorage["offline.jquery:"+f+":"+m];delete localStorage["offline.jquery:"+f+":"+m+":date"]}}else{b.retrieveJSON=c;b.clearJSON=b.noop}})(jQuery);
