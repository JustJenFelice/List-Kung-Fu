var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};jQuery.expr[":"].Contains=function(h,b,w){return jQuery(h).text().toLowerCase().indexOf(w[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(h,b,w){return jQuery.trim(jQuery(h).text().toLowerCase())===w[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:92,minSize:92},south:{minSize:40},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(h,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(h,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(h,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(h,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");
ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(h){var b={},w=function(j){var k=$(j).length>0?{}:false;$(j).each(function(g,m){var q=$(m).attr("model"),t=$(m).attr("field"),p=$(m).text();k[q]=k[q]||{};k[q][t]=k[q][t]||[];k[q][t].push(p)});return k};b.ClearFlash=function(){b.flash={notice:"",error:"",warning:"",message:""}};b.ClearFlash();b.SetFlash=function(j){b.flash.notice=j.getResponseHeader("X-Flash-Notice")||"";b.flash.error=j.getResponseHeader("X-Flash-Error")||"";b.flash.warning=j.getResponseHeader("X-Flash-Warning")||
"";b.flash.message=j.getResponseHeader("X-Flash-Message")||"";if(typeof h.onFlashUpdate==="function")if(b.flash.notice!==""||b.flash.error!==""||b.flash.warning!==""||b.flash.message!=="")h.onFlashUpdate(b.flash.notice,b.flash.error,b.flash.warning,b.flash.message)};b.baseURL=h.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";b.route=h.route;b.DefaultCallback=function(j,k,g,m){b.SetFlash(m);var q=$.parseJSON($(k).find("JSON").text()),
t=$(k).find("Template").text();k=w($(k).find("Error"));typeof j==="function"&&j(t,q,g,m,k);b.ClearFlash()};b.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};b.ConstructRoute=function(j){for(var k=
"",g="",m=0;m<b.route.length;m++){k+=b.route[m];g=j[b.route[m]]||"";if(g!=="")k+="/"+g;if(m!==b.route.length-1)k+="/"}return k};b.Index=function(j){var k=j.successCallback||null,g=b.ConstructRoute(j);$.ajax({url:b.baseURL+g,dataType:"xml",type:"GET",processData:true,contentType:"application/json",data:j.send,success:function(m,q,t){b.DefaultCallback(k,m,q,t)},error:function(m,q,t){b.DefaultErrorCallback(m,q,t)}})};b.Show=function(j){var k=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+
j,dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(g,m,q){b.DefaultCallback(k,g,m,q)},error:function(g,m,q){b.DefaultErrorCallback(g,m,q)}})};b.New=function(j){var k=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j+"/new",dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(g,m,q){b.DefaultCallback(k,g,m,q)},error:function(g,m,q){b.DefaultErrorCallback(g,m,q)}})};b.Create=function(j){var k=j.successCallback||
null,g=b.ConstructRoute(j);j=JSON.stringify(j.send);$.ajax({url:b.baseURL+g,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:j,success:function(m,q,t){b.DefaultCallback(k,m,q,t)},error:function(m,q,t){b.DefaultErrorCallback(m,q,t)}})};b.Edit=function(j){var k=j.successCallback||null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j+"/edit",dataType:"xml",type:"GET",parseData:false,contentType:"application/json",success:function(g,m,q){b.DefaultCallback(k,g,m,q)},error:function(g,
m,q){b.DefaultErrorCallback(g,m,q)}})};b.Update=function(j){var k=j.successCallback||null,g=b.ConstructRoute(j);j=JSON.stringify(j.send);j=j.replace(/\\u000a/g,"\\n");$.ajax({url:b.baseURL+g,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:j,beforeSend:function(m){m.setRequestHeader("X-Http-Method-Override","PUT")},success:function(m,q,t){b.DefaultCallback(k,m,q,t)},error:function(m,q,t){b.DefaultErrorCallback(m,q,t)}})};b.Destroy=function(j){var k=j.successCallback||
null;j=b.ConstructRoute(j);$.ajax({url:b.baseURL+j,dataType:"xml",type:"POST",processData:false,contentType:"application/json",beforeSend:function(g){g.setRequestHeader("X-Http-Method-Override","DELETE")},success:function(g,m,q){b.DefaultCallback(k,g,m,q)},error:function(g,m,q){b.DefaultErrorCallback(g,m,q)}})};return b},List=Controller({route:["lists"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),ListListItem=Controller({route:["lists",
"list_items"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(h,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",h)}});
jQuery(function(h){var b=h("meta[name=csrf-token]").attr("content"),w=h("meta[name=csrf-param]").attr("content");h.fn.extend({triggerAndReturn:function(k,g){var m=new h.Event(k);this.trigger(m,g);return m.result!==false},callRemote:function(){var k=this,g=k.attr("method")||k.attr("data-method")||"GET",m=k.attr("action")||k.attr("href"),q=k.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(k.triggerAndReturn("ajax:before")){var t=
k.is("form")?k.serializeArray():[];h.ajax({url:m,data:t,dataType:q,type:g.toUpperCase(),beforeSend:function(p){k.trigger("ajax:loading",p)},success:function(p,G,C){k.trigger("ajax:success",[p,G,C])},complete:function(p){k.trigger("ajax:complete",p)},error:function(p,G,C){k.trigger("ajax:failure",[p,G,C])}})}k.trigger("ajax:after")}}});h("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var k=h(this);if(k.triggerAndReturn("confirm"))if(!confirm(k.attr("data-confirm")))return false});
h("form[data-remote]").live("submit.rails",function(k){h(this).callRemote();k.preventDefault()});h("a[data-remote],input[data-remote]").live("click.rails",function(k){h(this).callRemote();k.preventDefault()});h("a[data-method]:not([data-remote])").live("click.rails",function(k){var g=h(this),m=g.attr("href");g=g.attr("data-method");m=h('<form method="post" action="'+m+'"></form>');g='<input name="_method" value="'+g+'" type="hidden" />';if(w!==undefined&&b!==undefined)g+='<input name="'+w+'" value="'+
b+'" type="hidden" />';m.hide().append(g).appendTo("body");k.preventDefault();m.submit()});var j=function(){h(this).find("input[data-disable-with]").each(function(){var k=h(this);k.data("enable-with",k.val()).attr("value",k.attr("data-disable-with")).attr("disabled","disabled")})};h("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",j);h("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",j);h("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){h(this).find("input[data-disable-with]").each(function(){var k=h(this);k.removeAttr("disabled").val(k.data("enable-with"))})});j=h().jquery;if(j==="1.4"||j==="1.4.1"||j==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(h){h.confirmationDialog=function(b,w,j,k){dialog=h('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+k+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});k={};k[b]=function(){h(dialog).dialog("close");w()};k[j]=function(){h(dialog).dialog("close")};dialog.dialog("option","buttons",k);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown",
"right",function(g){g=h(g.target);if(g.next("button").length>0){g.blur();g.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(g){g=h(g.target);if(g.prev("button").length>0){g.blur();g.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){var h=function(){var b=null,w=function(g){var m=$(this),q=g.find(".dashboard-list-item-deadline-hidden"),t=g.data("data"),p=t.list_item.deadline_date.split("-"),G=p[0],C=p[1],K=p[2];q.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",beforeShow:function(H,l){l.input.datepicker("setDate",G+","+C+","+K)},onSelect:function(H){t.list_item.deadlineType="customdeadline";t.list_item.customDeadlineValue=H;t.list_item.template="dashboard";ListListItem.Update({successCallback:function(l,r){var u=
g.parent();g.hide("slow",function(){g.remove();u.find(".dashboard-item").length===0&&u.append('<p class="nothing-todo">no items scheduled</p>')});k(r,l,{highlightCategory:true,addType:"prepend"})},lists:t.list_item.list_id,list_items:t.list_item.id,send:t});m.datepicker("hide")}})},j=function(g,m,q){q=q||{};g.find(".nothing-todo").remove();q.addType==="prepend"?g.find("div[data-type=scheduleColumn]").first().prepend(m):g.find("div[data-type=scheduleColumn]").first().append(m);q.highlightCategory===
true&&m.effect("highlight",{},2E3)},k=function(g,m,q){var t=$($.mustache(m,g.list_item));switch(g.list_item.deadline_category){case "today":j(b.today,t,q);break;case "tomorrow":j(b.tomorrow,t,q);break;case "this week":j(b.thisweek,t,q);break;case "next week":j(b.nextweek,t,q);break;default:j(b.later,t,q)}t.data("data",g);t.find(".dashboard-list-item-title").bind("click",function(){b._trigger("OpenList",0,{selectedList:g.list_item})});t.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",
0,{selectedList:g.list_item})});t.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var p=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');$that.append(p);$that.animate({width:"100%",paddingLeft:"14px"},200);p.find(".yes").bind("click",function(){g.list_item.completed=true;ListListItem.Update({successCallback:function(){t.stop(true,true).hide("slow",function(){t.remove()})},
lists:g.list_item.list_id,list_items:g.list_item.id,send:g});p.find(".no").trigger("click");return false});p.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){p.remove()});return false})});t.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",0,{selectedList:g.list_item})});w(t);t.find(".dashboard-list-item-deadline").bind("click",function(){t.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});
return t};return{options:{},Show:function(){b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.toolbar=$('<div id="dashboard-toolbar"><input type="text" id="dashboard-search" value=""/></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn"></div></div>');b.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn"></div></div>');
b.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn"></div></div>');b.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn"></div></div>');b.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn"></div></div>');b.element.append(b.header);b.header.append(b.toolbar);b.element.append(b.wrapper);b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);
b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');b.toolbar.append('<div id="dashboard-search-cancel">&nbsp;</div><div style="clear:both;">&nbsp;</div>');ListItem.Index({successCallback:function(g,m){$.each(m,function(q,t){k(t,g)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append('<p class="nothing-todo">no items scheduled</p>')});b._trigger("ReinitPanes",0,{});b._trigger("ContentDimensionsChanged",
0,{})},send:{show:"dashboard"}});b.toolbar.find("#dashboard-search").bind("keyup",function(){var g=$(this).val();if(g==="")b.wrapper.find(".dashboard-item").show();else{b.wrapper.find(".dashboard-item:not(:Contains('"+g+"'))").hide();b.wrapper.find(".dashboard-item:Contains('"+g+"')").show()}});b.toolbar.find("#dashboard-search-cancel").bind("click",function(){b.toolbar.find("#dashboard-search").val("").trigger("keyup")})},Hide:function(){b.element.children().remove()},_create:function(){b=this},
destroy:function(){}}}();$.widget("ui.Dashboard",h)})();
(function(h){function b(w){if(typeof w.data==="string"){var j=w.handler,k=w.data.toLowerCase().split(" ");w.handler=function(g){if(!(this!==g.target&&(/textarea|select/i.test(g.target.nodeName)||g.target.type==="text"))){var m=g.type!=="keypress"&&h.hotkeys.specialKeys[g.which],q=String.fromCharCode(g.which).toLowerCase(),t="",p={};if(g.altKey&&m!=="alt")t+="alt+";if(g.ctrlKey&&m!=="ctrl")t+="ctrl+";if(g.metaKey&&!g.ctrlKey&&m!=="meta")t+="meta+";if(g.shiftKey&&m!=="shift")t+="shift+";if(m)p[t+m]=
true;else{p[t+q]=true;p[t+h.hotkeys.shiftNums[q]]=true;if(t==="shift+")p[h.hotkeys.shiftNums[q]]=true}m=0;for(q=k.length;m<q;m++)if(p[k[m]])return j.apply(this,arguments)}}}}h.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};h.each(["keydown","keyup","keypress"],function(){h.event.special[this]={add:b}})})(jQuery);
(function(){var h=function(){var b=null,w=function(){b._trigger("ContentDimensionsChanged",0,{})},j=function(l){var r=l.find("#deadline-settings-wrapper"),u=l.find("#save-deadline");u.bind("click keydown","return",function(){u.data("settings-visible")?r.hide("fast",function(){r.find(".deadline-button").first();u.data("settings-visible",false)}):r.show("fast",function(){r.find(".deadline-button").first().focus();u.data("settings-visible",true)});return false})},k=function(){$("#custom-deadline-display").datepicker({minDate:new Date,
altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",new Date))},g=function(l,r,u){var n=$($.mustache(r,l.list_item));n.data("data",l);n.data("isFullsize",false);u?b.listItemList.prepend(n):b.listItemList.append(n);n.find(".handle").height(n.height());n.bind("keydown","space",function(){b.toolbar.find("#list-item-completed").effect("puff",
{},300,function(){$(this).show();n.find(".undo").length===0?b.toolbar.find("#list-item-completed").trigger("click"):n.find(".undo").trigger("click")})});n.bind("keydown","del",function(){b.toolbar.find("#list-item-delete").effect("puff",{},300,function(){$(this).show();b.toolbar.find("#list-item-delete").trigger("click")})});n.bind("focus",function(D){if($(D.target).hasClass("row")){b.listItemList.find(".row").removeClass("selected-row");$(D.target).addClass("selected-row");$(D.target).data("data");
if(b.toolbar)$(D.target).data("isFullsize")===true?b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"}):b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"});var F=$(D.target);D=$(D.target).data("data");b.selectedListItem={element:F,data:D}}});n.bind("keydown","down",function(D){D.preventDefault();$(D.target).nextAll("div:visible").first().focus();return false});n.bind("keydown","up",function(D){D.preventDefault();$(D.target).prevAll("div:visible").first().focus();
return false});n.bind("keydown dblclick","return",function(){if(n.find("form").length>0)return false;b.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});b.listItemList.find(".row").find("form").hide("slow",function(){$(this).remove()});ListListItem.Edit({successCallback:function(D){var F=$(D),L=n.data("isFullsize");b.listItemList.find(".row").hide();b.selectedListItem.element.show();F.hide();b.selectedListItem.element.prepend(F);F.find("textarea").markItUp(mySettings);
j(F);k();L===false&&m(n);b.selectedListItem.element.find(".handle").hide();F.show("slow",function(){F.find("textarea").focus()});F.find("textarea").bind("keydown","esc",function(){F.find("#cancel-edit").trigger("click")});F.find(".deadline-button").bind("keydown click","return",function(M){M.preventDefault();var N=n.find("form").serializeForm();N.list_item.deadlineType=$(M.target).attr("data-deadline");N.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Update({send:N,successCallback:function(P,
U){F.hide("slow",function(){$(this).remove();b.selectedListItem.element.find(".handle").show();n.find(".list-item-content").html(U.list_item.body_rendered);n.find(".list-item-deadline").html(U.list_item.deadline_in_words);n.find(".handle").height(n.find(".list-item-content").height());L===false&&m(n);b.selectedListItem={element:n,data:U};n.data("data",U);b.listItemList.find(".row").show();n.focus()})},lists:b.selectedListItem.data.list_item.list_id,list_items:b.selectedListItem.data.list_item.id});
return false});F.find("#cancel-edit").bind("keydown click","return",function(M){M.preventDefault();b.selectedListItem.element.find(".handle").show();F.hide("slow",function(){$(this).remove();L===false&&m(n);b.listItemList.find(".row").show();n.focus()});return false});return false},lists:b.selectedListItem.data.list_item.list_id,list_items:b.selectedListItem.data.list_item.id})});n.bind("keydown","left",function(){b._trigger("SelectLastList",0,{})});n.bind("keydown","shift+return",function(){b.toolbar.find("#list-item-new").effect("puff",
{},300,function(){$(this).show();H()})});n.bind("keydown","l",function(){b.toolbar.find("#list-item-fullsize").effect("puff",{},300,function(){b.toolbar.find("#list-item-fullsize").trigger("click");$(this).show()});return false});ListKungFu&&ListKungFu.LayoutCenter&&n.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+n.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,
left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingListItem",0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});q(n)},m=function(l){if(l.data("isFullsize")===true){q(l,false);l.data("isFullsize",false);b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"})}else{q(l,true);l.data("isFullsize",true);b.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"})}},
q=function(l,r){l.height()>150&&!r?l.height(150):l.height("auto");w()},t=function(l,r){ListListItem.Destroy({successCallback:function(){l.hide("slow",function(){var u=l.next(".row");u.length>0||(u=l.prev(".row"));u.focus();l.remove();b.toolbar.find("#list-item-search").trigger("ClearValue")})},lists:r.list_item.list_id,list_items:r.list_item.id})},p=function(l,r){r.list_item.completed=true;ListListItem.Update({successCallback:function(){var u="list-item-undo-"+r.list_item.id;l.find(".list-item-wrapper").hide("slow",
function(){var n=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');n.bind("click",function(){G(l,r,u)});l.append(n);q(l);n.delay(5E3,u).queue(u,function(){l.hide("slow",function(){l.remove()})}).dequeue(u);b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&C(true);l.focus()})},lists:r.list_item.list_id,list_items:r.list_item.id,send:r})},G=function(l,r,u){u!==""&&l.clearQueue(u);r.list_item.completed=false;ListListItem.Update({successCallback:function(){l.find(".undo").hide("slow",
function(){$(this).remove()});l.find(".list-item-wrapper").show("slow",function(){q(l)});b.toolbar&&b.toolbar.find("#showCompleted").get(0).checked===true&&C(true)},lists:r.list_item.list_id,list_items:r.list_item.id,send:r})},C=function(l){if(l===true){if(b.completedList){b.completedList.remove();b.completedList=null}b.completedList=$('<div id="completedList"></div>');l=b.element.data("data-list");ListListItem.Index({successCallback:function(r,u){$.each(u,function(n,D){b.completedList.append("<div>"+
D.list_item.body_rendered+"</div>")});u.length===0&&b.completedList.append("<div>No completed items</div>");b.wrapper.prepend(b.completedList)},send:{show:"completed"},lists:l.list.id})}else{b.completedList.remove();b.completedList=null}},K=function(){b.header.html("");b.toolbar=$('<div id="list-item-toolbar"> \t\t\t\t<div id="list-name"></div><div id="list-item-toolbar-buttons"> \t\t\t\t<button id="list-item-completed">Completed [space]</button> \t\t\t\t<button id="list-item-new">Create [shift+return]</button> \t\t\t\t<button id="list-item-delete">Delete [del]</button> \t\t\t\t<button id="list-item-edit">Edit [return]</button> \t\t\t\t<button id="list-item-fullsize">Fullsize [l]</button> \t\t\t\t<input type="input" id="list-item-search"/> \t\t\t\t<input type="checkbox" id="showCompleted"/> \t\t\t\t<label for="showCompleted">Show Completed Items</label> \t\t\t\t<div id="list-item-search-cancel">&nbsp;</div> \t\t\t\t</div></div>');
b.listName=b.toolbar.find("#list-name");b.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});b.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});b.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.toolbar.find("#list-item-fullsize").button({text:false,icons:{primary:"ui-icon-zoomin"}});b.toolbar.find("#list-item-new").bind("click",
function(){H()});b.toolbar.find("#showCompleted").bind("change",function(l){C(l.target.checked);b.selectedListItem.element.focus()});b.toolbar.find("#list-item-completed").bind("click",function(){p(b.selectedListItem.element,b.selectedListItem.data)});b.toolbar.find("#list-item-delete").bind("click",function(){var l=function(){t(b.selectedListItem.element,b.selectedListItem.data)};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List Item",l,"Cancel","Do you really want to delete?");
b.deleteDialog.dialog("open")});b.toolbar.find("#list-item-edit").bind("click",function(){b.selectedListItem.element.trigger("dblclick")});b.toolbar.find("#list-item-fullsize").bind("click",function(){m(b.selectedListItem.element)});b.toolbar.find("#list-item-search").bind("keyup",function(){var l=$(this).val();if(l==="")b.listItemList.find(".row").show();else{b.listItemList.find(".row:not(:Contains('"+l+"'))").hide();b.listItemList.find(".row:Contains('"+l+"')").show()}});b.toolbar.find("#list-item-search-cancel").bind("click",
function(){b.toolbar.find("#list-item-search").val("").trigger("keyup")});b.toolbar.find("#list-item-search").bind("ClearValue",function(l){$(l.target).val("");b.listItemList.find(".row").show()});b.header.append(b.toolbar)},H=function(){var l=b.element.data("data-list");ListListItem.New({successCallback:function(r){var u=$(r);b.listItemList.prepend(u);j(u);k();u.find("textarea").markItUp(mySettings);u.find("textarea").focus();b.listItemList.find(".row").hide();u.find("#cancel-edit").bind("click",
function(n){n.preventDefault();u.hide("slow",function(){$(this).remove();b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus()})});u.find(".deadline-button").bind("click",function(n){n.preventDefault();var D=u.serializeForm();D.list_item.body=D.list_item.body.replace(/\n/g,"\n\n");D.list_item.deadlineType=$(n.target).attr("data-deadline");D.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:D,successCallback:function(F,L){u.hide("slow",
function(){g(L,F,true);$(this).remove();b.toolbar.find("#list-item-search").trigger("ClearValue");b.listItemList.find(".row").show();b.listItemList.find(".row").first().focus();b.listItemList.find(".row").first().find(".handle").height(b.listItemList.find(".row").first().find(".list-item-content").height())})},lists:l.list.id});return false});u.find("textarea").bind("keydown","esc",function(){u.find("#cancel-edit").trigger("click")})},lists:l.list.id})};return{options:{},_create:function(){b=this;
b.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');b.listItemList=$('<div id="list-item-list"></div>');b.header=$('<div class="header"></div>');b.element.append(b.header);b.element.append(b.wrapper);b.wrapper.append(b.listItemList);w();$(document).bind("keydown","c",function(){var l=b.toolbar.find("#showCompleted");if(l.length>0){if(l.get(0).checked===true)l.get(0).checked=false;else l.get(0).checked=true;l.trigger("change")}});$(document).bind("keyup","f",function(){b.toolbar.find("#list-item-search").focus()})},
destroy:function(){b.children().remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},RemoveList:function(){b.wrapper.remove();b.header.remove();$(document).unbind("keydown","c");$(document).unbind("keyup","f")},OpenList:function(l){b.RemoveList();b._create();b.element.data("data-list",l);ListListItem.Index({successCallback:function(r,u){K();$.each(u,function(n,D){g(D,r)});l.id?b.listItemList.find(".row").each(function(){var n=$(this);if(n.data("data").list_item.id===l.id){n.focus();
return false}}):b.listItemList.find(".row").first().focus();b.listItemList.find(".row").length===0&&H();b.listName.text(l.list.title)},lists:l.list.id});b._trigger("ReinitPanes",0,{})},SelectListItem:function(){b.selectedListItem?b.selectedListItem.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):b.listItemList.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})}}}();$.widget("ui.ListItemView",h)})();
(function(){var h=function(){var b=null,w={activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(){$(this).position().top<b.wrapper.height()&&alert("dropped")}},j=function(l){return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(r,u){if($(this).position().top<b.wrapper.height()){var n=u.draggable.data("data"),D=$(this).data("data");n={list_item:{body:n.list_item.body.replace(/\n/g,"\n\n")}};ListListItem.Create({send:n,
successCallback:function(){$(r.target).find(".fake-drop").remove();l.effect("highlight",{},3E3)},lists:D.list.id})}},over:function(r,u){var n=$('<div class="fake-drop"></div>');n.html("<p>"+u.helper.text()+"</p>");$(r.target).append(n)},out:function(r){$(r.target).find(".fake-drop").remove()}}},k=function(l,r){for(var u in r){var n=r[u],D;for(D in n){for(var F=n[D],L=$('<div class="error_explanation"><ul></ul></div>'),M=L.find("ul"),N=l.find("*[name="+(u+"["+D+"]")+"]"),P=0;P<F.length;P++){N.parent(".field").addClass("field_with_errors");
M.append("<li>"+F[P]+"</li>")}N.parent(".field").append(L)}}},g=function(l){l.find(".field").removeClass("field_with_errors");l.find(".error_explanation").remove()},m=function(l){var r=b.selectedList.element.next(),u=b.selectedList.element.prev();l=l||0;List.Destroy({successCallback:function(){b.selectedList.element.delay(l).fadeOut(function(){$(this).remove();r.length>0?r.focus():u.focus()});b._trigger("CloseList",0,{})},lists:b.selectedList.data.list.id})},q=function(){var l=$('<div id="list-toolbar"> \t\t\t\t<button id="list-new">Create [shift+return]</button> \t\t\t\t<button id="list-delete">Delete [del]</button> \t\t\t\t<button id="list-edit">Edit [space]</button> \t\t\t\t<input type="text" id="search-list" /> \t\t\t\t<div id="list-search-cancel">&nbsp;</div> \t\t\t\t</div>');
b.element.find("div.header").append(l);l.find("#list-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});l.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});l.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});l.find("#list-delete").bind("click",function(r){if(b.selectedList!==null){if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete List",function(){if(b.listForm!==null){b.listForm.bind("FormHidden",function(){m(1E3)});
H()}else m()},"Cancel","Do you really want to delete?");b.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();$(r.target).blur();return false});l.find("#list-new").bind("click",function(r){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.New({successCallback:function(u,
n){b.listForm.append(u);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b._trigger("CloseList",0,{});b.listForm.find("#list-back-button").bind("click",function(){H()});b.listForm.find("#list_title").bind("keydown","esc",function(){H()});b.listForm.bind("submit",function(D){D.preventDefault();D=$(this).find("form").serializeForm();n.list=D.list;List.Create({send:n,successCallback:function(F,L,M,N,P){g(b.listForm);if(P===false){H(L,F);b.toolbar.find("#search-list").trigger("ClearValue")}else k(b.listForm,
P)}})});b.selectedList=null}})});$(r.target).blur();return false});l.find("#search-list").bind("keyup",function(){var r=$(this).val();if(r==="")b.listlist.find(".row").show();else{b.listlist.find(".row:not(:Contains('"+r+"'))").hide();b.listlist.find(".row:Contains('"+r+"')").show()}});l.find("#list-search-cancel").bind("click",function(){l.find("#search-list").val("").trigger("keyup")});l.find("#search-list").bind("ClearValue",function(r){$(r.target).val("");b.listlist.find(".row").show()});l.find("#list-edit").bind("click",
function(){b.listlist.hide("slide",{direction:"left"},"slow",function(){if(b.listForm!=null){b.listForm.remove();b.listForm=null}b.listForm=$('<div class="ui-layout-content" id="list-form"></div>');b.wrapper.append(b.listForm);List.Edit({successCallback:function(r){b.listForm.append(r);b.listForm.show("slide",{direction:"left"},"slow",function(){b.listForm.find("#list_title").first().focus()});b.listForm.find("#list-back-button").bind("click",function(){H()});b.listForm.find("#list_title").bind("keydown",
"esc",function(){H()});b.listForm.bind("submit",function(u){u.preventDefault();u=$(this).find("form").serializeForm();List.Update({send:u,successCallback:function(n,D,F,L,M){g(b.listForm);M===false?H(D,n):k(b.listForm,M)},lists:b.selectedList.data.list.id});return false})},lists:b.selectedList.data.list.id})})});return l},t=function(l,r){var u=$($.mustache(r,l.list));u.attr("tabindex",0);u.data("data",l);u.addClass("row");u.bind("keydown","down",function(n){n.preventDefault();$(n.target).nextAll("div:visible").first().focus();
return false});u.bind("keydown","up",function(n){n.preventDefault();$(n.target).prevAll("div:visible").first().focus();return false});u.bind("focus",function(n){b.listlist.find(".row").removeClass("selected-row");$(n.target).addClass("selected-row");b.selectedList={element:$(n.target),data:$(n.target).data("data")}});u.bind("keydown dblclick","return",function(n){b._trigger("OpenList",0,{selectedList:$(n.target).parent().andSelf().filter(".row").data("data")})});u.bind("keydown","right",function(){b._trigger("SelectListItem",
0,{})});u.bind("keydown","shift+return",function(){b.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});u.bind("keydown","del",function(){b.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});u.bind("keydown","space",function(){b.toolbar.find("#list-edit").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});u.droppable(j(u));return u},p=function(){b.listlist.find(".row").each(function(){var l=
$(this),r=l.find(".list-tag");l=l.find(".list-name");r.height(l.height()+10+"px")})},G=function(){b.selectedList?b.selectedList.element.effect("highlight",{},300,function(){$(this).show();$(this).focus()}):b.listlist.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})},C=function(){$(document).bind("keydown","ctrl+l",function(){G()});$(document).bind("keydown","ctrl+f",function(){b.toolbar.find("#search-list").focus()});$(document).bind("keydown","shift+f",function(){b.toolbar.find("#search-list").focus();
return false})},K=function(l,r){b.listlist.show("slide",{direction:"left"},"slow",function(){if(l){var u=t(l,r);b.selectedList===null||b.selectedList.data.list.id!==l.list.id?b.listlist.prepend(u):b.selectedList.element.replaceWith(u);p();b.selectedList={data:l,element:u}}b.selectedList&&b.selectedList.element.focus()})},H=function(l,r){b.listForm.hide("slide",{direction:"left"},"slow",function(){K(l,r);b.listForm.trigger("FormHidden");b.selectedList?b.selectedList.element.focus():b.listlist.find(".row").first().focus();
b.listForm.remove();b.listForm=null})};return{options:{},selectedList:null,_create:function(){b=this;b.wrapper=b.element.find("div#list-wrapper");b.toolbar=q(b);b.listForm=null;List.Index({successCallback:function(l,r){b.wrapper.find(".row").remove();b.listlist=$('<div id="list-list"></div>');b.wrapper.append(b.listlist);for(var u=0;u<r.length;u++)b.listlist.append(t(r[u],l));p();b._trigger("ContentDimensionsChanged",0,{});b.listlist.find(".row").first().focus()}});C()},SetupDroppable:function(l){b.listlist.find(".row").each(function(){var r=
$(this);r.droppable("destroy");switch(l){case "listitem":r.droppable(j(r));break;case "tag":r.droppable(w)}})},SelectList:function(){G()},destroy:function(){b.toolbar.remove();b.listForm.remove();b.wrapper.find(".row").remove()}}}();$.widget("ui.ListView",h)})();(function(h){h.fn.serializeForm=function(){var b=h(this).find('*[name*="]"]'),w={};h.each(b,function(j,k){var g=h(k),m=g.get(0).name.split("[")[0],q=g.get(0).name.split("[")[1];q=q.replace("]","");g=g.val();w[m]=w[m]||{};w[m][q]=g});return w}})(jQuery);
(function(){var h=function(){return{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b);this.notice.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}}}();$.widget("ui.StatusBar",h)})();if(!this.JSON)this.JSON={};
(function(){function h(p){return p<10?"0"+p:p}function b(p){k.lastIndex=0;return k.test(p)?'"'+p.replace(k,function(G){var C=q[G];return typeof C==="string"?C:"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+p+'"'}function w(p,G){var C,K,H,l,r=g,u,n=G[p];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(p);if(typeof t==="function")n=t.call(G,p,n);switch(typeof n){case "string":return b(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";g+=m;u=[];if(Object.prototype.toString.apply(n)==="[object Array]"){l=n.length;for(C=0;C<l;C+=1)u[C]=w(C,n)||"null";H=u.length===0?"[]":g?"[\n"+g+u.join(",\n"+g)+"\n"+r+"]":"["+u.join(",")+"]";g=r;return H}if(t&&typeof t==="object"){l=t.length;for(C=0;C<l;C+=1){K=t[C];if(typeof K==="string")if(H=w(K,n))u.push(b(K)+(g?": ":":")+H)}}else for(K in n)if(Object.hasOwnProperty.call(n,K))if(H=w(K,n))u.push(b(K)+(g?": ":":")+H);H=u.length===0?"{}":g?"{\n"+g+u.join(",\n"+g)+
"\n"+r+"}":"{"+u.join(",")+"}";g=r;return H}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
k=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,m,q={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;if(typeof JSON.stringify!=="function")JSON.stringify=function(p,G,C){var K;m=g="";if(typeof C==="number")for(K=0;K<C;K+=1)m+=" ";else if(typeof C==="string")m=C;if((t=G)&&typeof G!=="function"&&(typeof G!=="object"||typeof G.length!=="number"))throw Error("JSON.stringify");return w("",
{"":p})};if(typeof JSON.parse!=="function")JSON.parse=function(p,G){function C(H,l){var r,u,n=H[l];if(n&&typeof n==="object")for(r in n)if(Object.hasOwnProperty.call(n,r)){u=C(n,r);if(u!==undefined)n[r]=u;else delete n[r]}return G.call(H,l,n)}var K;p=String(p);j.lastIndex=0;if(j.test(p))p=p.replace(j,function(H){return"\\u"+("0000"+H.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(p.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){K=eval("("+p+")");return typeof G==="function"?C({"":K},""):K}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var h=function(){};h.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(b,w,j,k){if(!k){this.context=w;this.buffer=[]}if(!this.includes("",b))if(k)return b;else{this.send(b);return}b=this.render_pragmas(b);b=this.render_section(b,w,j);if(k)return this.render_tags(b,w,j,k);this.render_tags(b,w,j,k)},send:function(b){b!=""&&this.buffer.push(b)},render_pragmas:function(b){if(!this.includes("%",b))return b;
var w=this;return b.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(j,k,g){if(!w.pragmas_implemented[k])throw{message:"This implementation of mustache doesn't understand the '"+k+"' pragma"};w.pragmas[k]={};if(g){j=g.split("=");w.pragmas[k][j[0]]=j[1]}return""})},render_partial:function(b,w,j){b=this.trim(b);if(!j||j[b]===undefined)throw{message:"unknown_partial '"+b+"'"};if(typeof w[b]!="object")return this.render(j[b],w,j,true);return this.render(j[b],w[b],j,true)},render_section:function(b,
w,j){if(!this.includes("#",b)&&!this.includes("^",b))return b;var k=this;return b.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(g,m,q,t){g=k.find(q,w);if(m=="^")return!g||k.is_array(g)&&g.length===0?k.render(t,w,j,true):"";else if(m=="#")return k.is_array(g)?k.map(g,function(p){return k.render(t,k.create_context(p),j,true)}).join(""):k.is_object(g)?k.render(t,k.create_context(g),j,true):typeof g==="function"?
g.call(w,t,function(p){return k.render(p,w,j,true)}):g?k.render(t,w,j,true):""})},render_tags:function(b,w,j,k){var g=this,m=function(){return RegExp(g.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+g.ctag+"+","g")},q=m(),t=function(G,C,K){switch(C){case "!":return"";case "=":g.set_delimiters(K);q=m();return"";case ">":return g.render_partial(K,w,j);case "{":return g.find(K,w);default:return g.escape(g.find(K,w))}};b=b.split("\n");for(var p=0;p<b.length;p++){b[p]=b[p].replace(q,t,this);k||this.send(b[p])}if(k)return b.join("\n")},
set_delimiters:function(b){b=b.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(b){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return b.replace(arguments.callee.sRE,"\\$1")},find:function(b,w){b=this.trim(b);var j;if(w[b]===false||w[b]===0||w[b])j=w[b];else if(this.context[b]===false||this.context[b]===0||this.context[b])j=this.context[b];if(typeof j==="function")return j.apply(w);
if(j!==undefined)return j;return""},includes:function(b,w){return w.indexOf(this.otag+b)!=-1},escape:function(b){return String(b===null?"":b).replace(/&(?!\w+;)|["<>\\]/g,function(w){switch(w){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return w}})},create_context:function(b){if(this.is_object(b))return b;else{var w=".";if(this.pragmas["IMPLICIT-ITERATOR"])w=this.pragmas["IMPLICIT-ITERATOR"].iterator;var j={};j[w]=b;return j}},
is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(b,w){if(typeof b.map=="function")return b.map(w);else{for(var j=[],k=b.length,g=0;g<k;g++)j.push(w(b[g]));return j}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(b,w,j,k){var g=new h;if(k)g.send=k;g.render(b,w,j);if(!k)return g.buffer.join("\n")}}}();
(function(h){h.mustache=function(b,w,j){return Mustache.to_html(b,w,j)}})(jQuery);
(function(h){h.fn.layout=function(b){function w(c){if(!c)return true;var d=c.keyCode;if(d<33)return true;var e={38:"north",40:"south",37:"west",39:"east"},f=d>=37&&d<=40,i=c.shiftKey,s=c.ctrlKey,y=false,v,A,x;if(!s&&!i)return true;else if(f&&p[e[d]].enableCursorHotkey)y=e[d];else h.each(z.borderPanes.split(","),function(B,I){v=p[I];A=v.customHotkey;x=v.customHotkeyModifier;if(i&&x=="SHIFT"||s&&x=="CTRL"||s&&i)if(A&&d==(isNaN(A)||A<=9?A.toUpperCase().charCodeAt(0):A)){y=I;return false}});if(!y)return true;
v=p[y];e=C[y];if(!v.enableCursorHotkey||e.isHidden||!J[y])return true;if((e=c.target||c.srcElement)&&i&&f&&(e.tagName=="TEXTAREA"||e.tagName=="INPUT"&&(d==37||d==39)))return true;da(y);c.stopPropagation();return c.returnValue=false}function j(c){if(this&&this.tagName)c=this;c=typeof c=="string"?J[c]:h(c).attr("pane")?h(c):h(c).parents("div[pane]:first");if(c.length){var d=c.attr("pane"),e=C[d];e.cssSaved&&k(d);if(e.isSliding||e.isResizing||e.isClosed)e.cssSaved=false;else{var f={zIndex:z.zIndex.pane_normal+
1},i={},s=c.css("overflow"),y=c.css("overflowX"),v=c.css("overflowY");if(s!="visible"){i.overflow=s;f.overflow="visible"}if(y&&y!="visible"&&y!="auto"){i.overflowX=y;f.overflowX="visible"}if(v&&v!="visible"&&v!="auto"){i.overflowY=y;f.overflowY="visible"}e.cssSaved=i;c.css(f);h.each(z.allPanes.split(","),function(A,x){x!=d&&k(x)})}}}function k(c){if(this&&this.tagName)c=this;c=typeof c=="string"?J[c]:h(c).hasClass("ui-layout-pane")?h(c):h(c).parents("div[pane]:first");if(c.length){var d=c.attr("pane");
d=C[d];var e=d.cssSaved||{};!d.isSliding&&!d.isResizing&&c.css("zIndex",z.zIndex.pane_normal);c.css(e);d.cssSaved=false}}function g(c,d,e){var f=h(c);if(f.length)if(z.borderPanes.indexOf(d)==-1)alert("Error Adding Button \n\nInvalid pane: "+d);else{c=p[d].buttonClass+"-"+e;f.addClass(c+" "+c+"-"+d);return f}else alert("Error Adding Button \n\nInvalid selector: "+c);return false}function m(c,d){h.each(z[c].pins,function(e,f){q(h(f),c,d)})}function q(c,d,e){var f=c.attr("pin");if(!(f&&e==(f=="down"))){var i=
p[d].buttonClass+"-pin",s=i+"-"+d;d=i+"-up";f=s+"-up";i+="-down";s+="-down";c.attr("pin",e?"down":"up").attr("title",e?"Un-Pin":"Pin").removeClass(e?d:i).removeClass(e?f:s).addClass(e?i:d).addClass(e?s:f)}}var t={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},p={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:t.contentSelector,contentIgnoreSelector:t.contentIgnoreSelector,paneClass:t.paneClass,resizerClass:t.resizerClass,togglerClass:t.togglerClass,buttonClass:t.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},G={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},C={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},K={north:"south",south:"north",east:"west",west:"east"},H=function(c){if(typeof c=="string")return true;else if(typeof c=="object")try{return c.constructor.toString().match(/string/i)!==null}catch(d){}return false},l=function(c){return typeof c=="string"||H(c)?h.trim(c):c},r=function(c,d){return Math.max(c,d)},u=function(c){var d={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};c=c||{};if(c.effects||
c.defaults||c.north||c.south||c.west||c.east||c.center)d=h.extend(d,c);else h.each(c,function(e,f){a=e.split("__");d[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=f});return d},n=function(c,d,e){function f(y){s=z[y];if(s.doCallback){cpPane=s.callback.split(",")[1];cpPane!=y&&cpPane!=d&&f(cpPane,true)}else{s.doCallback=true;s.callback=i}}var i=c+","+d+","+(e?1:0),s;h.each(z.borderPanes.split(","),function(y,v){if(z[v].isMoving){f(v);return false}})},D=function(c){c=z[c];z.isLayoutBusy=false;delete c.isMoving;
if(c.doCallback&&c.callback){c.doCallback=false;var d=c.callback.split(","),e=d[2]>0?true:false;if(d[0]=="open")X(d[1],e);else d[0]=="close"&&V(d[1],e);if(!c.doCallback)c.callback=null}},F=function(c,d){if(d){var e;try{if(typeof d=="function")e=d;else if(typeof d!="string")return;else if(d.indexOf(",")>0){var f=d.split(",");e=eval(f[0]);if(typeof e=="function"&&f.length>1)return e(f[1])}else e=eval(d);if(typeof e=="function")return e(c,J[c],h.extend({},C[c]),h.extend({},p[c]),p.name)}catch(i){}}},
L=function(c,d){var e=0,f=false,i="";if(!h.browser.msie)if(h.curCSS(c[0],"display",true)=="none"){f=true;i=h.curCSS(c[0],"visibility",true);c.css({display:"block",visibility:"hidden"})}e=parseInt(h.curCSS(c[0],d,true),10)||0;if(f){c.css({display:"none"});i&&i!="hidden"&&c.css({visibility:i})}return e},M=function(c,d){var e;if(H(c)){c=l(c);e=J[c]}else e=h(c);if(d<=0)return 0;else d>0||(d=H(c)?P(c):e.outerWidth());return h.boxModel?d-L(e,"paddingLeft")-L(e,"paddingRight")-(h.curCSS(e[0],"borderLeftStyle",
true)=="none"?0:L(e,"borderLeftWidth"))-(h.curCSS(e[0],"borderRightStyle",true)=="none"?0:L(e,"borderRightWidth")):d},N=function(c,d){var e;if(H(c)){c=l(c);e=J[c]}else e=h(c);if(d<=0)return 0;else d>0||(d=H(c)?P(c):e.outerHeight());return h.boxModel?d-L(e,"paddingTop")-L(e,"paddingBottom")-(h.curCSS(e[0],"borderTopStyle",true)=="none"?0:L(e,"borderTopWidth"))-(h.curCSS(e[0],"borderBottomStyle",true)=="none"?0:L(e,"borderBottomWidth")):d},P=function(c,d){var e=J[c],f=p[c],i=C[c],s=d?f.spacing_open:
0;f=d?f.spacing_closed:0;return!e||i.isHidden?0:i.isClosed||i.isSliding&&d?f:z[c].dir=="horz"?e.outerHeight()+s:e.outerWidth()+s},U=function(c){var d=E,e=z[c].dir,f=C[c],i=J[K[c]],s=p[c].spacing_open,y=p[K[c]].spacing_open,v=!i?0:e=="horz"?i.outerHeight():i.outerWidth();i=f.minSize||0;e=Math.min(f.maxSize||9999,(e=="horz"?d.innerHeight:d.innerWidth)-s-v-y);var A,x;switch(c){case "north":A=d.offsetTop+i;x=d.offsetTop+e;break;case "west":A=d.offsetLeft+i;x=d.offsetLeft+e;break;case "south":A=d.offsetTop+
d.innerHeight-e;x=d.offsetTop+d.innerHeight-i;break;case "east":A=d.offsetLeft+d.innerWidth-e;x=d.offsetLeft+d.innerWidth-i}h.extend(f,{minSize:i,maxSize:e,minPosition:A,maxPosition:x})},ma=function(){var c={top:P("north",true),bottom:P("south",true),left:P("west",true),right:P("east",true),width:0,height:0};with(c){width=E.innerWidth-left-right;height=E.innerHeight-bottom-top;top+=E.top;bottom+=E.bottom;left+=E.left;right+=E.right}return c},na=function(c){var d={},e,f,i;h.each("Left,Right,Top,Bottom".split(","),
function(){e=l(this);f=d["border"+e]=L(c,"border"+e+"Width");i=d["padding"+e]=L(c,"padding"+e);d["offset"+e]=f+i;if(c==R)d[e.toLowerCase()]=h.boxModel?i:0});d.innerWidth=d.outerWidth=c.outerWidth();d.innerHeight=d.outerHeight=c.outerHeight();if(h.boxModel){d.innerWidth-=d.offsetLeft+d.offsetRight;d.innerHeight-=d.offsetTop+d.offsetBottom}return d},ra=function(c,d,e,f){var i=window.layout=window.layout||{};i=i.timers=i.timers||{};c="layout_"+C.id+"_"+c+"_"+d;i[c]||(i[c]=setTimeout(e,f))},ea=function(c,
d){var e=window.layout=window.layout||{};e=e.timers=e.timers||{};var f="layout_"+C.id+"_"+c+"_"+d;if(e[f]){clearTimeout(e[f]);delete e[f];return true}else return false},sa=function(){try{if(R[0].tagName=="BODY"){h("html").css({height:"100%",overflow:"hidden"});h("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var c={overflow:"hidden"},d=R.css("position"),e=R.css("height");if(!R.hasClass("ui-layout-pane")){if(!d||"fixed,absolute,relative".indexOf(d)<
0)c.position="relative";if(!e||e=="auto")c.height="100%"}R.css(c)}}catch(f){}E=C.container=na(R)},ta=function(){h.each(z.borderPanes.split(","),function(c,d){var e=p[d];if(e.enableCursorHotkey||e.customHotkey){h(document).keydown(w);return false}})},ua=function(){b=u(b);if(b.effects){h.extend(G,b.effects);delete b.effects}h.each("name,scrollToBookmarkOnLoad".split(","),function(e,f){if(b[f]!==undefined)p[f]=b[f];else if(b.defaults[f]!==undefined){p[f]=b.defaults[f];delete b.defaults[f]}});h.each("paneSelector,resizerCursor,customHotkey".split(","),
function(e,f){delete b.defaults[f]});h.extend(p.defaults,b.defaults);z.center=h.extend(true,{},z.defaults,z.center);h.extend(p.center,b.center);var c=h.extend(true,{},p.defaults,b.defaults,p.center);h.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(e,f){p.center[f]=c[f]});var d=p.defaults;h.each(z.borderPanes.split(","),function(e,f){z[f]=h.extend(true,{},z.defaults,z[f]);o=p[f]=h.extend(true,{},p.defaults,p[f],b.defaults,b[f]);if(!o.paneClass)o.paneClass=
t.paneClass;if(!o.resizerClass)o.resizerClass=t.resizerClass;if(!o.togglerClass)o.togglerClass=t.togglerClass;h.each(["_open","_close",""],function(i,s){var y="fxName"+s,v="fxSpeed"+s,A="fxSettings"+s;o[y]=b[f][y]||b[f].fxName||b.defaults[y]||b.defaults.fxName||o[y]||o.fxName||d[y]||d.fxName||"none";var x=o[y];if(x=="none"||!h.effects||!h.effects[x]||!G[x]&&!o[A]&&!o.fxSettings)x=o[y]="none";x=G[x]||{};y=x.all||{};x=x[f]||{};o[A]=h.extend({},y,x,d.fxSettings||{},d[A]||{},o.fxSettings,o[A],b.defaults.fxSettings,
b.defaults[A]||{},b[f].fxSettings,b[f][A]||{});o[v]=b[f][v]||b[f].fxSpeed||b.defaults[v]||b.defaults.fxSpeed||o[v]||o[A].duration||o.fxSpeed||o.fxSettings.duration||d.fxSpeed||d.fxSettings.duration||x.duration||y.duration||"normal"})})},oa=function(){h.each(z.allPanes.split(","),function(){var c=l(this),d=p[c],e=C[c],f=z[c].dir,i=d.size=="auto"||isNaN(d.size)?0:d.size,s=d.minSize||1,y=d.maxSize||9999,v=d.spacing_open||0,A=d.paneSelector,x={},B;Z[c]=false;if(A.substr(0,1)==="#")B=J[c]=R.find(A+":first");
else{B=J[c]=R.children(A+":first");B.length||(B=J[c]=R.children("form:first").children(A+":first"))}if(!B.length){J[c]=false;return true}B.attr("pane",c).addClass(d.paneClass+" "+d.paneClass+"-"+c);if(c!="center"){e.isClosed=false;e.isSliding=false;e.isResizing=false;e.isHidden=false;e.noRoom=false;z[c].pins=[]}x=h.extend({visibility:"visible",display:"block"},z.defaults.cssReq,z[c].cssReq);d.applyDefaultStyles&&h.extend(x,z.defaults.cssDef,z[c].cssDef);B.css(x);x={};switch(c){case "north":x.top=
E.top;x.left=E.left;x.right=E.right;break;case "south":x.bottom=E.bottom;x.left=E.left;x.right=E.right;break;case "west":x.left=E.left;break;case "east":x.right=E.right}if(f=="horz"){if(i===0||i=="auto"){B.css({height:"auto"});i=B.outerHeight()}i=r(i,s);i=Math.min(i,y);i=Math.min(i,E.innerHeight-v);x.height=r(1,N(c,i));e.size=i;e.maxSize=y;e.minSize=r(s,i-x.height+1);B.css(x)}else if(f=="vert"){if(i===0||i=="auto"){B.css({width:"auto","float":"left"});i=B.outerWidth();B.css({"float":"none"})}i=r(i,
s);i=Math.min(i,y);i=Math.min(i,E.innerWidth-v);x.width=r(1,M(c,i));e.size=i;e.maxSize=y;e.minSize=r(s,i-x.width+1);B.css(x);Y(c,null,true)}else if(c=="center"){B.css(x);Y("center",null,true)}if(d.initClosed&&d.closable){B.hide().addClass("closed");e.isClosed=true}else if(d.initHidden||d.initClosed){ha(c,true);e.isHidden=true}else B.addClass("open");d.showOverflowOnHover&&B.hover(j,k);if(d.contentSelector){e=Z[c]=B.children(d.contentSelector+":first");if(!e.length){Z[c]=false;return true}e.css(z.content.cssReq);
d.applyDefaultStyles&&e.css(z.content.cssDef);B.css({overflow:"hidden"})}})},va=function(){h.each(z.borderPanes.split(","),function(){var c=l(this),d=p[c],e=C[c],f=d.resizerClass,i=d.togglerClass,s=J[c];S[c]=false;aa[c]=false;if(!(!s||!d.closable&&!d.resizable)){var y=z[c].edge;s=s.is(":visible");var v="-"+c,A=s?"-open":"-closed",x;x=S[c]=h("<span></span>");s&&d.resizable||!s&&d.slidable&&x.attr("title",d.sliderTip).css("cursor",d.sliderCursor);x.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+
"-resizer":"").attr("resizer",c).css(z.resizers.cssReq).css(y,E[y]+P(c)).addClass(f+" "+f+v+" "+f+A+" "+f+v+A).appendTo(R);d.applyDefaultStyles&&x.css(z.resizers.cssDef);if(d.closable){f=aa[c]=h("<div></div>");f.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-toggler":"").css(z.togglers.cssReq).attr("title",s?d.togglerTip_open:d.togglerTip_closed).click(function(B){da(c);B.stopPropagation()}).mouseover(function(B){B.stopPropagation()}).addClass(i+" "+i+v+" "+i+A+" "+i+v+A).appendTo(x);
if(d.togglerContent_open)h("<span>"+d.togglerContent_open+"</span>").addClass("content content-open").css("display",e.isClosed?"none":"block").appendTo(f);if(d.togglerContent_closed)h("<span>"+d.togglerContent_closed+"</span>").addClass("content content-closed").css("display",e.isClosed?"block":"none").appendTo(f);d.applyDefaultStyles&&f.css(z.togglers.cssDef);s||ia(c,true)}}});ba("all",true)},wa=function(){var c=typeof h.fn.draggable=="function",d;h.each(z.borderPanes.split(","),function(){var e=
l(this),f=p[e],i=C[e];if(!c||!J[e]||!f.resizable){f.resizable=false;return true}var s=f.resizerClass,y=s+"-drag",v=s+"-"+e+"-drag",A=s+"-dragging",x=s+"-"+e+"-dragging",B=false,I=S[e];i.isClosed||I.attr("title",f.resizerTip).css("cursor",f.resizerCursor);I.draggable({containment:R[0],axis:z[e].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:f.resizerDragOpacity,zIndex:z.zIndex.resizing,start:function(){if(false===F(e,f.onresize_start))return false;i.isResizing=true;ea(e,"closeSlider");
I.addClass(y+" "+v);B=false;var O=e=="east"||e=="south"?f.spacing_open:0;U(e);i.minPosition-=O;i.maxPosition-=O;d=z[e].dir=="horz"?"top":"left";h(f.maskIframesOnResize===true?"iframe":f.maskIframesOnResize).each(function(){h('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(h(this).offset()).appendTo(this.parentNode)})},drag:function(O,Q){if(!B){h(".ui-draggable-dragging").addClass(A+
" "+x).children().css("visibility","hidden");B=true;i.isSliding&&J[e].css("zIndex",z.zIndex.sliding)}if(Q.position[d]<i.minPosition)Q.position[d]=i.minPosition;else if(Q.position[d]>i.maxPosition)Q.position[d]=i.maxPosition},stop:function(O,Q){var T=Q.position,W;I.removeClass(y+" "+v);switch(e){case "north":W=T.top;break;case "west":W=T.left;break;case "south":W=E.outerHeight-T.top-I.outerHeight();break;case "east":W=E.outerWidth-T.left-I.outerWidth()}ja(e,W-E[z[e].edge]);h("div.ui-layout-mask").remove();
i.isResizing=false}})})},ha=function(c,d){var e=p[c],f=C[c],i=J[c],s=S[c];if(!(!i||f.isHidden))if(false!==F(c,e.onhide_start)){f.isSliding=false;s&&s.hide();if(d||f.isClosed){f.isClosed=true;f.isHidden=true;i.hide();Y(z[c].dir=="horz"?"all":"center");F(c,e.onhide_end||e.onhide)}else{f.isHiding=true;V(c,false)}}},fa=function(c,d){var e=p[c],f=C[c],i=S[c];if(J[c]&&f.isHidden)if(false!==F(c,e.onshow_start)){f.isSliding=false;f.isShowing=true;i&&e.spacing_open>0&&i.show();d===false?V(c,true):X(c)}},da=
function(c){var d=C[c];if(d.isHidden)fa(c);else d.isClosed?X(c):V(c)},V=function(c,d,e){function f(){ia(c,true);Q||F(c,v.onclose_end||v.onclose);if(Q)F(c,v.onshow_end||v.onshow);if(T)F(c,v.onhide_end||v.onhide);D(c)}var i=J[c],s=S[c],y=aa[c],v=p[c],A=C[c];e=!e&&!A.isClosed&&v.fxName_close!="none";var x=z[c].edge,B=v.resizerClass,I=v.togglerClass,O="-"+c,Q=A.isShowing,T=A.isHiding;delete A.isShowing;delete A.isHiding;if(!(!i||!v.resizable&&!v.closable))if(!(!d&&A.isClosed&&!Q))if(z.isLayoutBusy)n("close",
c,d);else if(!(!Q&&false===F(c,v.onclose_start))){z[c].isMoving=true;z.isLayoutBusy=true;A.isClosed=true;if(T)A.isHidden=true;else if(Q)A.isHidden=false;m(c,false);A.isSliding||Y(z[c].dir=="horz"?"all":"center");if(s){s.css(x,E[x]).removeClass(B+"-open "+B+O+"-open").removeClass(B+"-sliding "+B+O+"-sliding").addClass(B+"-closed "+B+O+"-closed");v.resizable&&s.draggable("disable").css("cursor","default").attr("title","");y&&y.removeClass(I+"-open "+I+O+"-open").addClass(I+"-closed "+I+O+"-closed").attr("title",
v.togglerTip_closed);ba()}if(e){ga(c,true);i.hide(v.fxName_close,v.fxSettings_close,v.fxSpeed_close,function(){ga(c,false);A.isClosed&&f()})}else{i.hide();f()}}},X=function(c,d,e){function f(){A.isSliding||Y(z[c].dir=="vert"?"center":"all");if(s){s.css(x,E[x]+P(c)).removeClass(B+T+" "+B+O+T).addClass(B+Q+" "+B+O+Q).addClass(!A.isSliding?"":B+W+" "+B+O+W);v.resizable?s.draggable("enable").css("cursor",v.resizerCursor).attr("title",v.resizerTip):s.css("cursor","default");y&&y.removeClass(I+T+" "+I+
O+T).addClass(I+Q+" "+I+O+Q).attr("title",v.togglerTip_open);ba("all")}ca(c);m(c,!A.isSliding);F(c,v.onopen_end||v.onopen);if(ka)F(c,v.onshow_end||v.onshow);D(c)}var i=J[c],s=S[c],y=aa[c],v=p[c],A=C[c];e=!e&&A.isClosed&&v.fxName_open!="none";var x=z[c].edge,B=v.resizerClass,I=v.togglerClass,O="-"+c,Q="-open",T="-closed",W="-sliding",ka=A.isShowing;delete A.isShowing;if(!(!i||!v.resizable&&!v.closable))if(A.isClosed||A.isSliding)if(A.isHidden&&!ka)fa(c,true);else if(z.isLayoutBusy)n("open",c,d);else if(false!==
F(c,v.onopen_start)){z[c].isMoving=true;z.isLayoutBusy=true;A.isSliding&&!d&&la(c,false);A.isClosed=false;if(ka)A.isHidden=false;U(c);A.size>A.maxSize&&i.css(z[c].sizeType,r(1,z[c].dir=="horz"?N(c,A.maxSize):M(c,A.maxSize)));ia(c,false);if(e){ga(c,true);i.show(v.fxName_open,v.fxSettings_open,v.fxSpeed_open,function(){ga(c,false);A.isClosed||f()})}else{i.show();f()}}},ga=function(c,d){var e=J[c];if(d){e.css({zIndex:z.zIndex.animation});if(c=="south")e.css({top:E.top+E.innerHeight-e.outerHeight()});
else c=="east"&&e.css({left:E.left+E.innerWidth-e.outerWidth()})}else{C[c].isSliding||e.css({zIndex:z.zIndex.pane_normal});if(c=="south")e.css({top:"auto"});else c=="east"&&e.css({left:"auto"})}},ia=function(c,d){var e=p[c],f=S[c],i=e.slideTrigger_open;if(f&&e.slidable){if(i!="click"&&i!="dblclick"&&i!="mouseover")i="click";f[d?"bind":"unbind"](i,xa).css("cursor",d?e.sliderCursor:"default").attr("title",d?e.sliderTip:"")}},la=function(c,d){function e(y){ea(c,"closeSlider");y.stopPropagation()}var f=
p[c].slideTrigger_close,i=J[c],s=S[c];C[c].isSliding=d;ea(c,"closeSlider");i.css({zIndex:d?z.zIndex.sliding:z.zIndex.pane_normal});s.css({zIndex:d?z.zIndex.sliding:z.zIndex.resizer_normal});if(f!="click"&&f!="mouseout")f="mouseout";if(d){i.bind(f,pa);s.bind(f,pa);f="mouseout";i.bind("mouseover",e);s.bind("mouseover",e)}else{i.unbind(f);s.unbind(f);f="mouseout";i.unbind("mouseover");s.unbind("mouseover");ea(c,"closeSlider")}},xa=function(){var c=h(this).attr("resizer");if(C[c].isClosed){la(c,true);
X(c,true)}},pa=function(){function c(){la(e,false);f.isClosed||V(e)}var d=h(this),e=d.attr("pane")||d.attr("resizer");d=p[e];var f=C[e];f.isClosed||f.isResizing||(d.slideTrigger_close=="click"?c():ra(e,"closeSlider",c,300))},ja=function(c,d){var e=z[c].edge,f=z[c].dir,i=p[c],s=C[c],y=J[c],v=S[c];U(c);s.minSize=r(s.minSize,i.minSize);if(i.maxSize>0)s.maxSize=Math.min(s.maxSize,i.maxSize);d=r(d,s.minSize);d=Math.min(d,s.maxSize);s.size=d;v.css(e,d+E[e]);y.css(z[c].sizeType,r(1,z[c].dir=="horz"?N(c,
d):M(c,d)));s.isSliding||Y(f=="horz"?"all":"center");ba();ca(c);F(c,i.onresize_end||i.onresize)},Y=function(c,d,e){if(!c||c=="all")c="east,west,center";var f=ma();d&&h.extend(f,d);h.each(c.split(","),function(){if(J[this]){var i=l(this),s=p[i],y=C[i],v=J[i],A=S[i],x=true,B={};if(i=="center"){f=ma();B=h.extend({},f);B.width=r(1,M(i,B.width));B.height=r(1,N(i,B.height));x=B.width>1&&B.height>1;if(h.browser.msie&&(!h.boxModel||h.browser.version<7)){J.north&&J.north.css({width:M(J.north,E.innerWidth)});
J.south&&J.south.css({width:M(J.south,E.innerWidth)})}}else{B.top=f.top;B.bottom=f.bottom;B.height=r(1,N(i,f.height));x=B.height>1}if(x){v.css(B);if(y.noRoom){y.noRoom=false;if(y.isHidden)return;else fa(i,!y.isClosed)}if(!e){ca(i);F(i,s.onresize_end||s.onresize)}}else if(!y.noRoom){y.noRoom=true;if(!y.isHidden)if(e){v.hide();A&&A.hide()}else ha(i)}}})},ca=function(c){if(!c||c=="all")c=z.allPanes;h.each(c.split(","),function(){if(Z[this]){var d=l(this),e=p[d].contentIgnoreSelector,f=J[d];d=Z[d];var i=
d[0],s=N(f);f.children().each(function(){if(this!=i){var y=h(this);if(!e||!y.is(e))s-=y.outerHeight()}});if(s>0)s=N(d,s);s<1?d.hide():d.css({height:s}).show()}})},ba=function(c,d){if(!c||c=="all")c=z.borderPanes;h.each(c.split(","),function(){var e=l(this),f=p[e],i=C[e],s=J[e],y=S[e],v=aa[e];if(!(!s||!y||!f.resizable&&!f.closable)){var A=z[e].dir,x=i.isClosed?"_closed":"_open";e=f["spacing"+x];var B=f["togglerAlign"+x];x=f["togglerLength"+x];var I;if(e==0)y.hide();else{!i.noRoom&&!i.isHidden&&y.show();
if(A=="horz"){I=s.outerWidth();y.css({width:r(1,M(y,I)),height:r(1,N(y,e)),left:L(s,"left")})}else{I=s.outerHeight();y.css({height:r(1,N(y,I)),width:r(1,M(y,e)),top:E.top+P("north",true)})}if(v){if(x==0||i.isSliding&&f.hideTogglerOnSlide){v.hide();return}else v.show();if(!(x>0)||x=="100%"||x>I){x=I;s=0}else if(typeof B=="string")switch(B){case "top":case "left":s=0;break;case "bottom":case "right":s=I-x;break;default:s=Math.floor((I-x)/2)}else{s=parseInt(B);s=B>=0?s:I-x+s}I=f.togglerContent_open?
v.children(".content-open"):false;var O=f.togglerContent_closed?v.children(".content-closed"):false;B=i.isClosed?O:I;if(I)I.css("display",i.isClosed?"none":"block");if(O)O.css("display",i.isClosed?"block":"none");if(A=="horz"){i=M(v,x);v.css({width:r(0,i),height:r(1,N(v,e)),left:s});B&&B.css("marginLeft",Math.floor((i-B.outerWidth())/2))}else{i=N(v,x);v.css({height:r(0,i),width:r(1,M(v,e)),top:s});B&&B.css("marginTop",Math.floor((i-B.outerHeight())/2))}}if(d&&f.initHidden){y.hide();v&&v.hide()}}}})},
qa=function(){var c=E.innerWidth,d=E.innerHeight;E=C.container=na(R);var e=E.innerHeight<d,f=E.innerWidth<c,i,s;if(e||f)h.each(["south","north","east","west"],function(y,v){i=C[v];s=z[v].dir;if(!i.isClosed&&(e&&s=="horz"||f&&s=="vert")){U(v);i.size>i.maxSize&&ja(v,i.maxSize)}});Y("all");ba("all")},R=h(this).css({overflow:"hidden"}),J={},Z={},S={},aa={},z={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},E=C.container;(function(){ua();sa();oa();va();wa();ca("all");if(p.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();h(window).resize(function(){var c="timerLayout_"+C.id;window[c]&&clearTimeout(window[c]);window[c]=null;window[c]=setTimeout(qa,100)})})();return{options:p,state:C,panes:J,toggle:da,open:X,close:V,hide:ha,show:fa,resizeContent:ca,sizePane:ja,reinitPane:oa,resizeAll:qa,addToggleBtn:function(c,d){var e=
g(c,d,"toggle");if(e)e.attr("title",C[d].isClosed?"Open":"Close").click(function(f){da(d);f.stopPropagation()})},addOpenBtn:function(c,d){var e=g(c,d,"open");e&&e.attr("title","Open").click(function(f){X(d);f.stopPropagation()})},addCloseBtn:function(c,d){var e=g(c,d,"close");e&&e.attr("title","Close").click(function(f){V(d);f.stopPropagation()})},addPinBtn:function(c,d){var e=g(c,d,"pin");if(e){var f=C[d];e.click(function(i){q(h(this),d,f.isSliding||f.isClosed);f.isSliding||f.isClosed?X(d):V(d);
i.stopPropagation()});q(e,d,!f.isClosed&&!f.isSliding);z[d].pins.push(c)}},allowOverflow:j,resetOverflow:k,cssWidth:M,cssHeight:N}}})(jQuery);
(function(){var h=function(){var b=null,w=function(j,k){var g=$($.mustache(k,j.tag));g.data("data",j);g.find(".tag-menu").hide();g.find(".color-selector").bind("click",function(m){var q=b.tagList.find(".tag-menu");m=$(m.target);if(q.data("visible")===true&&q.data("tagId")===j.tag.id){q.hide("fast");q.data("visible",false);q.data("tagId",null);q.data("tag",null);q.data("target",null)}else{q.show("fast");q.css({left:g.position().left,top:g.position().top-100});q.data("visible",true);q.data("tagId",
j.tag.id);q.data("tag",j);q.data("target",m)}});ListKungFu&&ListKungFu.LayoutWest&&g.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});return g};return{options:{},_create:function(){b=this;b.toolbar=$('<div id="tag-toolbar"></div>');b.addTagInput=$('<input type="text" value="" id="add-tag"/>');
b.addTagButton=$('<button id="tag-new">Create Tag</button>');b.tagList=$('<div class="tags"></div>');b.element.append(b.toolbar);b.toolbar.append(b.addTagInput);b.toolbar.append(b.addTagButton);b.element.append(b.tagList);b.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});Tag.Index({successCallback:function(j,k){for(var g=0;g<k.length;g++)b.tagList.append(w(k[g],j));var m=b.tagList.find(".tag-menu").first();b.tagList.find(".tag-menu").remove();b.tagList.append(m);m.find(".color").bind("click",
function(q){var t=$(q.target).attr("data-colorclass");q=m.data("tag");var p=q.tag.color_class,G=m.data("target");q.tag.color_class=t;Tag.Update({send:q,successCallback:function(C,K){G.parent(".tag").removeClass(p);G.parent(".tag").addClass(t);G.removeClass(p);G.addClass(t);m.hide("fast");m.data("visible",false);m.data("tagId",null);m.data("tag",null);m.data("target",null);G.data("data",K)},tags:q.tag.id})});m.find(".delete-label").bind("click",function(){var q=m.data("tag"),t=m.data("target");m.hide();
var p=function(){Tag.Destroy({successCallback:function(){t.hide("fast",function(){t.parent(".tag").remove()})},tags:q.tag.id})};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete Tag",p,"Cancel","Delete Tag and remove it from all lists?");b.deleteDialog.dialog("open");return false})}});b.addTagButton.bind("click",function(){if($.trim(b.addTagInput.val())!==""&&b.tagList.find(".tag-name:HasExactValue('"+$.trim(b.addTagInput.val())+"')").length===0){var j={};j.tag={name:b.addTagInput.val(),
color_class:"c1"};Tag.Create({send:j,successCallback:function(k,g){var m=w(g,k);b.tagList.prepend(m);b.addTagInput.val("");b.addTagInput.trigger("keyup")}});return false}});b.addTagInput.bind("keyup","return",function(){b.addTagButton.trigger("click")});b.addTagInput.bind("keyup",function(){var j=$(this).val();if(j==="")b.tagList.find(".tag").show();else{b.tagList.find(".tag:not(:Contains('"+j+"'))").hide();b.tagList.find(".tag:Contains('"+j+"')").show()}b.tagList.find(".tag-name:HasExactValue('"+
$.trim(j)+"')").length>0?b.addTagButton.button("option","disabled",true):b.addTagButton.button("option","disabled",false)})},destroy:function(){b.element.children().remove()}}}();$.widget("ui.TagView",h)})();
