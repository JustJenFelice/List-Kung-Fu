var ListKungFu={LayoutWest:$("#mainlayout-west"),LayoutNorth:$("#mainlayout-north"),LayoutEast:$("#mainlayout-east"),LayoutSouth:$("#mainlayout-south"),LayoutCenter:$("#mainlayout-center")};jQuery.expr[":"].Contains=function(c,b,j){return jQuery(c).text().toLowerCase().indexOf(j[3].toLowerCase())>=0};jQuery.expr[":"].HasExactValue=function(c,b,j){return jQuery.trim(jQuery(c).text().toLowerCase())===j[3].toLowerCase()};
$(document).ready(function(){ListKungFu.MainLayout=$("body").layout({defaults:{contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},north:{maxSize:92,minSize:92},south:{minSize:40},west:{minSize:300},east:{minSize:100,initClosed:true},center:{minSize:300}});ListKungFu.LayoutSouth.StatusBar();ListKungFu.LayoutCenter.ListItemView({SelectLastList:function(){ListKungFu.LayoutWest.ListView("SelectList")},ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},
ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},StartedDraggingListItem:function(c,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)}});ListKungFu.LayoutWest.ListView({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("west")},OpenList:function(c,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)},CloseList:function(){ListKungFu.LayoutCenter.ListItemView("RemoveList")},SelectListItem:function(){ListKungFu.LayoutCenter.ListItemView("SelectListItem")}});
ListKungFu.LayoutCenter.Dashboard({ContentDimensionsChanged:function(){ListKungFu.MainLayout.resizeContent("center")},ReinitPanes:function(){ListKungFu.MainLayout.reinitPane()},OpenList:function(c,b){ListKungFu.LayoutCenter.Dashboard("Hide");ListKungFu.LayoutCenter.ListItemView("OpenList",b.selectedList)}});ListKungFu.LayoutWest.find("#tags").TagView({StartedDraggingTag:function(c,b){ListKungFu.LayoutWest.ListView("SetupDroppable",b.dragType)},AfterColorChanged:function(){ListKungFu.LayoutWest.ListView("ReloadLists")},
TagSelected:function(c,b){ListKungFu.LayoutWest.ListView("FilterByTags",b)}});$("#dashboard").bind("click",function(){ListKungFu.LayoutCenter.ListItemView("RemoveList");ListKungFu.LayoutCenter.Dashboard("Show");return false});$("#dashboard").trigger("click")});
var Controller=function(c){var b={},j=function(e){var i=$(e).length>0?{}:false;$(e).each(function(h,m){var n=$(m).attr("model"),q=$(m).attr("field"),p=$(m).text();i[n]=i[n]||{};i[n][q]=i[n][q]||[];i[n][q].push(p)});return i};b.ClearFlash=function(){b.flash={notice:"",error:"",warning:"",message:""}};b.ClearFlash();b.SetFlash=function(e){b.flash.notice=e.getResponseHeader("X-Flash-Notice")||"";b.flash.error=e.getResponseHeader("X-Flash-Error")||"";b.flash.warning=e.getResponseHeader("X-Flash-Warning")||
"";b.flash.message=e.getResponseHeader("X-Flash-Message")||"";if(typeof c.onFlashUpdate==="function")if(b.flash.notice!==""||b.flash.error!==""||b.flash.warning!==""||b.flash.message!=="")c.onFlashUpdate(b.flash.notice,b.flash.error,b.flash.warning,b.flash.message)};b.baseURL=c.base_url||document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+"/";b.route=c.route;b.DefaultCallback=function(e,i,h,m){b.SetFlash(m);var n=$.parseJSON($(i).find("JSON").text()),
q=$(i).find("Template").text();i=j($(i).find("Error"));typeof e==="function"&&e(q,n,h,m,i);b.ClearFlash()};b.DefaultErrorCallback=function(){$('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>Something went wrong :-( Either try again or reload the page!</div>').dialog({resizable:false,modal:true,buttons:{"Try again":function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}})};b.ConstructRoute=function(e){for(var i=
"",h="",m=0;m<b.route.length;m++){i+=b.route[m];h=e[b.route[m]]||"";if(h!=="")i+="/"+h;if(m!==b.route.length-1)i+="/"}return i};b.Index=function(e){var i=e.successCallback||null,h=b.ConstructRoute(e);$.ajax({url:b.baseURL+h,dataType:"xml",type:"GET",processData:true,contentType:"application/json",data:e.send,success:function(m,n,q){b.DefaultCallback(i,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Show=function(e){var i=e.successCallback||null;e=b.ConstructRoute(e);$.ajax({url:b.baseURL+
e,dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(h,m,n){b.DefaultCallback(i,h,m,n)},error:function(h,m,n){b.DefaultErrorCallback(h,m,n)}})};b.New=function(e){var i=e.successCallback||null;e=b.ConstructRoute(e);$.ajax({url:b.baseURL+e+"/new",dataType:"xml",type:"GET",processData:false,contentType:"application/json",success:function(h,m,n){b.DefaultCallback(i,h,m,n)},error:function(h,m,n){b.DefaultErrorCallback(h,m,n)}})};b.Create=function(e){var i=e.successCallback||
null,h=b.ConstructRoute(e);e=JSON.stringify(e.send);$.ajax({url:b.baseURL+h,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:e,success:function(m,n,q){b.DefaultCallback(i,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Edit=function(e){var i=e.successCallback||null;e=b.ConstructRoute(e);$.ajax({url:b.baseURL+e+"/edit",dataType:"xml",type:"GET",parseData:false,contentType:"application/json",success:function(h,m,n){b.DefaultCallback(i,h,m,n)},error:function(h,
m,n){b.DefaultErrorCallback(h,m,n)}})};b.Update=function(e){var i=e.successCallback||null,h=b.ConstructRoute(e);e=JSON.stringify(e.send);e=e.replace(/\\u000a/g,"\\n");$.ajax({url:b.baseURL+h,dataType:"xml",type:"POST",processData:false,contentType:"application/json",data:e,beforeSend:function(m){m.setRequestHeader("X-Http-Method-Override","PUT")},success:function(m,n,q){b.DefaultCallback(i,m,n,q)},error:function(m,n,q){b.DefaultErrorCallback(m,n,q)}})};b.Destroy=function(e){var i=e.successCallback||
null;e=b.ConstructRoute(e);$.ajax({url:b.baseURL+e,dataType:"xml",type:"POST",processData:false,contentType:"application/json",beforeSend:function(h){h.setRequestHeader("X-Http-Method-Override","DELETE")},success:function(h,m,n){b.DefaultCallback(i,h,m,n)},error:function(h,m,n){b.DefaultErrorCallback(h,m,n)}})};return b},List=Controller({route:["lists"],onFlashUpdate:function(c,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",c)}}),ListListItem=Controller({route:["lists",
"list_items"],onFlashUpdate:function(c,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",c)}}),ListItem=Controller({route:["list_items"],onFlashUpdate:function(c,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",c)}}),Tag=Controller({route:["tags"],onFlashUpdate:function(c,b){ListKungFu.LayoutSouth.StatusBar("SetAlert",b);ListKungFu.LayoutSouth.StatusBar("SetNotice",c)}});
jQuery(function(c){var b=c("meta[name=csrf-token]").attr("content"),j=c("meta[name=csrf-param]").attr("content");c.fn.extend({triggerAndReturn:function(i,h){var m=new c.Event(i);this.trigger(m,h);return m.result!==false},callRemote:function(){var i=this,h=i.attr("method")||i.attr("data-method")||"GET",m=i.attr("action")||i.attr("href"),n=i.attr("data-type")||"script";if(m===undefined)throw"No URL specified for remote call (action or href must be present).";else{if(i.triggerAndReturn("ajax:before")){var q=
i.is("form")?i.serializeArray():[];c.ajax({url:m,data:q,dataType:n,type:h.toUpperCase(),beforeSend:function(p){i.trigger("ajax:loading",p)},success:function(p,E,y){i.trigger("ajax:success",[p,E,y])},complete:function(p){i.trigger("ajax:complete",p)},error:function(p,E,y){i.trigger("ajax:failure",[p,E,y])}})}i.trigger("ajax:after")}}});c("body").delegate("a[data-confirm], button[data-confirm], input[data-confirm]","click.rails",function(){var i=c(this);if(i.triggerAndReturn("confirm"))if(!confirm(i.attr("data-confirm")))return false});
c("form[data-remote]").live("submit.rails",function(i){c(this).callRemote();i.preventDefault()});c("a[data-remote],input[data-remote]").live("click.rails",function(i){c(this).callRemote();i.preventDefault()});c("a[data-method]:not([data-remote])").live("click.rails",function(i){var h=c(this),m=h.attr("href");h=h.attr("data-method");m=c('<form method="post" action="'+m+'"></form>');h='<input name="_method" value="'+h+'" type="hidden" />';if(j!==undefined&&b!==undefined)h+='<input name="'+j+'" value="'+
b+'" type="hidden" />';m.hide().append(h).appendTo("body");i.preventDefault();m.submit()});var e=function(){c(this).find("input[data-disable-with]").each(function(){var i=c(this);i.data("enable-with",i.val()).attr("value",i.attr("data-disable-with")).attr("disabled","disabled")})};c("form[data-remote]:has(input[data-disable-with])").live("ajax:before.rails",e);c("form:not([data-remote]):has(input[data-disable-with])").live("submit.rails",e);c("form[data-remote]:has(input[data-disable-with])").live("ajax:complete.rails",
function(){c(this).find("input[data-disable-with]").each(function(){var i=c(this);i.removeAttr("disabled").val(i.data("enable-with"))})});e=c().jquery;if(e==="1.4"||e==="1.4.1"||e==="1.4.2")alert("This rails.js does not support the jQuery version you are using. Please read documentation.")});
(function(c){c.confirmationDialog=function(b,j,e,i){dialog=c('<div id="dialog-confirm"> \t\t\t<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"> \t\t\t</span>'+i+"</div>").dialog({resizable:false,modal:true,autoOpen:false,width:400,open:function(){dialog.parent().find(".ui-dialog-buttonpane > button").first().focus()}});i={};i[b]=function(){c(dialog).dialog("close");j()};i[e]=function(){c(dialog).dialog("close")};dialog.dialog("option","buttons",i);dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown",
"right",function(h){h=c(h.target);if(h.next("button").length>0){h.blur();h.next("button").focus()}return false});dialog.parent().find(".ui-dialog-buttonpane > button").bind("keydown","left",function(h){h=c(h.target);if(h.prev("button").length>0){h.blur();h.prev("button").focus()}return false});return dialog}})(jQuery);
(function(){var c=function(){var b=null,j=function(h){var m=$(this),n=h.find(".dashboard-list-item-deadline-hidden"),q=h.data("data"),p=q.list_item.deadline_date.split("-"),E=p[0],y=p[1],F=p[2];n.datepicker({minDate:new Date,dateFormat:"yy,mm,dd",beforeShow:function(G,H){H.input.datepicker("setDate",E+","+y+","+F)},onSelect:function(G){q.list_item.deadlineType="customdeadline";q.list_item.customDeadlineValue=G;q.list_item.template="dashboard";ListListItem.Update({successCallback:function(H,A){var J=
h.parent();h.hide("slow",function(){h.remove();J.find(".dashboard-item").length===0&&J.append('<p class="nothing-todo">no items scheduled</p>')});i(A,H,{highlightCategory:true,addType:"prepend"})},lists:q.list_item.list_id,list_items:q.list_item.id,send:q});m.datepicker("hide")}})},e=function(h,m,n){n=n||{};h.find(".nothing-todo").remove();n.addType==="prepend"?h.find("div[data-type=scheduleColumn]").first().prepend(m):h.find("div[data-type=scheduleColumn]").first().append(m);n.highlightCategory===
true&&m.effect("highlight",{},2E3)},i=function(h,m,n){var q=$($.mustache(m,h.list_item));switch(h.list_item.deadline_category){case "today":e(b.today,q,n);break;case "tomorrow":e(b.tomorrow,q,n);break;case "this week":e(b.thisweek,q,n);break;case "next week":e(b.nextweek,q,n);break;default:e(b.later,q,n)}q.data("data",h);q.find(".dashboard-list-item-title").bind("click",function(){b._trigger("OpenList",0,{selectedList:h.list_item})});q.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",
0,{selectedList:h.list_item})});q.find(".dashboard-item-completed").bind("click",function(){$that=$(this);$that.find(".confirmation-completed").remove();var p=$('<div class="confirmation-completed">Completed? \t\t\t\t\t<span class="yes">Yes</span> / <span class="no">NO</span></div>');$that.append(p);$that.animate({width:"100%",paddingLeft:"14px"},200);p.find(".yes").bind("click",function(){h.list_item.completed=true;ListListItem.Update({successCallback:function(){q.stop(true,true).hide("slow",function(){q.remove()})},
lists:h.list_item.list_id,list_items:h.list_item.id,send:h});p.find(".no").trigger("click");return false});p.find(".no").bind("click",function(){$that.animate({width:"12px",paddingLeft:"0"},200,function(){p.remove()});return false})});q.find(".dashboard-item-more").bind("click",function(){b._trigger("OpenList",0,{selectedList:h.list_item})});j(q);q.find(".dashboard-list-item-deadline").bind("click",function(){q.find(".dashboard-list-item-deadline").parent().find(".dashboard-list-item-deadline-hidden").datepicker("show")});
return q};return{options:{},Show:function(){b.Hide();b.header=$('<div id="dashboard-header" class="header"><h1>Dashboard</h1></div>');b.toolbar=$('<div id="dashboard-toolbar"><input type="text" id="dashboard-search" value=""/></div>');b.wrapper=$('<div class="ui-layout-content" id="dashboard-view"></div>');b.today=$('<div id="today" class="schedule-column"><h1>Today</h1><div data-type="scheduleColumn"></div></div>');b.tomorrow=$('<div id="tomorrow" class="schedule-column"><h1>Tomorrow</h1><div data-type="scheduleColumn"></div></div>');
b.thisweek=$('<div id="thisweek" class="schedule-column"><h1>This Week</h1><div data-type="scheduleColumn"></div></div>');b.nextweek=$('<div id="nextweek" class="schedule-column"><h1>Next Week</h1><div data-type="scheduleColumn"></div></div>');b.later=$('<div id="later"><h1>Later</h1><div data-type="scheduleColumn"></div></div>');b.element.append(b.header);b.header.append(b.toolbar);b.element.append(b.wrapper);b.wrapper.append(b.today);b.wrapper.append(b.tomorrow);b.wrapper.append(b.thisweek);b.wrapper.append(b.nextweek);
b.nextweek.append(b.later);b.wrapper.append('<div style="clear:both;">&nbsp;</div>');b.toolbar.append('<div id="dashboard-search-cancel">&nbsp;</div><div style="clear:both;">&nbsp;</div>');ListItem.Index({successCallback:function(h,m){$.each(m,function(n,q){i(q,h)});$('div[data-type="scheduleColumn"]').each(function(){$(this).children(".dashboard-item").length===0&&$(this).append('<p class="nothing-todo">no items scheduled</p>')});b._trigger("ReinitPanes",0,{});b._trigger("ContentDimensionsChanged",
0,{})},send:{show:"dashboard"}});b.toolbar.find("#dashboard-search").bind("keyup",function(){var h=$(this).val();if(h==="")b.wrapper.find(".dashboard-item").show();else{b.wrapper.find(".dashboard-item:not(:Contains('"+h+"'))").hide();b.wrapper.find(".dashboard-item:Contains('"+h+"')").show()}});b.toolbar.find("#dashboard-search-cancel").bind("click",function(){b.toolbar.find("#dashboard-search").val("").trigger("keyup")})},Hide:function(){b.element.children().remove()},_create:function(){b=this},
destroy:function(){}}}();$.widget("ui.Dashboard",c)})();
(function(c){function b(j){if(typeof j.data==="string"){var e=j.handler,i=j.data.toLowerCase().split(" ");j.handler=function(h){if(!(this!==h.target&&(/textarea|select/i.test(h.target.nodeName)||h.target.type==="text"))){var m=h.type!=="keypress"&&c.hotkeys.specialKeys[h.which],n=String.fromCharCode(h.which).toLowerCase(),q="",p={};if(h.altKey&&m!=="alt")q+="alt+";if(h.ctrlKey&&m!=="ctrl")q+="ctrl+";if(h.metaKey&&!h.ctrlKey&&m!=="meta")q+="meta+";if(h.shiftKey&&m!=="shift")q+="shift+";if(m)p[q+m]=
true;else{p[q+n]=true;p[q+c.hotkeys.shiftNums[n]]=true;if(q==="shift+")p[c.hotkeys.shiftNums[n]]=true}m=0;for(n=i.length;m<n;m++)if(p[i[m]])return e.apply(this,arguments)}}}}c.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};c.each(["keydown","keyup","keypress"],function(){c.event.special[this]={add:b}})})(jQuery);
(function(){$.widget("ui.ListItemView",{_SetSelectedListItem:function(c,b){this.selectedListItem={element:c,data:b}},_SetupDeadlineButton:function(c){var b=c.find("#deadline-settings-wrapper"),j=c.find("#save-deadline");j.bind("click keydown","return",function(){j.data("settings-visible")?b.hide("fast",function(){b.find(".deadline-button").first();j.data("settings-visible",false)}):b.show("fast",function(){b.find(".deadline-button").first().focus();j.data("settings-visible",true)});return false})},
_SetupCustomDeadlinePicker:function(){$("#custom-deadline-display").datepicker({minDate:new Date,altField:"#custom-deadline-value",altFormat:"yy,mm,dd",dateFormat:"dd.mm.yy"});$("#custom-deadline-value").val($.datepicker.formatDate("yy,mm,dd",new Date));$("#custom-deadline-display").val($.datepicker.formatDate("dd.mm.yy",new Date))},_TriggerReinitOfPanes:function(){this._trigger("ReinitPanes",0,{})},_TriggerResize:function(){this._trigger("ContentDimensionsChanged",0,{})},_AddListItem:function(c,
b,j){var e=this,i=$($.mustache(b,c.list_item));i.data("data",c);i.data("isFullsize",false);j?e.listItemList.prepend(i):e.listItemList.append(i);i.find(".handle").height(i.height());i.bind("keydown","space",function(){e.toolbar.find("#list-item-completed").effect("puff",{},300,function(){$(this).show();i.find(".undo").length===0?e.toolbar.find("#list-item-completed").trigger("click"):i.find(".undo").trigger("click")})});i.bind("keydown","del",function(){e.toolbar.find("#list-item-delete").effect("puff",
{},300,function(){$(this).show();e.toolbar.find("#list-item-delete").trigger("click")})});i.bind("focus",function(h){if($(h.target).hasClass("row")){e.listItemList.find(".row").removeClass("selected-row");$(h.target).addClass("selected-row");$(h.target).data("data");if(e.toolbar)$(h.target).data("isFullsize")===true?e.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"}):e.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"});e._SetSelectedListItem($(h.target),
$(h.target).data("data"))}});$.browser.msie&&i.bind("click ",function(){i.focus();return false});i.bind("keydown","down",function(h){h.preventDefault();$(h.target).nextAll("div:visible").first().focus();return false});i.bind("keydown","up",function(h){h.preventDefault();$(h.target).prevAll("div:visible").first().focus();return false});i.bind("keydown dblclick","return",function(){if(i.find("form").length>0)return false;e.toolbar.find("#list-item-edit").effect("puff",{},300,function(){$(this).show()});
e.listItemList.find(".row").find("form").hide("slow",function(){$(this).remove()});ListListItem.Edit({successCallback:function(h){var m=$(h),n=i.data("isFullsize");e.listItemList.find(".row").hide();e.selectedListItem.element.show();m.hide();e.selectedListItem.element.prepend(m);m.find("textarea").markItUp(mySettings);e._SetupDeadlineButton(m);e._SetupCustomDeadlinePicker();n===false&&e._ToggleFullsize(i);e.selectedListItem.element.find(".handle").hide();m.show("slow",function(){m.find("textarea").focus()});
m.find("textarea").bind("keydown","esc",function(){m.find("#cancel-edit").trigger("click")});m.find(".deadline-button").bind("keydown click","return",function(q){q.preventDefault();var p=i.find("form").serializeForm();p.list_item.deadlineType=$(q.target).attr("data-deadline");p.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Update({send:p,successCallback:function(E,y){m.hide("slow",function(){$(this).remove();e.selectedListItem.element.find(".handle").show();i.find(".list-item-content").html(y.list_item.body_rendered);
i.find(".list-item-deadline").html(y.list_item.deadline_in_words);i.find(".handle").height(i.find(".list-item-content").height());n===false&&e._ToggleFullsize(i);e._SetSelectedListItem(i,y);i.data("data",y);e.listItemList.find(".row").show();i.focus()})},lists:e.selectedListItem.data.list_item.list_id,list_items:e.selectedListItem.data.list_item.id});return false});m.find("#cancel-edit").bind("keydown click","return",function(q){q.preventDefault();e.selectedListItem.element.find(".handle").show();
m.hide("slow",function(){$(this).remove();n===false&&e._ToggleFullsize(i);e.listItemList.find(".row").show();i.focus()});return false});return false},lists:e.selectedListItem.data.list_item.list_id,list_items:e.selectedListItem.data.list_item.id})});i.bind("keydown","left",function(){e._trigger("SelectLastList",0,{})});i.bind("keydown","shift+return",function(){e.toolbar.find("#list-item-new").effect("puff",{},300,function(){$(this).show();e._AddNewListItem()})});i.bind("keydown","l",function(){e.toolbar.find("#list-item-fullsize").effect("puff",
{},300,function(){e.toolbar.find("#list-item-fullsize").trigger("click");$(this).show()});return false});ListKungFu&&ListKungFu.LayoutCenter&&i.draggable({helper:function(){return $('<div class="list-item-drag-helper">'+i.find(".list-item-content").text().substring(0,20)+" . . .</div>").get(0)},appendTo:ListKungFu.LayoutCenter,revert:"invalid",handle:".handle",cursorAt:{top:10,left:10},iframeFix:true,start:function(){document.onselectstart=function(){return false};e._trigger("StartedDraggingListItem",
0,{dragType:"listitem"})},stop:function(){document.onselectstart=null}});e._CorrectHeight(i)},_ToggleFullsize:function(c){if(c.data("isFullsize")===true){this._CorrectHeight(c,false);c.data("isFullsize",false);this.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomin"})}else{this._CorrectHeight(c,true);c.data("isFullsize",true);this.toolbar.find("#list-item-fullsize").button("option","icons",{primary:"ui-icon-zoomout"})}},_CorrectHeight:function(c,b){c.height()>150&&
!b?c.height(150):c.height("auto");this._TriggerResize()},_DeleteListItem:function(c,b){var j=this;ListListItem.Destroy({successCallback:function(){c.hide("slow",function(){var e=c.next(".row");e.length>0||(e=c.prev(".row"));e.focus();c.remove();j.toolbar.find("#list-item-search").trigger("ClearValue")})},lists:b.list_item.list_id,list_items:b.list_item.id})},_MarkCompleted:function(c,b){var j=this;b.list_item.completed=true;ListListItem.Update({successCallback:function(){var e="list-item-undo-"+b.list_item.id;
c.find(".list-item-wrapper").hide("slow",function(){var i=$('<div class="undo clickable"><img src="/images/undo-icon.gif"/>Undo</div>');i.bind("click",function(){j._MarkUncompleted(c,b,e)});c.append(i);j._CorrectHeight(c);i.delay(5E3,e).queue(e,function(){c.hide("slow",function(){c.remove()})}).dequeue(e);j.toolbar&&j.toolbar.find("#showCompleted").get(0).checked===true&&j._ToggleCompleted(true);c.focus()})},lists:b.list_item.list_id,list_items:b.list_item.id,send:b})},_MarkUncompleted:function(c,
b,j){var e=this;j!==""&&c.clearQueue(j);b.list_item.completed=false;ListListItem.Update({successCallback:function(){c.find(".undo").hide("slow",function(){$(this).remove()});c.find(".list-item-wrapper").show("slow",function(){e._CorrectHeight(c)});e.toolbar&&e.toolbar.find("#showCompleted").get(0).checked===true&&e._ToggleCompleted(true)},lists:b.list_item.list_id,list_items:b.list_item.id,send:b})},_ToggleCompleted:function(c){var b=this;if(c===true){if(b.completedList){b.completedList.remove();
b.completedList=null}b.completedList=$('<div id="completedList"></div>');c=b.element.data("data-list");ListListItem.Index({successCallback:function(j,e){$.each(e,function(i,h){b.completedList.append("<div>"+h.list_item.body_rendered+"</div>")});e.length===0&&b.completedList.append("<div>No completed items</div>");b.wrapper.prepend(b.completedList)},send:{show:"completed"},lists:c.list.id})}else{b.completedList.remove();b.completedList=null}},_CreateToolbar:function(){var c=this;c.header.html("");
c.toolbar=$('<div id="list-item-toolbar"><div id="list-name"></div><div id="list-item-toolbar-buttons"><button id="list-item-completed">Completed [space]</button><button id="list-item-new">Create [shift+return]</button><button id="list-item-delete">Delete [del]</button><button id="list-item-edit">Edit [return]</button><button id="list-item-fullsize">Fullsize [l]</button><input type="input" id="list-item-search"/><input type="checkbox" id="showCompleted"/><label for="showCompleted">Show Completed Items</label><div id="list-item-search-cancel">&nbsp;</div></div></div>');
c.listName=c.toolbar.find("#list-name");c.toolbar.find("#list-item-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});c.toolbar.find("#list-item-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});c.toolbar.find("#list-item-completed").button({text:false,icons:{primary:"ui-icon-check"}});c.toolbar.find("#list-item-delete").button({text:false,icons:{primary:"ui-icon-trash"}});c.toolbar.find("#list-item-fullsize").button({text:false,icons:{primary:"ui-icon-zoomin"}});c.toolbar.find("#list-item-new").bind("click",
function(){c._AddNewListItem()});c.toolbar.find("#showCompleted").bind("change",function(b){c._ToggleCompleted(b.target.checked);c.selectedListItem.element.focus()});c.toolbar.find("#list-item-completed").bind("click",function(){c._MarkCompleted(c.selectedListItem.element,c.selectedListItem.data)});c.toolbar.find("#list-item-delete").bind("click",function(){var b=function(){c._DeleteListItem(c.selectedListItem.element,c.selectedListItem.data)};if(typeof c.deleteDialog==="undefined")c.deleteDialog=
$.confirmationDialog("Delete List Item",b,"Cancel","Do you really want to delete?");c.deleteDialog.dialog("open")});c.toolbar.find("#list-item-edit").bind("click",function(){c.selectedListItem.element.trigger("dblclick")});c.toolbar.find("#list-item-fullsize").bind("click",function(){c._ToggleFullsize(c.selectedListItem.element)});c.toolbar.find("#list-item-search").bind("keyup",function(){var b=$(this).val();if(b==="")c.listItemList.find(".row").show();else{c.listItemList.find(".row:not(:Contains('"+
b+"'))").hide();c.listItemList.find(".row:Contains('"+b+"')").show()}});c.toolbar.find("#list-item-search-cancel").bind("click",function(){c.toolbar.find("#list-item-search").val("").trigger("keyup")});c.toolbar.find("#list-item-search").bind("ClearValue",function(b){$(b.target).val("");c.listItemList.find(".row").show()});c.header.append(c.toolbar)},_AddNewListItem:function(){var c=this,b=c.element.data("data-list");ListListItem.New({successCallback:function(j){var e=$(j);c.listItemList.prepend(e);
c._SetupDeadlineButton(e);c._SetupCustomDeadlinePicker();e.find("textarea").markItUp(mySettings);e.find("textarea").focus();c.listItemList.find(".row").hide();e.find("#cancel-edit").bind("click",function(i){i.preventDefault();e.hide("slow",function(){$(this).remove();c.listItemList.find(".row").show();c.listItemList.find(".row").first().focus()})});e.find(".deadline-button").bind("click",function(i){i.preventDefault();var h=e.serializeForm();h.list_item.body=h.list_item.body.replace(/\n/g,"\n\n");
h.list_item.deadlineType=$(i.target).attr("data-deadline");h.list_item.customDeadlineValue=$("#custom-deadline-value").val();ListListItem.Create({send:h,successCallback:function(m,n){e.hide("slow",function(){c._AddListItem(n,m,true);$(this).remove();c.toolbar.find("#list-item-search").trigger("ClearValue");c.listItemList.find(".row").show();c.listItemList.find(".row").first().focus();c.listItemList.find(".row").first().find(".handle").height(c.listItemList.find(".row").first().find(".list-item-content").height())})},
lists:b.list.id});return false});e.find("textarea").bind("keydown","esc",function(){e.find("#cancel-edit").trigger("click")})},lists:b.list.id})},_create:function(){var c=this;c.wrapper=$('<div class="ui-layout-content" id="list-item-wrapper"></div>');c.listItemList=$('<div id="list-item-list"></div>');c.header=$('<div class="header"></div>');c.element.append(c.header);c.element.append(c.wrapper);c.wrapper.append(c.listItemList);c._TriggerResize();$(document).bind("keydown","c",function(){var b=c.toolbar.find("#showCompleted");
if(b.length>0){if(b.get(0).checked===true)b.get(0).checked=false;else b.get(0).checked=true;b.trigger("change")}});$(document).bind("keyup","f",function(){c.toolbar.find("#list-item-search").focus()})},options:{},RemoveList:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")},OpenList:function(c){var b=this;b.RemoveList();b._create();b.element.data("data-list",c);ListListItem.Index({successCallback:function(j,e){b._CreateToolbar();$.each(e,function(i,
h){b._AddListItem(h,j)});c.id?b.listItemList.find(".row").each(function(){var i=$(this);if(i.data("data").list_item.id===c.id){i.focus();return false}}):b.listItemList.find(".row").first().focus();b.listItemList.find(".row").length===0&&b._AddNewListItem();b.listName.text(c.list.title)},lists:c.list.id});b._TriggerReinitOfPanes()},SelectListItem:function(){this.selectedListItem?this.selectedListItem.element.effect("highlight",{},300,function(){$(this).show().focus()}):this.listItemList.find(".row").first().effect("highlight",
{},300,function(){$(this).show().focus()})},destroy:function(){this.element.children().remove();$(document).unbind("keydown","c").unbind("keyup","f")}})})();
(function(){$.widget("ui.ListView",{_ReplaceList:function(c,b,j){b=this._GetListElement(b,j);c.replaceWith(b);this._AdjustHeight();this._triggerResize();b.focus()},_DroppableConfigTags:function(){var c=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".tag",drop:function(b,j){var e=$(this);if(e.position().top<c.wrapper.height()){var i=j.draggable.data("data"),h=e.data("data");h.list.tag_id=i.tag.id;List.Update({send:h,successCallback:function(m,n){c._ReplaceList(e,n,m)},
lists:h.list.id})}}}},_DroppableConfigListItems:function(c){var b=this;return{activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".list-item",drop:function(j,e){if($(this).position().top<b.wrapper.height()){var i=e.draggable.data("data"),h=$(this).data("data");i={list_item:{body:i.list_item.body.replace(/\n/g,"\n\n")}};ListListItem.Create({send:i,successCallback:function(){$(j.target).find(".fake-drop").remove();c.effect("highlight",{},3E3)},lists:h.list.id})}},over:function(j,e){var i=
$('<div class="fake-drop"></div>');i.html("<p>"+e.helper.text()+"</p>");$(j.target).append(i)},out:function(j){$(j.target).find(".fake-drop").remove()}}},_IsNewList:function(c){return this.selectedList===null||this.selectedList.data.list.id!==c.list.id?true:false},_HighlightFormErrors:function(c,b){for(var j in b){var e=b[j],i;for(i in e){for(var h=e[i],m=$('<div class="error_explanation"><ul></ul></div>'),n=m.find("ul"),q=c.find("*[name="+(j+"["+i+"]")+"]"),p=0;p<h.length;p++){q.parent(".field").addClass("field_with_errors");
n.append("<li>"+h[p]+"</li>")}q.parent(".field").append(m)}}},_ClearFormErrors:function(c){c.find(".field").removeClass("field_with_errors");c.find(".error_explanation").remove()},_DeleteList:function(c){var b=this,j=b.selectedList.element.next(),e=b.selectedList.element.prev();c=c||0;List.Destroy({successCallback:function(){b.selectedList.element.delay(c).fadeOut(function(){$(this).remove();j.length>0?j.focus():e.focus()});b._trigger("CloseList",0,{})},lists:b.selectedList.data.list.id})},_CreateToolbar:function(){var c=
this,b=$('<div id="list-toolbar"><button id="list-new">Create [shift+return]</button><button id="list-delete">Delete [del]</button><button id="list-edit">Edit [space]</button><input type="text" id="search-list" /><div id="list-search-cancel">&nbsp;</div></div>');c.element.find("div.header").append(b);b.find("#list-new").button({text:false,icons:{primary:"ui-icon-plusthick"}});b.find("#list-delete").button({text:false,icons:{primary:"ui-icon-trash"}});b.find("#list-edit").button({text:false,icons:{primary:"ui-icon-pencil"}});
b.find("#list-delete").bind("click",function(j){if(c.selectedList!==null){if(typeof c.deleteDialog==="undefined")c.deleteDialog=$.confirmationDialog("Delete List",function(){if(c.listForm!==null){c.listForm.bind("FormHidden",function(){c._DeleteList(1E3)});c._HideForm()}else c._DeleteList()},"Cancel","Do you really want to delete?");c.deleteDialog.dialog("open")}else $("#notice").text("Select the list which you want to delete").fadeIn().delay(5E3).fadeOut();$(j.target).blur();return false});b.find("#list-new").bind("click",
function(j){c.listlist.hide("slide",{direction:"left"},"slow",function(){if(c.listForm!=null){c.listForm.remove();c.listForm=null}c.listForm=$('<div class="ui-layout-content" id="list-form"></div>');c.wrapper.append(c.listForm);List.New({successCallback:function(e,i){c.listForm.append(e);c.listForm.show("slide",{direction:"left"},"slow",function(){c.listForm.find("#list_title").first().focus()});c._trigger("CloseList",0,{});c.listForm.find("#list-back-button").bind("click",function(){c._HideForm()});
c.listForm.find("#list_title").bind("keydown","esc",function(){c._HideForm()});c.listForm.bind("submit",function(h){h.preventDefault();h=$(this).find("form").serializeForm();i.list=h.list;List.Create({send:i,successCallback:function(m,n,q,p,E){c._ClearFormErrors(c.listForm);if(E===false){c._HideForm(n,m);c.toolbar.find("#search-list").trigger("ClearValue")}else c._HighlightFormErrors(c.listForm,E)}});return false});c.selectedList=null}})});$(j.target).blur();return false});b.find("#search-list").bind("keyup",
function(){var j=$(this).val();if(j==="")c.listlist.find(".row").show();else{c.listlist.find(".row:not(:Contains('"+j+"'))").hide();c.listlist.find(".row:Contains('"+j+"')").show()}c._AdjustHeight();c._triggerResize()});b.find("#list-search-cancel").bind("click",function(){b.find("#search-list").val("").trigger("keyup")});b.find("#search-list").bind("ClearValue",function(j){$(j.target).val("");c.listlist.find(".row").show()});b.find("#list-edit").bind("click",function(){c.listlist.hide("slide",{direction:"left"},
"slow",function(){if(c.listForm!=null){c.listForm.remove();c.listForm=null}c.listForm=$('<div class="ui-layout-content" id="list-form"></div>');c.wrapper.append(c.listForm);List.Edit({successCallback:function(j){c.listForm.append(j);c.listForm.show("slide",{direction:"left"},"slow",function(){c.listForm.find("#list_title").first().focus()});c.listForm.find("#list-back-button").bind("click",function(){c._HideForm()});c.listForm.find("#list_title").bind("keydown","esc",function(){c._HideForm()});c.listForm.bind("submit",
function(e){e.preventDefault();e=$(this).find("form").serializeForm();List.Update({send:e,successCallback:function(i,h,m,n,q){c._ClearFormErrors(c.listForm);q===false?c._HideForm(h,i):c._HighlightFormErrors(c.listForm,q)},lists:c.selectedList.data.list.id});return false})},lists:c.selectedList.data.list.id})})});return b},_GetListElement:function(c,b){var j=this,e=$($.mustache(b,c.list));e.attr("tabindex",0);e.data("data",c);e.addClass("row");$.browser.msie&&e.bind("click",function(){e.focus();return false});
e.bind("keydown","down",function(i){i.preventDefault();$(i.target).nextAll("div:visible").first().focus();return false});e.bind("keydown","up",function(i){i.preventDefault();$(i.target).prevAll("div:visible").first().focus();return false});e.bind("focus",function(i){i=$(i.target);j.selectedList={element:i,data:i.data("data")};j.listlist.find(".row").removeClass("selected-row");i.addClass("selected-row");j.listlist.find(".assigned-tags").hide();i.find(".assigned-tags").show();j._AdjustHeight()});e.bind("keydown dblclick",
"return",function(){j._trigger("OpenList",0,{selectedList:e.data("data")})});e.bind("keydown","right",function(){j._trigger("SelectListItem",0,{})});e.bind("keydown","shift+return",function(){j.toolbar.find("#list-new").effect("puff",{},300,function(){$(this).show();$(this).trigger("click")});return false});e.bind("keydown","del",function(){j.toolbar.find("#list-delete").effect("puff",{},300,function(){$(this).show()}).trigger("click")});e.bind("keydown","space",function(){j.toolbar.find("#list-edit").effect("puff",
{},300,function(){$(this).show();$(this).trigger("click")});return false});e.droppable(j._DroppableConfigListItems(e));e.find(".assigned-tag-delete").bind("click",function(i){var h=$(i.target).parent(".assigned-tag");i=h.attr("data-id");var m=e.data("data");m.list.tag_id=i;m.list.tag_action="remove";List.Update({send:m,successCallback:function(n,q){h.hide("slow",function(){h.remove();j._ReplaceList(e,q,n);j._FilterByTags()})},lists:m.list.id})});e.find(".assigned-tags").hide();return e},_triggerResize:function(){this._trigger("ContentDimensionsChanged",
0,{})},_AdjustHeight:function(){this.listlist.find(".row").each(function(){var c=$(this),b=c.find(".list-tag");c=c.find(".list-name");b.height(c.height()+10+"px")})},_AddListToDOM:function(c,b){this.listlist=$('<div id="list-list"></div>');this.wrapper.append(this.listlist);for(var j=0;j<c.length;j++)this.listlist.append(this._GetListElement(c[j],b));this._AdjustHeight();this._triggerResize()},_SelectLastList:function(){this.selectedList?this.selectedList.element.effect("highlight",{},300,function(){$(this).show();
$(this).focus()}):this.listlist.find(".row").first().effect("highlight",{},300,function(){$(this).show();$(this).focus()})},_RegisterGlobalKeyboardShortcuts:function(){var c=this;$(document).bind("keydown","ctrl+l",function(){c._SelectLastList()});$(document).bind("keydown","ctrl+f",function(){c.toolbar.find("#search-list").focus()});$(document).bind("keydown","shift+f",function(){c.toolbar.find("#search-list").focus();return false})},_ShowListView:function(c,b){var j=this;j.listlist.show("slide",
{direction:"left"},"slow",function(){if(c){var e=j._GetListElement(c,b);j._IsNewList(c)?j.listlist.prepend(e):j.selectedList.element.replaceWith(e);j._AdjustHeight();j.selectedList={data:c,element:e}}j.selectedList&&j.selectedList.element.focus()})},_HideForm:function(c,b){var j=this;j.listForm.hide("slide",{direction:"left"},"slow",function(){j._ShowListView(c,b);j.listForm.trigger("FormHidden");j.selectedList?j.selectedList.element.focus():j.listlist.find(".row").first().focus();j.listForm.remove();
j.listForm=null})},_FilterByTags:function(){var c=this;c.toolbar.find("#search-list").trigger("keyup");c.listlist.find(".row:visible").each(function(){var b=$(this),j=b.data("data"),e=0;if(c.selectedTags.length>0){for(var i=0;i<j.list.tags.length;i++)for(var h=0;h<c.selectedTags.length;h++)c.selectedTags[h]===j.list.tags[i].id&&e++;e===c.selectedTags.length?b.show():b.hide()}})},_create:function(){var c=this;c.selectedList=null;c.wrapper=c.element.find("div#list-wrapper");c.toolbar=c._CreateToolbar();
c.listForm=null;c.selectedTags=[];List.Index({successCallback:function(b,j){c.wrapper.find(".row").remove();c._AddListToDOM(j,b);c.listlist.find(".row").first().focus()}});c._RegisterGlobalKeyboardShortcuts()},options:{},SetupDroppable:function(c){var b=this;b.listlist.find(".row").each(function(){var j=$(this);j.droppable("destroy");switch(c){case "listitem":j.droppable(b._DroppableConfigListItems(j));break;case "tag":j.droppable(b._DroppableConfigTags())}})},ReloadLists:function(){var c=this;List.Index({successCallback:function(b,
j){c.wrapper.find(".row").remove();c._AddListToDOM(j,b);c.toolbar.find("#search-list").trigger("keyup");c._FilterByTags()}})},SelectList:function(){this._SelectLastList()},FilterByTags:function(c){this.selectedTags=c;this._FilterByTags()},destroy:function(){this.toolbar.remove();this.listForm.remove();this.wrapper.find(".row").remove()}})})();
(function(c){c.fn.serializeForm=function(){var b=c(this).find('*[name*="]"]'),j={};c.each(b,function(e,i){var h=c(i),m=h.get(0).name.split("[")[0],n=h.get(0).name.split("[")[1];n=n.replace("]","");h=h.val();j[m]=j[m]||{};j[m][n]=h});return j}})(jQuery);
(function(){var c=function(){return{options:{},_create:function(){this.ajaxLoader=$('<div id="ajax-indicator"> \t\t\t\t\t\t<img src="/images/ajax-loader.gif" class="ajax-indicator" /> Loading ... \t\t\t\t\t\t</div>');this.notice=$('<p id="notice"></p>');this.alert=$('<p id="alert"></p>');this.element.append(this.ajaxLoader);this.element.append(this.notice);this.element.append(this.alert);this.notice.hide(function(b){$(b.target).html("")});this.alert.hide(function(b){$(b.target).html("")});this.ajaxLoader.bind("ajaxSend",
function(){$(this).show()}).bind("ajaxComplete",function(){$(this).hide()})},SetNotice:function(b){this.notice.text(b);this.notice.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},SetAlert:function(b){this.alert.text(b);this.alert.fadeIn().delay(2E3).fadeOut(function(){$(this).text("")})},destroy:function(){widget.ajaxLoader.remove();widget.notice.remove();widget.alert.remove()}}}();$.widget("ui.StatusBar",c)})();if(!this.JSON)this.JSON={};
(function(){function c(p){return p<10?"0"+p:p}function b(p){i.lastIndex=0;return i.test(p)?'"'+p.replace(i,function(E){var y=n[E];return typeof y==="string"?y:"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+p+'"'}function j(p,E){var y,F,G,H,A=h,J,D=E[p];if(D&&typeof D==="object"&&typeof D.toJSON==="function")D=D.toJSON(p);if(typeof q==="function")D=q.call(E,p,D);switch(typeof D){case "string":return b(D);case "number":return isFinite(D)?String(D):"null";case "boolean":case "null":return String(D);
case "object":if(!D)return"null";h+=m;J=[];if(Object.prototype.toString.apply(D)==="[object Array]"){H=D.length;for(y=0;y<H;y+=1)J[y]=j(y,D)||"null";G=J.length===0?"[]":h?"[\n"+h+J.join(",\n"+h)+"\n"+A+"]":"["+J.join(",")+"]";h=A;return G}if(q&&typeof q==="object"){H=q.length;for(y=0;y<H;y+=1){F=q[y];if(typeof F==="string")if(G=j(F,D))J.push(b(F)+(h?": ":":")+G)}}else for(F in D)if(Object.hasOwnProperty.call(D,F))if(G=j(F,D))J.push(b(F)+(h?": ":":")+G);G=J.length===0?"{}":h?"{\n"+h+J.join(",\n"+h)+
"\n"+A+"}":"{"+J.join(",")+"}";h=A;return G}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,m,n={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;if(typeof JSON.stringify!=="function")JSON.stringify=function(p,E,y){var F;m=h="";if(typeof y==="number")for(F=0;F<y;F+=1)m+=" ";else if(typeof y==="string")m=y;if((q=E)&&typeof E!=="function"&&(typeof E!=="object"||typeof E.length!=="number"))throw Error("JSON.stringify");return j("",
{"":p})};if(typeof JSON.parse!=="function")JSON.parse=function(p,E){function y(G,H){var A,J,D=G[H];if(D&&typeof D==="object")for(A in D)if(Object.hasOwnProperty.call(D,A)){J=y(D,A);if(J!==undefined)D[A]=J;else delete D[A]}return E.call(G,H,D)}var F;p=String(p);e.lastIndex=0;if(e.test(p))p=p.replace(e,function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(p.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){F=eval("("+p+")");return typeof E==="function"?y({"":F},""):F}throw new SyntaxError("JSON.parse");}})();
var Mustache=function(){var c=function(){};c.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(b,j,e,i){if(!i){this.context=j;this.buffer=[]}if(!this.includes("",b))if(i)return b;else{this.send(b);return}b=this.render_pragmas(b);b=this.render_section(b,j,e);if(i)return this.render_tags(b,j,e,i);this.render_tags(b,j,e,i)},send:function(b){b!=""&&this.buffer.push(b)},render_pragmas:function(b){if(!this.includes("%",b))return b;
var j=this;return b.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(e,i,h){if(!j.pragmas_implemented[i])throw{message:"This implementation of mustache doesn't understand the '"+i+"' pragma"};j.pragmas[i]={};if(h){e=h.split("=");j.pragmas[i][e[0]]=e[1]}return""})},render_partial:function(b,j,e){b=this.trim(b);if(!e||e[b]===undefined)throw{message:"unknown_partial '"+b+"'"};if(typeof j[b]!="object")return this.render(e[b],j,e,true);return this.render(e[b],j[b],e,true)},render_section:function(b,
j,e){if(!this.includes("#",b)&&!this.includes("^",b))return b;var i=this;return b.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(h,m,n,q){h=i.find(n,j);if(m=="^")return!h||i.is_array(h)&&h.length===0?i.render(q,j,e,true):"";else if(m=="#")return i.is_array(h)?i.map(h,function(p){return i.render(q,i.create_context(p),e,true)}).join(""):i.is_object(h)?i.render(q,i.create_context(h),e,true):typeof h==="function"?
h.call(j,q,function(p){return i.render(p,j,e,true)}):h?i.render(q,j,e,true):""})},render_tags:function(b,j,e,i){var h=this,m=function(){return RegExp(h.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+h.ctag+"+","g")},n=m(),q=function(E,y,F){switch(y){case "!":return"";case "=":h.set_delimiters(F);n=m();return"";case ">":return h.render_partial(F,j,e);case "{":return h.find(F,j);default:return h.escape(h.find(F,j))}};b=b.split("\n");for(var p=0;p<b.length;p++){b[p]=b[p].replace(n,q,this);i||this.send(b[p])}if(i)return b.join("\n")},
set_delimiters:function(b){b=b.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(b){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return b.replace(arguments.callee.sRE,"\\$1")},find:function(b,j){b=this.trim(b);var e;if(j[b]===false||j[b]===0||j[b])e=j[b];else if(this.context[b]===false||this.context[b]===0||this.context[b])e=this.context[b];if(typeof e==="function")return e.apply(j);
if(e!==undefined)return e;return""},includes:function(b,j){return j.indexOf(this.otag+b)!=-1},escape:function(b){return String(b===null?"":b).replace(/&(?!\w+;)|["<>\\]/g,function(j){switch(j){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return j}})},create_context:function(b){if(this.is_object(b))return b;else{var j=".";if(this.pragmas["IMPLICIT-ITERATOR"])j=this.pragmas["IMPLICIT-ITERATOR"].iterator;var e={};e[j]=b;return e}},
is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(b,j){if(typeof b.map=="function")return b.map(j);else{for(var e=[],i=b.length,h=0;h<i;h++)e.push(j(b[h]));return e}}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(b,j,e,i){var h=new c;if(i)h.send=i;h.render(b,j,e);if(!i)return h.buffer.join("\n")}}}();
(function(c){c.mustache=function(b,j,e){return Mustache.to_html(b,j,e)}})(jQuery);
(function(c){c.fn.layout=function(b){function j(d){if(!d)return true;var f=d.keyCode;if(f<33)return true;var g={38:"north",40:"south",37:"west",39:"east"},k=f>=37&&f<=40,l=d.shiftKey,r=d.ctrlKey,u=false,s,w,t;if(!r&&!l)return true;else if(k&&p[g[f]].enableCursorHotkey)u=g[f];else c.each(v.borderPanes.split(","),function(x,B){s=p[B];w=s.customHotkey;t=s.customHotkeyModifier;if(l&&t=="SHIFT"||r&&t=="CTRL"||r&&l)if(w&&f==(isNaN(w)||w<=9?w.toUpperCase().charCodeAt(0):w)){u=B;return false}});if(!u)return true;
s=p[u];g=y[u];if(!s.enableCursorHotkey||g.isHidden||!C[u])return true;if((g=d.target||d.srcElement)&&l&&k&&(g.tagName=="TEXTAREA"||g.tagName=="INPUT"&&(f==37||f==39)))return true;ba(u);d.stopPropagation();return d.returnValue=false}function e(d){if(this&&this.tagName)d=this;d=typeof d=="string"?C[d]:c(d).attr("pane")?c(d):c(d).parents("div[pane]:first");if(d.length){var f=d.attr("pane"),g=y[f];g.cssSaved&&i(f);if(g.isSliding||g.isResizing||g.isClosed)g.cssSaved=false;else{var k={zIndex:v.zIndex.pane_normal+
1},l={},r=d.css("overflow"),u=d.css("overflowX"),s=d.css("overflowY");if(r!="visible"){l.overflow=r;k.overflow="visible"}if(u&&u!="visible"&&u!="auto"){l.overflowX=u;k.overflowX="visible"}if(s&&s!="visible"&&s!="auto"){l.overflowY=u;k.overflowY="visible"}g.cssSaved=l;d.css(k);c.each(v.allPanes.split(","),function(w,t){t!=f&&i(t)})}}}function i(d){if(this&&this.tagName)d=this;d=typeof d=="string"?C[d]:c(d).hasClass("ui-layout-pane")?c(d):c(d).parents("div[pane]:first");if(d.length){var f=d.attr("pane");
f=y[f];var g=f.cssSaved||{};!f.isSliding&&!f.isResizing&&d.css("zIndex",v.zIndex.pane_normal);d.css(g);f.cssSaved=false}}function h(d,f,g){var k=c(d);if(k.length)if(v.borderPanes.indexOf(f)==-1)alert("Error Adding Button \n\nInvalid pane: "+f);else{d=p[f].buttonClass+"-"+g;k.addClass(d+" "+d+"-"+f);return k}else alert("Error Adding Button \n\nInvalid selector: "+d);return false}function m(d,f){c.each(v[d].pins,function(g,k){n(c(k),d,f)})}function n(d,f,g){var k=d.attr("pin");if(!(k&&g==(k=="down"))){var l=
p[f].buttonClass+"-pin",r=l+"-"+f;f=l+"-up";k=r+"-up";l+="-down";r+="-down";d.attr("pin",g?"down":"up").attr("title",g?"Un-Pin":"Pin").removeClass(g?f:l).removeClass(g?k:r).addClass(g?l:f).addClass(g?r:k)}}var q={paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",togglerInnerClass:"ui-layout-",buttonClass:"ui-layout-button",contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore"},p={name:"",scrollToBookmarkOnLoad:true,defaults:{applyDefaultStyles:false,
closable:true,resizable:true,slidable:true,contentSelector:q.contentSelector,contentIgnoreSelector:q.contentIgnoreSelector,paneClass:q.paneClass,resizerClass:q.resizerClass,togglerClass:q.togglerClass,buttonClass:q.buttonClass,resizerDragOpacity:1,maskIframesOnResize:true,minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:"Close",togglerTip_closed:"Open",resizerTip:"Resize",sliderTip:"Slide Open",
sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseout",hideTogglerOnSlide:false,togglerContent_open:"",togglerContent_closed:"",showOverflowOnHover:false,enableCursorHotkey:true,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},initClosed:false,initHidden:false},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize"},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize"},east:{paneSelector:".ui-layout-east",size:200,
resizerCursor:"e-resize"},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize"},center:{paneSelector:".ui-layout-center"}},E={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},y={id:Math.floor(Math.random()*1E4),container:{},north:{},south:{},east:{},
west:{},center:{}},F={north:"south",south:"north",east:"west",west:"east"},G=function(d){if(typeof d=="string")return true;else if(typeof d=="object")try{return d.constructor.toString().match(/string/i)!==null}catch(f){}return false},H=function(d){return typeof d=="string"||G(d)?c.trim(d):d},A=function(d,f){return Math.max(d,f)},J=function(d){var f={defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};d=d||{};if(d.effects||
d.defaults||d.north||d.south||d.west||d.east||d.center)f=c.extend(f,d);else c.each(d,function(g,k){a=g.split("__");f[a[1]?a[0]:"defaults"][a[1]?a[1]:a[0]]=k});return f},D=function(d,f,g){function k(u){r=v[u];if(r.doCallback){cpPane=r.callback.split(",")[1];cpPane!=u&&cpPane!=f&&k(cpPane,true)}else{r.doCallback=true;r.callback=l}}var l=d+","+f+","+(g?1:0),r;c.each(v.borderPanes.split(","),function(u,s){if(v[s].isMoving){k(s);return false}})},la=function(d){d=v[d];v.isLayoutBusy=false;delete d.isMoving;
if(d.doCallback&&d.callback){d.doCallback=false;var f=d.callback.split(","),g=f[2]>0?true:false;if(f[0]=="open")V(f[1],g);else f[0]=="close"&&T(f[1],g);if(!d.doCallback)d.callback=null}},L=function(d,f){if(f){var g;try{if(typeof f=="function")g=f;else if(typeof f!="string")return;else if(f.indexOf(",")>0){var k=f.split(",");g=eval(k[0]);if(typeof g=="function"&&k.length>1)return g(k[1])}else g=eval(f);if(typeof g=="function")return g(d,C[d],c.extend({},y[d]),c.extend({},p[d]),p.name)}catch(l){}}},
Q=function(d,f){var g=0,k=false,l="";if(!c.browser.msie)if(c.curCSS(d[0],"display",true)=="none"){k=true;l=c.curCSS(d[0],"visibility",true);d.css({display:"block",visibility:"hidden"})}g=parseInt(c.curCSS(d[0],f,true),10)||0;if(k){d.css({display:"none"});l&&l!="hidden"&&d.css({visibility:l})}return g},R=function(d,f){var g;if(G(d)){d=H(d);g=C[d]}else g=c(d);if(f<=0)return 0;else f>0||(f=G(d)?S(d):g.outerWidth());return c.boxModel?f-Q(g,"paddingLeft")-Q(g,"paddingRight")-(c.curCSS(g[0],"borderLeftStyle",
true)=="none"?0:Q(g,"borderLeftWidth"))-(c.curCSS(g[0],"borderRightStyle",true)=="none"?0:Q(g,"borderRightWidth")):f},N=function(d,f){var g;if(G(d)){d=H(d);g=C[d]}else g=c(d);if(f<=0)return 0;else f>0||(f=G(d)?S(d):g.outerHeight());return c.boxModel?f-Q(g,"paddingTop")-Q(g,"paddingBottom")-(c.curCSS(g[0],"borderTopStyle",true)=="none"?0:Q(g,"borderTopWidth"))-(c.curCSS(g[0],"borderBottomStyle",true)=="none"?0:Q(g,"borderBottomWidth")):f},S=function(d,f){var g=C[d],k=p[d],l=y[d],r=f?k.spacing_open:
0;k=f?k.spacing_closed:0;return!g||l.isHidden?0:l.isClosed||l.isSliding&&f?k:v[d].dir=="horz"?g.outerHeight()+r:g.outerWidth()+r},ca=function(d){var f=z,g=v[d].dir,k=y[d],l=C[F[d]],r=p[d].spacing_open,u=p[F[d]].spacing_open,s=!l?0:g=="horz"?l.outerHeight():l.outerWidth();l=k.minSize||0;g=Math.min(k.maxSize||9999,(g=="horz"?f.innerHeight:f.innerWidth)-r-s-u);var w,t;switch(d){case "north":w=f.offsetTop+l;t=f.offsetTop+g;break;case "west":w=f.offsetLeft+l;t=f.offsetLeft+g;break;case "south":w=f.offsetTop+
f.innerHeight-g;t=f.offsetTop+f.innerHeight-l;break;case "east":w=f.offsetLeft+f.innerWidth-g;t=f.offsetLeft+f.innerWidth-l}c.extend(k,{minSize:l,maxSize:g,minPosition:w,maxPosition:t})},ma=function(){var d={top:S("north",true),bottom:S("south",true),left:S("west",true),right:S("east",true),width:0,height:0};with(d){width=z.innerWidth-left-right;height=z.innerHeight-bottom-top;top+=z.top;bottom+=z.bottom;left+=z.left;right+=z.right}return d},na=function(d){var f={},g,k,l;c.each("Left,Right,Top,Bottom".split(","),
function(){g=H(this);k=f["border"+g]=Q(d,"border"+g+"Width");l=f["padding"+g]=Q(d,"padding"+g);f["offset"+g]=k+l;if(d==M)f[g.toLowerCase()]=c.boxModel?l:0});f.innerWidth=f.outerWidth=d.outerWidth();f.innerHeight=f.outerHeight=d.outerHeight();if(c.boxModel){f.innerWidth-=f.offsetLeft+f.offsetRight;f.innerHeight-=f.offsetTop+f.offsetBottom}return f},ra=function(d,f,g,k){var l=window.layout=window.layout||{};l=l.timers=l.timers||{};d="layout_"+y.id+"_"+d+"_"+f;l[d]||(l[d]=setTimeout(g,k))},da=function(d,
f){var g=window.layout=window.layout||{};g=g.timers=g.timers||{};var k="layout_"+y.id+"_"+d+"_"+f;if(g[k]){clearTimeout(g[k]);delete g[k];return true}else return false},sa=function(){try{if(M[0].tagName=="BODY"){c("html").css({height:"100%",overflow:"hidden"});c("body").css({position:"relative",height:"100%",overflow:"hidden",margin:0,padding:0,border:"none"})}else{var d={overflow:"hidden"},f=M.css("position"),g=M.css("height");if(!M.hasClass("ui-layout-pane")){if(!f||"fixed,absolute,relative".indexOf(f)<
0)d.position="relative";if(!g||g=="auto")d.height="100%"}M.css(d)}}catch(k){}z=y.container=na(M)},ta=function(){c.each(v.borderPanes.split(","),function(d,f){var g=p[f];if(g.enableCursorHotkey||g.customHotkey){c(document).keydown(j);return false}})},ua=function(){b=J(b);if(b.effects){c.extend(E,b.effects);delete b.effects}c.each("name,scrollToBookmarkOnLoad".split(","),function(g,k){if(b[k]!==undefined)p[k]=b[k];else if(b.defaults[k]!==undefined){p[k]=b.defaults[k];delete b.defaults[k]}});c.each("paneSelector,resizerCursor,customHotkey".split(","),
function(g,k){delete b.defaults[k]});c.extend(p.defaults,b.defaults);v.center=c.extend(true,{},v.defaults,v.center);c.extend(p.center,b.center);var d=c.extend(true,{},p.defaults,b.defaults,p.center);c.each("paneClass,contentSelector,contentIgnoreSelector,applyDefaultStyles,showOverflowOnHover".split(","),function(g,k){p.center[k]=d[k]});var f=p.defaults;c.each(v.borderPanes.split(","),function(g,k){v[k]=c.extend(true,{},v.defaults,v[k]);o=p[k]=c.extend(true,{},p.defaults,p[k],b.defaults,b[k]);if(!o.paneClass)o.paneClass=
q.paneClass;if(!o.resizerClass)o.resizerClass=q.resizerClass;if(!o.togglerClass)o.togglerClass=q.togglerClass;c.each(["_open","_close",""],function(l,r){var u="fxName"+r,s="fxSpeed"+r,w="fxSettings"+r;o[u]=b[k][u]||b[k].fxName||b.defaults[u]||b.defaults.fxName||o[u]||o.fxName||f[u]||f.fxName||"none";var t=o[u];if(t=="none"||!c.effects||!c.effects[t]||!E[t]&&!o[w]&&!o.fxSettings)t=o[u]="none";t=E[t]||{};u=t.all||{};t=t[k]||{};o[w]=c.extend({},u,t,f.fxSettings||{},f[w]||{},o.fxSettings,o[w],b.defaults.fxSettings,
b.defaults[w]||{},b[k].fxSettings,b[k][w]||{});o[s]=b[k][s]||b[k].fxSpeed||b.defaults[s]||b.defaults.fxSpeed||o[s]||o[w].duration||o.fxSpeed||o.fxSettings.duration||f.fxSpeed||f.fxSettings.duration||t.duration||u.duration||"normal"})})},oa=function(){c.each(v.allPanes.split(","),function(){var d=H(this),f=p[d],g=y[d],k=v[d].dir,l=f.size=="auto"||isNaN(f.size)?0:f.size,r=f.minSize||1,u=f.maxSize||9999,s=f.spacing_open||0,w=f.paneSelector,t={},x;X[d]=false;if(w.substr(0,1)==="#")x=C[d]=M.find(w+":first");
else{x=C[d]=M.children(w+":first");x.length||(x=C[d]=M.children("form:first").children(w+":first"))}if(!x.length){C[d]=false;return true}x.attr("pane",d).addClass(f.paneClass+" "+f.paneClass+"-"+d);if(d!="center"){g.isClosed=false;g.isSliding=false;g.isResizing=false;g.isHidden=false;g.noRoom=false;v[d].pins=[]}t=c.extend({visibility:"visible",display:"block"},v.defaults.cssReq,v[d].cssReq);f.applyDefaultStyles&&c.extend(t,v.defaults.cssDef,v[d].cssDef);x.css(t);t={};switch(d){case "north":t.top=
z.top;t.left=z.left;t.right=z.right;break;case "south":t.bottom=z.bottom;t.left=z.left;t.right=z.right;break;case "west":t.left=z.left;break;case "east":t.right=z.right}if(k=="horz"){if(l===0||l=="auto"){x.css({height:"auto"});l=x.outerHeight()}l=A(l,r);l=Math.min(l,u);l=Math.min(l,z.innerHeight-s);t.height=A(1,N(d,l));g.size=l;g.maxSize=u;g.minSize=A(r,l-t.height+1);x.css(t)}else if(k=="vert"){if(l===0||l=="auto"){x.css({width:"auto","float":"left"});l=x.outerWidth();x.css({"float":"none"})}l=A(l,
r);l=Math.min(l,u);l=Math.min(l,z.innerWidth-s);t.width=A(1,R(d,l));g.size=l;g.maxSize=u;g.minSize=A(r,l-t.width+1);x.css(t);W(d,null,true)}else if(d=="center"){x.css(t);W("center",null,true)}if(f.initClosed&&f.closable){x.hide().addClass("closed");g.isClosed=true}else if(f.initHidden||f.initClosed){ga(d,true);g.isHidden=true}else x.addClass("open");f.showOverflowOnHover&&x.hover(e,i);if(f.contentSelector){g=X[d]=x.children(f.contentSelector+":first");if(!g.length){X[d]=false;return true}g.css(v.content.cssReq);
f.applyDefaultStyles&&g.css(v.content.cssDef);x.css({overflow:"hidden"})}})},va=function(){c.each(v.borderPanes.split(","),function(){var d=H(this),f=p[d],g=y[d],k=f.resizerClass,l=f.togglerClass,r=C[d];O[d]=false;Y[d]=false;if(!(!r||!f.closable&&!f.resizable)){var u=v[d].edge;r=r.is(":visible");var s="-"+d,w=r?"-open":"-closed",t;t=O[d]=c("<span></span>");r&&f.resizable||!r&&f.slidable&&t.attr("title",f.sliderTip).css("cursor",f.sliderCursor);t.attr("id",f.paneSelector.substr(0,1)=="#"?f.paneSelector.substr(1)+
"-resizer":"").attr("resizer",d).css(v.resizers.cssReq).css(u,z[u]+S(d)).addClass(k+" "+k+s+" "+k+w+" "+k+s+w).appendTo(M);f.applyDefaultStyles&&t.css(v.resizers.cssDef);if(f.closable){k=Y[d]=c("<div></div>");k.attr("id",f.paneSelector.substr(0,1)=="#"?f.paneSelector.substr(1)+"-toggler":"").css(v.togglers.cssReq).attr("title",r?f.togglerTip_open:f.togglerTip_closed).click(function(x){ba(d);x.stopPropagation()}).mouseover(function(x){x.stopPropagation()}).addClass(l+" "+l+s+" "+l+w+" "+l+s+w).appendTo(t);
if(f.togglerContent_open)c("<span>"+f.togglerContent_open+"</span>").addClass("content content-open").css("display",g.isClosed?"none":"block").appendTo(k);if(f.togglerContent_closed)c("<span>"+f.togglerContent_closed+"</span>").addClass("content content-closed").css("display",g.isClosed?"block":"none").appendTo(k);f.applyDefaultStyles&&k.css(v.togglers.cssDef);r||ha(d,true)}}});Z("all",true)},wa=function(){var d=typeof c.fn.draggable=="function",f;c.each(v.borderPanes.split(","),function(){var g=
H(this),k=p[g],l=y[g];if(!d||!C[g]||!k.resizable){k.resizable=false;return true}var r=k.resizerClass,u=r+"-drag",s=r+"-"+g+"-drag",w=r+"-dragging",t=r+"-"+g+"-dragging",x=false,B=O[g];l.isClosed||B.attr("title",k.resizerTip).css("cursor",k.resizerCursor);B.draggable({containment:M[0],axis:v[g].dir=="horz"?"y":"x",delay:200,distance:1,helper:"clone",opacity:k.resizerDragOpacity,zIndex:v.zIndex.resizing,start:function(){if(false===L(g,k.onresize_start))return false;l.isResizing=true;da(g,"closeSlider");
B.addClass(u+" "+s);x=false;var I=g=="east"||g=="south"?k.spacing_open:0;ca(g);l.minPosition-=I;l.maxPosition-=I;f=v[g].dir=="horz"?"top":"left";c(k.maskIframesOnResize===true?"iframe":k.maskIframesOnResize).each(function(){c('<div class="ui-layout-mask"/>').css({background:"#fff",opacity:"0.001",zIndex:9,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(c(this).offset()).appendTo(this.parentNode)})},drag:function(I,K){if(!x){c(".ui-draggable-dragging").addClass(w+
" "+t).children().css("visibility","hidden");x=true;l.isSliding&&C[g].css("zIndex",v.zIndex.sliding)}if(K.position[f]<l.minPosition)K.position[f]=l.minPosition;else if(K.position[f]>l.maxPosition)K.position[f]=l.maxPosition},stop:function(I,K){var P=K.position,U;B.removeClass(u+" "+s);switch(g){case "north":U=P.top;break;case "west":U=P.left;break;case "south":U=z.outerHeight-P.top-B.outerHeight();break;case "east":U=z.outerWidth-P.left-B.outerWidth()}ia(g,U-z[v[g].edge]);c("div.ui-layout-mask").remove();
l.isResizing=false}})})},ga=function(d,f){var g=p[d],k=y[d],l=C[d],r=O[d];if(!(!l||k.isHidden))if(false!==L(d,g.onhide_start)){k.isSliding=false;r&&r.hide();if(f||k.isClosed){k.isClosed=true;k.isHidden=true;l.hide();W(v[d].dir=="horz"?"all":"center");L(d,g.onhide_end||g.onhide)}else{k.isHiding=true;T(d,false)}}},ea=function(d,f){var g=p[d],k=y[d],l=O[d];if(C[d]&&k.isHidden)if(false!==L(d,g.onshow_start)){k.isSliding=false;k.isShowing=true;l&&g.spacing_open>0&&l.show();f===false?T(d,true):V(d)}},ba=
function(d){var f=y[d];if(f.isHidden)ea(d);else f.isClosed?V(d):T(d)},T=function(d,f,g){function k(){ha(d,true);K||L(d,s.onclose_end||s.onclose);if(K)L(d,s.onshow_end||s.onshow);if(P)L(d,s.onhide_end||s.onhide);la(d)}var l=C[d],r=O[d],u=Y[d],s=p[d],w=y[d];g=!g&&!w.isClosed&&s.fxName_close!="none";var t=v[d].edge,x=s.resizerClass,B=s.togglerClass,I="-"+d,K=w.isShowing,P=w.isHiding;delete w.isShowing;delete w.isHiding;if(!(!l||!s.resizable&&!s.closable))if(!(!f&&w.isClosed&&!K))if(v.isLayoutBusy)D("close",
d,f);else if(!(!K&&false===L(d,s.onclose_start))){v[d].isMoving=true;v.isLayoutBusy=true;w.isClosed=true;if(P)w.isHidden=true;else if(K)w.isHidden=false;m(d,false);w.isSliding||W(v[d].dir=="horz"?"all":"center");if(r){r.css(t,z[t]).removeClass(x+"-open "+x+I+"-open").removeClass(x+"-sliding "+x+I+"-sliding").addClass(x+"-closed "+x+I+"-closed");s.resizable&&r.draggable("disable").css("cursor","default").attr("title","");u&&u.removeClass(B+"-open "+B+I+"-open").addClass(B+"-closed "+B+I+"-closed").attr("title",
s.togglerTip_closed);Z()}if(g){fa(d,true);l.hide(s.fxName_close,s.fxSettings_close,s.fxSpeed_close,function(){fa(d,false);w.isClosed&&k()})}else{l.hide();k()}}},V=function(d,f,g){function k(){w.isSliding||W(v[d].dir=="vert"?"center":"all");if(r){r.css(t,z[t]+S(d)).removeClass(x+P+" "+x+I+P).addClass(x+K+" "+x+I+K).addClass(!w.isSliding?"":x+U+" "+x+I+U);s.resizable?r.draggable("enable").css("cursor",s.resizerCursor).attr("title",s.resizerTip):r.css("cursor","default");u&&u.removeClass(B+P+" "+B+I+
P).addClass(B+K+" "+B+I+K).attr("title",s.togglerTip_open);Z("all")}aa(d);m(d,!w.isSliding);L(d,s.onopen_end||s.onopen);if(ja)L(d,s.onshow_end||s.onshow);la(d)}var l=C[d],r=O[d],u=Y[d],s=p[d],w=y[d];g=!g&&w.isClosed&&s.fxName_open!="none";var t=v[d].edge,x=s.resizerClass,B=s.togglerClass,I="-"+d,K="-open",P="-closed",U="-sliding",ja=w.isShowing;delete w.isShowing;if(!(!l||!s.resizable&&!s.closable))if(w.isClosed||w.isSliding)if(w.isHidden&&!ja)ea(d,true);else if(v.isLayoutBusy)D("open",d,f);else if(false!==
L(d,s.onopen_start)){v[d].isMoving=true;v.isLayoutBusy=true;w.isSliding&&!f&&ka(d,false);w.isClosed=false;if(ja)w.isHidden=false;ca(d);w.size>w.maxSize&&l.css(v[d].sizeType,A(1,v[d].dir=="horz"?N(d,w.maxSize):R(d,w.maxSize)));ha(d,false);if(g){fa(d,true);l.show(s.fxName_open,s.fxSettings_open,s.fxSpeed_open,function(){fa(d,false);w.isClosed||k()})}else{l.show();k()}}},fa=function(d,f){var g=C[d];if(f){g.css({zIndex:v.zIndex.animation});if(d=="south")g.css({top:z.top+z.innerHeight-g.outerHeight()});
else d=="east"&&g.css({left:z.left+z.innerWidth-g.outerWidth()})}else{y[d].isSliding||g.css({zIndex:v.zIndex.pane_normal});if(d=="south")g.css({top:"auto"});else d=="east"&&g.css({left:"auto"})}},ha=function(d,f){var g=p[d],k=O[d],l=g.slideTrigger_open;if(k&&g.slidable){if(l!="click"&&l!="dblclick"&&l!="mouseover")l="click";k[f?"bind":"unbind"](l,xa).css("cursor",f?g.sliderCursor:"default").attr("title",f?g.sliderTip:"")}},ka=function(d,f){function g(u){da(d,"closeSlider");u.stopPropagation()}var k=
p[d].slideTrigger_close,l=C[d],r=O[d];y[d].isSliding=f;da(d,"closeSlider");l.css({zIndex:f?v.zIndex.sliding:v.zIndex.pane_normal});r.css({zIndex:f?v.zIndex.sliding:v.zIndex.resizer_normal});if(k!="click"&&k!="mouseout")k="mouseout";if(f){l.bind(k,pa);r.bind(k,pa);k="mouseout";l.bind("mouseover",g);r.bind("mouseover",g)}else{l.unbind(k);r.unbind(k);k="mouseout";l.unbind("mouseover");r.unbind("mouseover");da(d,"closeSlider")}},xa=function(){var d=c(this).attr("resizer");if(y[d].isClosed){ka(d,true);
V(d,true)}},pa=function(){function d(){ka(g,false);k.isClosed||T(g)}var f=c(this),g=f.attr("pane")||f.attr("resizer");f=p[g];var k=y[g];k.isClosed||k.isResizing||(f.slideTrigger_close=="click"?d():ra(g,"closeSlider",d,300))},ia=function(d,f){var g=v[d].edge,k=v[d].dir,l=p[d],r=y[d],u=C[d],s=O[d];ca(d);r.minSize=A(r.minSize,l.minSize);if(l.maxSize>0)r.maxSize=Math.min(r.maxSize,l.maxSize);f=A(f,r.minSize);f=Math.min(f,r.maxSize);r.size=f;s.css(g,f+z[g]);u.css(v[d].sizeType,A(1,v[d].dir=="horz"?N(d,
f):R(d,f)));r.isSliding||W(k=="horz"?"all":"center");Z();aa(d);L(d,l.onresize_end||l.onresize)},W=function(d,f,g){if(!d||d=="all")d="east,west,center";var k=ma();f&&c.extend(k,f);c.each(d.split(","),function(){if(C[this]){var l=H(this),r=p[l],u=y[l],s=C[l],w=O[l],t=true,x={};if(l=="center"){k=ma();x=c.extend({},k);x.width=A(1,R(l,x.width));x.height=A(1,N(l,x.height));t=x.width>1&&x.height>1;if(c.browser.msie&&(!c.boxModel||c.browser.version<7)){C.north&&C.north.css({width:R(C.north,z.innerWidth)});
C.south&&C.south.css({width:R(C.south,z.innerWidth)})}}else{x.top=k.top;x.bottom=k.bottom;x.height=A(1,N(l,k.height));t=x.height>1}if(t){s.css(x);if(u.noRoom){u.noRoom=false;if(u.isHidden)return;else ea(l,!u.isClosed)}if(!g){aa(l);L(l,r.onresize_end||r.onresize)}}else if(!u.noRoom){u.noRoom=true;if(!u.isHidden)if(g){s.hide();w&&w.hide()}else ga(l)}}})},aa=function(d){if(!d||d=="all")d=v.allPanes;c.each(d.split(","),function(){if(X[this]){var f=H(this),g=p[f].contentIgnoreSelector,k=C[f];f=X[f];var l=
f[0],r=N(k);k.children().each(function(){if(this!=l){var u=c(this);if(!g||!u.is(g))r-=u.outerHeight()}});if(r>0)r=N(f,r);r<1?f.hide():f.css({height:r}).show()}})},Z=function(d,f){if(!d||d=="all")d=v.borderPanes;c.each(d.split(","),function(){var g=H(this),k=p[g],l=y[g],r=C[g],u=O[g],s=Y[g];if(!(!r||!u||!k.resizable&&!k.closable)){var w=v[g].dir,t=l.isClosed?"_closed":"_open";g=k["spacing"+t];var x=k["togglerAlign"+t];t=k["togglerLength"+t];var B;if(g==0)u.hide();else{!l.noRoom&&!l.isHidden&&u.show();
if(w=="horz"){B=r.outerWidth();u.css({width:A(1,R(u,B)),height:A(1,N(u,g)),left:Q(r,"left")})}else{B=r.outerHeight();u.css({height:A(1,N(u,B)),width:A(1,R(u,g)),top:z.top+S("north",true)})}if(s){if(t==0||l.isSliding&&k.hideTogglerOnSlide){s.hide();return}else s.show();if(!(t>0)||t=="100%"||t>B){t=B;r=0}else if(typeof x=="string")switch(x){case "top":case "left":r=0;break;case "bottom":case "right":r=B-t;break;default:r=Math.floor((B-t)/2)}else{r=parseInt(x);r=x>=0?r:B-t+r}B=k.togglerContent_open?
s.children(".content-open"):false;var I=k.togglerContent_closed?s.children(".content-closed"):false;x=l.isClosed?I:B;if(B)B.css("display",l.isClosed?"none":"block");if(I)I.css("display",l.isClosed?"block":"none");if(w=="horz"){l=R(s,t);s.css({width:A(0,l),height:A(1,N(s,g)),left:r});x&&x.css("marginLeft",Math.floor((l-x.outerWidth())/2))}else{l=N(s,t);s.css({height:A(0,l),width:A(1,R(s,g)),top:r});x&&x.css("marginTop",Math.floor((l-x.outerHeight())/2))}}if(f&&k.initHidden){u.hide();s&&s.hide()}}}})},
qa=function(){var d=z.innerWidth,f=z.innerHeight;z=y.container=na(M);var g=z.innerHeight<f,k=z.innerWidth<d,l,r;if(g||k)c.each(["south","north","east","west"],function(u,s){l=y[s];r=v[s].dir;if(!l.isClosed&&(g&&r=="horz"||k&&r=="vert")){ca(s);l.size>l.maxSize&&ia(s,l.maxSize)}});W("all");Z("all")},M=c(this).css({overflow:"hidden"}),C={},X={},O={},Y={},v={allPanes:"north,south,east,west,center",borderPanes:"north,south,east,west",zIndex:{resizer_normal:1,pane_normal:2,mask:4,sliding:100,resizing:1E4,
animation:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden",zIndex:1},cssDef:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDef:{background:"#AAA"}},content:{cssReq:{overflow:"auto"},cssDef:{}},defaults:{cssReq:{position:"absolute",margin:0,zIndex:2},cssDef:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{edge:"top",sizeType:"height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{edge:"bottom",sizeType:"height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{edge:"right",sizeType:"width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{edge:"left",sizeType:"width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},z=y.container;(function(){ua();sa();oa();va();wa();aa("all");if(p.scrollToBookmarkOnLoad)with(self.location)hash&&replace(hash);ta();c(window).resize(function(){var d="timerLayout_"+y.id;window[d]&&clearTimeout(window[d]);window[d]=null;window[d]=setTimeout(qa,100)})})();return{options:p,state:y,panes:C,toggle:ba,open:V,close:T,hide:ga,show:ea,resizeContent:aa,sizePane:ia,reinitPane:oa,resizeAll:qa,addToggleBtn:function(d,f){var g=
h(d,f,"toggle");if(g)g.attr("title",y[f].isClosed?"Open":"Close").click(function(k){ba(f);k.stopPropagation()})},addOpenBtn:function(d,f){var g=h(d,f,"open");g&&g.attr("title","Open").click(function(k){V(f);k.stopPropagation()})},addCloseBtn:function(d,f){var g=h(d,f,"close");g&&g.attr("title","Close").click(function(k){T(f);k.stopPropagation()})},addPinBtn:function(d,f){var g=h(d,f,"pin");if(g){var k=y[f];g.click(function(l){n(c(this),f,k.isSliding||k.isClosed);k.isSliding||k.isClosed?V(f):T(f);
l.stopPropagation()});n(g,f,!k.isClosed&&!k.isSliding);v[f].pins.push(d)}},allowOverflow:e,resetOverflow:i,cssWidth:R,cssHeight:N}}})(jQuery);
(function(){var c=function(){var b=null,j=function(e,i){var h=$($.mustache(i,e.tag));h.data("data",e);if(!b.tagMenu){b.tagMenu=h.find(".tag-menu");b.tagMenu.hide()}h.find(".tag-menu").remove();h.find(".color-selector").bind("click",function(m){var n=b.tagMenu;m=$(m.target);if(n.data("visible")===true&&n.data("tagId")===e.tag.id){n.hide("fast");n.data("visible",false);n.data("tagId",null);n.data("tag",null);n.data("target",null)}else{n.show("fast");n.css({left:h.position().left,top:h.position().top-
100});n.data("visible",true);n.data("tagId",e.tag.id);n.data("tag",e);n.data("target",m)}return false});ListKungFu&&ListKungFu.LayoutWest&&h.draggable({helper:"clone",appendTo:ListKungFu.LayoutWest,revert:"invalid",containment:ListKungFu.LayoutWest,start:function(){document.onselectstart=function(){return false};b._trigger("StartedDraggingTag",0,{dragType:"tag"})},stop:function(){document.onselectstart=null}});h.bind("click",function(){var m=h.data("data");if(h.data("selected")){m=m.tag.id;for(var n=
[],q=0;q<b.selectedTags.length;q++)b.selectedTags[q]!==m&&n.push(b.selectedTags[q]);b.selectedTags=n;h.removeClass("tag-selected");h.data("selected",false)}else{b.selectedTags.push(m.tag.id);b.selectedTags=jQuery.unique(b.selectedTags);h.addClass("tag-selected");h.data("selected",true)}b._trigger("TagSelected",0,b.selectedTags);return false});return h};return{options:{},_create:function(){b=this;b.toolbar=$('<div id="tag-toolbar"></div>');b.addTagInput=$('<input type="text" value="" id="add-tag"/>');
b.addTagButton=$('<button id="tag-new">Create Tag</button>');b.tagList=$('<div class="tags"></div>');b.element.append(b.toolbar);b.toolbar.append(b.addTagInput);b.toolbar.append(b.addTagButton);b.element.append(b.tagList);b.addTagButton.button({text:false,icons:{primary:"ui-icon-plusthick"}});b.selectedTags=[];Tag.Index({successCallback:function(e,i){for(var h=0;h<i.length;h++)b.tagList.append(j(i[h],e));b.tagList.append(b.tagMenu);b.tagMenu.find(".color").bind("click",function(m){var n=$(m.target).attr("data-colorclass");
m=b.tagMenu.data("tag");var q=m.tag.color_class,p=b.tagMenu.data("target");m.tag.color_class=n;Tag.Update({send:m,successCallback:function(E,y){b._trigger("AfterColorChanged",0,{});p.parent(".tag").removeClass(q);p.parent(".tag").addClass(n);p.removeClass(q);p.addClass(n);b.tagMenu.hide("fast");b.tagMenu.data("visible",false);b.tagMenu.data("tagId",null);b.tagMenu.data("tag",null);b.tagMenu.data("target",null);p.data("data",y)},tags:m.tag.id})});b.tagMenu.find(".delete-label").bind("click",function(){var m=
b.tagMenu.data("tag"),n=b.tagMenu.data("target");b.tagMenu.hide();var q=function(){Tag.Destroy({successCallback:function(){n.hide("fast",function(){n.parent(".tag").remove()})},tags:m.tag.id})};if(typeof b.deleteDialog==="undefined")b.deleteDialog=$.confirmationDialog("Delete Tag",q,"Cancel","Delete Tag and remove it from all lists?");b.deleteDialog.dialog("open");return false})}});b.addTagButton.bind("click",function(){if($.trim(b.addTagInput.val())!==""&&b.tagList.find(".tag-name:HasExactValue('"+
$.trim(b.addTagInput.val())+"')").length===0){var e={};e.tag={name:b.addTagInput.val(),color_class:"c1"};Tag.Create({send:e,successCallback:function(i,h){var m=j(h,i);b.tagList.prepend(m);b.addTagInput.val("");b.addTagInput.trigger("keyup")}});return false}});b.addTagInput.bind("keyup","return",function(){b.addTagButton.trigger("click")});b.addTagInput.bind("keyup",function(){var e=$(this).val();if(e==="")b.tagList.find(".tag").show();else{b.tagList.find(".tag:not(:Contains('"+e+"'))").hide();b.tagList.find(".tag:Contains('"+
e+"')").show()}b.tagList.find(".tag-name:HasExactValue('"+$.trim(e)+"')").length>0?b.addTagButton.button("option","disabled",true):b.addTagButton.button("option","disabled",false)})},destroy:function(){b.element.children().remove()}}}();$.widget("ui.TagView",c)})();
